(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var zc=Object.create;var vn=Object.defineProperty;var Gc=Object.getOwnPropertyDescriptor;var Wc=Object.getOwnPropertyNames;var $c=Object.getPrototypeOf,Yc=Object.prototype.hasOwnProperty;var Z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Rt=(t,e)=>{for(var r in e)vn(t,r,{get:e[r],enumerable:!0})},Rs=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Wc(e))!Yc.call(t,i)&&i!==r&&vn(t,i,{get:()=>e[i],enumerable:!(n=Gc(e,i))||n.enumerable});return t};var Dt=(t,e,r)=>(r=t!=null?zc($c(t)):{},Rs(e||!t||!t.__esModule?vn(r,"default",{value:t,enumerable:!0}):r,t)),Zc=t=>Rs(vn({},"__esModule",{value:!0}),t);var ct=Z((j1,Ds)=>{Ds.exports={options:{usePureJavaScript:!1}}});var Ps=Z((ty,ks)=>{var mi={};ks.exports=mi;var Ns={};mi.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Qc(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<a.length;++f)c+=a[f]<<8,a[f]=c%o,c=c/o|0;for(;c>0;)a.push(c%o),c=c/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};mi.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Ns[e];if(!r){r=Ns[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,c=a;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Qc(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=o.length-1;r>=0;--r)f+=e[o[r]];return f}});var At=Z((ey,Ms)=>{var Us=ct(),Ks=Ps(),x=Ms.exports=Us.util=Us.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(a){return setImmediate(a)};return}if(x.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];x.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var o=x.setImmediate;x.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),o(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?globalThis:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};x.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};x.isArrayBufferView=function(t){return t&&x.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Yr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}x.ByteBuffer=vi;function vi(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(x.isArrayBuffer(t)||x.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof vi||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}x.ByteStringBuffer=vi;var Xc=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Xc&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};x.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};x.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};x.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(x.encodeUtf8(t))};x.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};x.ByteStringBuffer.prototype.putInt=function(t,e){Yr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};x.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};x.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};x.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};x.ByteStringBuffer.prototype.getInt=function(t){Yr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};x.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};x.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var t=x.createBuffer(this.data);return t.read=this.read,t};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function Jc(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=x.isArrayBuffer(t),n=x.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}x.DataBuffer=Jc;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};x.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};x.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};x.DataBuffer.prototype.putBytes=function(t,e){if(x.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(x.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof x.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&x.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof x.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=x.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};x.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};x.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};x.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(t,e){Yr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};x.DataBuffer.prototype.putSignedInt=function(t,e){return Yr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};x.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};x.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};x.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};x.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};x.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};x.DataBuffer.prototype.getInt=function(t){Yr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};x.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};x.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return x.binary.raw.encode(e);if(t==="hex")return x.binary.hex.encode(e);if(t==="base64")return x.binary.base64.encode(e);if(t==="utf8")return x.text.utf8.decode(e);if(t==="utf16")return x.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};x.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=x.encodeUtf8(t)),new x.ByteBuffer(t)};x.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};x.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};x.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};x.bytesToHex=function(t){return x.createBuffer(t).toHex()};x.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Fe=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Os="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=Ve.charAt(i>>2),r+=Ve.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Ve.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Ve.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=Fe[t.charCodeAt(s++)-43],n=Fe[t.charCodeAt(s++)-43],i=Fe[t.charCodeAt(s++)-43],o=Fe[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};x.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};x.decodeUtf8=function(t){return decodeURIComponent(escape(t))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Ks.encode,decode:Ks.decode}};x.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};x.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};x.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=Ve.charAt(i>>2),r+=Ve.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Ve.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Ve.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,f=0,c=r;f<t.length;)i=Fe[t.charCodeAt(f++)-43],o=Fe[t.charCodeAt(f++)-43],s=Fe[t.charCodeAt(f++)-43],a=Fe[t.charCodeAt(f++)-43],n[c++]=i<<2|o>>4,s!==64&&(n[c++]=(o&15)<<4|s>>2,a!==64&&(n[c++]=(s&3)<<6|a));return e?c-r:n.subarray(0,c)};x.binary.base58.encode=function(t,e){return x.binary.baseN.encode(t,Os,e)};x.binary.base58.decode=function(t,e){return x.binary.baseN.decode(t,Os,e)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(t,e,r){t=x.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};x.text.utf8.decode=function(t){return x.decodeUtf8(String.fromCharCode.apply(null,t))};x.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};x.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};x.deflate=function(t,e,r){if(e=x.decode64(t.deflate(x.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};x.inflate=function(t,e,r){var n=t.inflate(x.encode64(e)).rval;return n===null?null:x.decode64(n)};var bi=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=x.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},wi=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(x.decode64(r))),r},jc=function(t,e,r,n){var i=wi(t,e);i===null&&(i={}),i[r]=n,bi(t,e,i)},tu=function(t,e,r){var n=wi(t,e);return n!==null&&(n=r in n?n[r]:null),n},eu=function(t,e,r){var n=wi(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),bi(t,e,n)}},ru=function(t,e){bi(t,e,null)},bn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(f){s=f}if(o)break}if(!o)throw s;return n};x.setItem=function(t,e,r,n,i){bn(jc,arguments,i)};x.getItem=function(t,e,r,n){return bn(tu,arguments,n)};x.removeItem=function(t,e,r,n){bn(eu,arguments,n)};x.clearItems=function(t,e,r){bn(ru,arguments,r)};x.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};x.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};x.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+a:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-c).toFixed(o).slice(2):"")};x.formatSize=function(t){return t>=1073741824?t=x.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=x.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=x.formatNumber(t/1024,0)+" KiB":t=x.formatNumber(t,0)+" bytes",t};x.bytesFromIP=function(t){return t.indexOf(".")!==-1?x.bytesFromIPv4(t):t.indexOf(":")!==-1?x.bytesFromIPv6(t):null};x.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=x.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};x.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=x.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=x.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};x.bytesToIP=function(t){return t.length===4?x.bytesToIPv4(t):t.length===16?x.bytesToIPv6(t):null};x.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};x.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=x.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};x.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in x&&!t.update)return e(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,e(null,x.cores);if(typeof Worker>"u")return x.cores=1,e(null,x.cores);if(typeof Blob>"u")return x.cores=2,e(null,x.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,f){if(a===0){var c=Math.floor(s.reduce(function(u,l){return u+l},0)/s.length);return x.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,x.cores)}i(f,function(u,l){s.push(o(f,l)),n(s,a-1,f)})}function i(s,a){for(var f=[],c=[],u=0;u<s;++u){var l=new Worker(r);l.addEventListener("message",function(h){if(c.push(h.data),c.length===s){for(var y=0;y<s;++y)f[y].terminate();a(null,c)}}),f.push(l)}for(var u=0;u<s;++u)f[u].postMessage(u)}function o(s,a){for(var f=[],c=0;c<s;++c)for(var u=a[c],l=f[c]=[],h=0;h<s;++h)if(c!==h){var y=a[h];(u.st>y.st&&u.st<y.et||y.st>u.st&&y.st<u.et)&&l.push(h)}return f.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var wn=Z((ry,qs)=>{var Zr=ct();Zr.pki=Zr.pki||{};var Ei=qs.exports=Zr.pki.oids=Zr.oids=Zr.oids||{};function T(t,e){Ei[t]=e,Ei[e]=t}function ot(t,e){Ei[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");ot("2.5.29.1","authorityKeyIdentifier");ot("2.5.29.2","keyAttributes");ot("2.5.29.3","certificatePolicies");ot("2.5.29.4","keyUsageRestriction");ot("2.5.29.5","policyMapping");ot("2.5.29.6","subtreesConstraint");ot("2.5.29.7","subjectAltName");ot("2.5.29.8","issuerAltName");ot("2.5.29.9","subjectDirectoryAttributes");ot("2.5.29.10","basicConstraints");ot("2.5.29.11","nameConstraints");ot("2.5.29.12","policyConstraints");ot("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");ot("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");ot("2.5.29.20","cRLNumber");ot("2.5.29.21","cRLReason");ot("2.5.29.22","expirationDate");ot("2.5.29.23","instructionCode");ot("2.5.29.24","invalidityDate");ot("2.5.29.25","cRLDistributionPoints");ot("2.5.29.26","issuingDistributionPoint");ot("2.5.29.27","deltaCRLIndicator");ot("2.5.29.28","issuingDistributionPoint");ot("2.5.29.29","certificateIssuer");ot("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");ot("2.5.29.33","policyMappings");ot("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");ot("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");ot("2.5.29.46","freshestCRL");ot("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Xr=Z((ny,Fs)=>{var pt=ct();At();wn();var P=Fs.exports=pt.asn1=pt.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(pt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||pt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=P.copy(a)),a};P.copy=function(t,e){var r;if(pt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(pt.util.isArray(t)){if(!pt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Qr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var nu=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;Qr(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=pt.util.createBuffer(t));var r=t.length(),n=En(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function En(t,e,r,n){var i;Qr(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var f=nu(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,l,h=(o&32)===32;if(h)if(u=[],f===void 0)for(;;){if(Qr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(En(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(En(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&(l=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&f>1){var y=t.read,d=e,p=0;if(a===P.Type.BITSTRING&&(Qr(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var g={strict:!0,decodeBitStrings:!0},m=En(t,e,r+1,g),w=i-t.length();e-=w,a==P.Type.BITSTRING&&w++;var b=m.tagClass;w===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=y,e=d)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===P.Type.BMPSTRING)for(u="";f>0;f-=2)Qr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var L=l===void 0?null:{bitStringContents:l};return P.create(s,a,h,u,L)}P.toDer=function(t){var e=pt.util.createBuffer(),r=t.tagClass|t.type,n=pt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(P.toDer(t.value[o]))}else if(t.type===P.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=pt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=pt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),l=parseInt(t.substr(c+4,2),10),h=u*60+l;h*=6e4,f==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var l=t.length-5,h=t.charAt(l);if(h==="+"||h==="-"){var y=parseInt(t.substr(l+1,2),10),d=parseInt(t.substr(l+4,2),10);c=y*60+d,c*=6e4,h==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(o,s,a,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=pt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=pt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&pt.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=P.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Vs=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=P.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,pt.pki&&pt.pki.oids&&f in pt.pki.oids&&(n+=" ("+pt.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+pt.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+pt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)Vs.test(t.value)||(n+="("+t.value+") "),n+="0x"+pt.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=pt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+pt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:Vs.test(t.value)?n+="0x"+pt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Si=Z((iy,Hs)=>{var Nt=ct();At();Hs.exports=Nt.cipher=Nt.cipher||{};Nt.cipher.algorithms=Nt.cipher.algorithms||{};Nt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Nt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Nt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Nt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Nt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Nt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Nt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Nt.cipher.algorithms[t]=e};Nt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Nt.cipher.algorithms?Nt.cipher.algorithms[t]:null};var Bi=Nt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Bi.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Nt.util.createBuffer(),this.output=t.output||Nt.util.createBuffer(),this.mode.start(e)};Bi.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Bi.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Ci=Z((oy,zs)=>{var kt=ct();At();kt.cipher=kt.cipher||{};var X=zs.exports=kt.cipher.modes=kt.cipher.modes||{};X.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.ecb.prototype.start=function(t){};X.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Bn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};X.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};X.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};X.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};X.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Bn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};X.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Bn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb.prototype.decrypt=X.ofb.prototype.encrypt;X.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};X.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Bn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Sn(this._inBlock)};X.ctr.prototype.decrypt=X.ctr.prototype.encrypt;X.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};X.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=kt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=kt.util.createBuffer(t.additionalData):r=kt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=kt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ai(n*8)))}this._inBlock=this._j0.slice(0),Sn(this._inBlock),this._partialBytes=0,r=kt.util.createBuffer(r),this._aDataLength=Ai(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};X.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Sn(this._inBlock)};X.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Sn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};X.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=kt.util.createBuffer();var n=this._aDataLength.concat(Ai(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};X.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};X.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};X.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};X.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};X.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;a[f]=1<<e-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};X.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],f=i[s];i[o+s]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var c=i[o^n];i[o]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function Bn(t,e){if(typeof t=="string"&&(t=kt.util.createBuffer(t)),kt.util.isArray(t)&&t.length>4){var r=t;t=kt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!kt.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function Sn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Ai(t){return[t/4294967296|0,t&4294967295]}});var Li=Z((sy,Ys)=>{var ht=ct();Si();Ci();At();Ys.exports=ht.aes=ht.aes||{};ht.aes.startEncrypting=function(t,e,r,n){var i=An({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};ht.aes.createEncryptionCipher=function(t,e){return An({key:t,output:null,decrypt:!1,mode:e})};ht.aes.startDecrypting=function(t,e,r,n){var i=An({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};ht.aes.createDecryptionCipher=function(t,e){return An({key:t,output:null,decrypt:!0,mode:e})};ht.aes.Algorithm=function(t,e){_i||Ws();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Ti(r._w,n,i,!1)},decrypt:function(n,i){return Ti(r._w,n,i,!0)}}}),r._init=!1};ht.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ht.util.createBuffer(e);else if(ht.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ht.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!ht.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!ht.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=$s(e,t.decrypt&&!s),this._init=!0}};ht.aes._expandKey=function(t,e){return _i||Ws(),$s(t,e)};ht.aes._updateBlock=Ti;Sr("AES-ECB",ht.cipher.modes.ecb);Sr("AES-CBC",ht.cipher.modes.cbc);Sr("AES-CFB",ht.cipher.modes.cfb);Sr("AES-OFB",ht.cipher.modes.ofb);Sr("AES-CTR",ht.cipher.modes.ctr);Sr("AES-GCM",ht.cipher.modes.gcm);function Sr(t,e){var r=function(){return new ht.aes.Algorithm(t,e)};ht.cipher.registerAlgorithm(t,r)}var _i=!1,Br=4,zt,Ii,Gs,nr,te;function Ws(){_i=!0,Gs=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;zt=new Array(256),Ii=new Array(256),nr=new Array(4),te=new Array(4);for(var e=0;e<4;++e)nr[e]=new Array(256),te[e]=new Array(256);for(var r=0,n=0,i,o,s,a,f,c,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,zt[r]=a,Ii[a]=r,f=t[a],i=t[r],o=t[i],s=t[o],c=f<<24^a<<16^a<<8^(a^f),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var l=0;l<4;++l)nr[l][r]=c,te[l][a]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function $s(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=Br*s,f=o;f<a;++f)n=r[f-1],f%o===0?(n=zt[n>>>16&255]<<24^zt[n>>>8&255]<<16^zt[n&255]<<8^zt[n>>>24]^Gs[i]<<24,i++):o>6&&f%o===4&&(n=zt[n>>>24]<<24^zt[n>>>16&255]<<16^zt[n>>>8&255]<<8^zt[n&255]),r[f]=r[f-o]^n;if(e){var c,u=te[0],l=te[1],h=te[2],y=te[3],d=r.slice(0);a=r.length;for(var f=0,p=a-Br;f<a;f+=Br,p-=Br)if(f===0||f===a-Br)d[f]=r[p],d[f+1]=r[p+3],d[f+2]=r[p+2],d[f+3]=r[p+1];else for(var g=0;g<Br;++g)c=r[p+g],d[f+(3&-g)]=u[zt[c>>>24]]^l[zt[c>>>16&255]]^h[zt[c>>>8&255]]^y[zt[c&255]];r=d}return r}function Ti(t,e,r,n){var i=t.length/4-1,o,s,a,f,c;n?(o=te[0],s=te[1],a=te[2],f=te[3],c=Ii):(o=nr[0],s=nr[1],a=nr[2],f=nr[3],c=zt);var u,l,h,y,d,p,g;u=e[0]^t[0],l=e[n?3:1]^t[1],h=e[2]^t[2],y=e[n?1:3]^t[3];for(var m=3,w=1;w<i;++w)d=o[u>>>24]^s[l>>>16&255]^a[h>>>8&255]^f[y&255]^t[++m],p=o[l>>>24]^s[h>>>16&255]^a[y>>>8&255]^f[u&255]^t[++m],g=o[h>>>24]^s[y>>>16&255]^a[u>>>8&255]^f[l&255]^t[++m],y=o[y>>>24]^s[u>>>16&255]^a[l>>>8&255]^f[h&255]^t[++m],u=d,l=p,h=g;r[0]=c[u>>>24]<<24^c[l>>>16&255]<<16^c[h>>>8&255]<<8^c[y&255]^t[++m],r[n?3:1]=c[l>>>24]<<24^c[h>>>16&255]<<16^c[y>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[h>>>24]<<24^c[y>>>16&255]<<16^c[u>>>8&255]<<8^c[l&255]^t[++m],r[n?1:3]=c[y>>>24]<<24^c[u>>>16&255]<<16^c[l>>>8&255]<<8^c[h&255]^t[++m]}function An(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=ht.cipher.createDecipher(r,t.key):n=ht.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof ht.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Xs=Z((ay,Qs)=>{var gt=ct();Si();Ci();At();Qs.exports=gt.des=gt.des||{};gt.des.startEncrypting=function(t,e,r,n){var i=Cn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};gt.des.createEncryptionCipher=function(t,e){return Cn({key:t,output:null,decrypt:!1,mode:e})};gt.des.startDecrypting=function(t,e,r,n){var i=Cn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};gt.des.createDecryptionCipher=function(t,e){return Cn({key:t,output:null,decrypt:!0,mode:e})};gt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Zs(r._keys,n,i,!1)},decrypt:function(n,i){return Zs(r._keys,n,i,!0)}}}),r._init=!1};gt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=gt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=hu(e),this._init=!0}};ce("DES-ECB",gt.cipher.modes.ecb);ce("DES-CBC",gt.cipher.modes.cbc);ce("DES-CFB",gt.cipher.modes.cfb);ce("DES-OFB",gt.cipher.modes.ofb);ce("DES-CTR",gt.cipher.modes.ctr);ce("3DES-ECB",gt.cipher.modes.ecb);ce("3DES-CBC",gt.cipher.modes.cbc);ce("3DES-CFB",gt.cipher.modes.cfb);ce("3DES-OFB",gt.cipher.modes.ofb);ce("3DES-CTR",gt.cipher.modes.ctr);function ce(t,e){var r=function(){return new gt.des.Algorithm(t,e)};gt.cipher.registerAlgorithm(t,r)}var iu=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],ou=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],su=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],au=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],fu=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],cu=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],uu=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],lu=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function hu(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,g=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,b,L=0;L<p;L++){var E=t.getInt32(),B=t.getInt32();b=(E>>>4^B)&252645135,B^=b,E^=b<<4,b=(B>>>-16^E)&65535,E^=b,B^=b<<-16,b=(E>>>2^B)&858993459,B^=b,E^=b<<2,b=(B>>>-16^E)&65535,E^=b,B^=b<<-16,b=(E>>>1^B)&1431655765,B^=b,E^=b<<1,b=(B>>>8^E)&16711935,E^=b,B^=b<<8,b=(E>>>1^B)&1431655765,B^=b,E^=b<<1,b=E<<8|B>>>20&240,E=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var R=0;R<m.length;++R){m[R]?(E=E<<2|E>>>26,B=B<<2|B>>>26):(E=E<<1|E>>>27,B=B<<1|B>>>27),E&=-15,B&=-15;var D=e[E>>>28]|r[E>>>24&15]|n[E>>>20&15]|i[E>>>16&15]|o[E>>>12&15]|s[E>>>8&15]|a[E>>>4&15],z=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|l[B>>>16&15]|h[B>>>12&15]|y[B>>>8&15]|d[B>>>4&15];b=(z>>>16^D)&65535,g[w++]=D^b,g[w++]=z^b<<16}}return g}function Zs(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],f=e[1];s=(a>>>4^f)&252645135,f^=s,a^=s<<4,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=o[c+1],l=o[c+2],h=o[c];h!=u;h+=l){var y=f^t[h],d=(f>>>4|f<<28)^t[h+1];s=a,a=f,f=s^(ou[y>>>24&63]|au[y>>>16&63]|cu[y>>>8&63]|lu[y&63]|iu[d>>>24&63]|su[d>>>16&63]|fu[d>>>8&63]|uu[d&63])}s=a,a=f,f=s}a=a>>>1|a<<31,f=f>>>1|f<<31,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(a>>>4^f)&252645135,f^=s,a^=s<<4,r[0]=a,r[1]=f}function Cn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=gt.cipher.createDecipher(r,t.key):n=gt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof gt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var ir=Z((fy,Js)=>{var In=ct();Js.exports=In.md=In.md||{};In.md.algorithms=In.md.algorithms||{}});var ta=Z((cy,js)=>{var Be=ct();ir();At();var du=js.exports=Be.hmac=Be.hmac||{};du.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Be.md.algorithms)e=Be.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=Be.util.createBuffer(s);else if(Be.util.isArray(s)){var a=s;s=Be.util.createBuffer();for(var f=0;f<a.length;++f)s.putByte(a[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=Be.util.createBuffer(),n=Be.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var a=s.at(f);r.putByte(54^a),n.putByte(92^a)}if(c<e.blockLength)for(var a=e.blockLength-c,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var Tn=Z(()=>{});var ra=Z((hy,ea)=>{var Gt=ct();ta();ir();At();var pu=Gt.pkcs5=Gt.pkcs5||{},Se;Gt.util.isNodejs&&!Gt.options.usePureJavaScript&&(Se=Tn());ea.exports=Gt.pbkdf2=pu.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Gt.util.isNodejs&&!Gt.options.usePureJavaScript&&Se.pbkdf2&&(i===null||typeof i!="object")&&(Se.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Se.pbkdf2Sync.length===4?Se.pbkdf2(t,e,r,n,function(b,L){if(b)return o(b);o(null,L.toString("binary"))}):Se.pbkdf2(t,e,r,n,i,function(b,L){if(b)return o(b);o(null,L.toString("binary"))}):Se.pbkdf2Sync.length===4?Se.pbkdf2Sync(t,e,r,n).toString("binary"):Se.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Gt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Gt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Gt.hmac.create();u.start(i,t);var l="",h,y,d;if(!o){for(var p=1;p<=f;++p){u.start(null,null),u.update(e),u.update(Gt.util.int32ToBytes(p)),h=d=u.digest().getBytes();for(var g=2;g<=r;++g)u.start(null,null),u.update(d),y=u.digest().getBytes(),h=Gt.util.xorBytes(h,y,s),d=y;l+=p<f?h:h.substr(0,c)}return l}var p=1,g;function m(){if(p>f)return o(null,l);u.start(null,null),u.update(e),u.update(Gt.util.int32ToBytes(p)),h=d=u.digest().getBytes(),g=2,w()}function w(){if(g<=r)return u.start(null,null),u.update(d),y=u.digest().getBytes(),h=Gt.util.xorBytes(h,y,s),d=y,++g,Gt.util.setImmediate(w);l+=p<f?h:h.substr(0,c),++p,m()}m()}});var oa=Z((dy,ia)=>{var Ln=ct();At();var na=ia.exports=Ln.pem=Ln.pem||{};na.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=_n(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=_n(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=_n(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=_n(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Ln.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};na.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Ln.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var f=o[2].split(i),c=0;o&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),l=c+1;l<f.length;++l){var h=f[l];if(!/\s/.test(h[0]))break;u+=h,c=l}if(o=u.match(n),o){for(var y={name:o[1],values:[]},d=o[2].split(","),p=0;p<d.length;++p)y.values.push(yu(d[p]));if(a.procType)if(!a.contentDomain&&y.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&y.name==="DEK-Info"){if(y.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(y);else{if(y.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(y.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++c}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function _n(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function yu(t){return t.replace(/^\s+/,"")}});var la=Z((py,ua)=>{var ue=ct();ir();At();var aa=ua.exports=ue.sha256=ue.sha256||{};ue.md.sha256=ue.md.algorithms.sha256=aa;aa.create=function(){fa||gu();var t=null,e=ue.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=ue.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=ue.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),sa(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ue.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Ri.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var l={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};sa(l,r,i);var h=ue.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h.putInt32(l.h5),h.putInt32(l.h6),h.putInt32(l.h7),h},n};var Ri=null,fa=!1,ca=null;function gu(){Ri=String.fromCharCode(128),Ri+=ue.util.fillString(String.fromCharCode(0),64),ca=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],fa=!0}function sa(t,e,r){for(var n,i,o,s,a,f,c,u,l,h,y,d,p,g,m,w=r.length();w>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,l=t.h1,h=t.h2,y=t.h3,d=t.h4,p=t.h5,g=t.h6,m=t.h7,c=0;c<64;++c)s=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=g^d&(p^g),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&l|h&(u^l),n=m+s+a+ca[c]+e[c],i=o+f,m=g,g=p,p=d,d=y+n>>>0,y=h,h=l,l=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+l|0,t.h2=t.h2+h|0,t.h3=t.h3+y|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+g|0,t.h7=t.h7+m|0,w-=64}}});var da=Z((yy,ha)=>{var le=ct();At();var Rn=null;le.util.isNodejs&&!le.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Rn=Tn());var xu=ha.exports=le.prng=le.prng||{};xu.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var l=e.plugin.cipher,h=e.plugin.increment,y=e.plugin.formatKey,d=e.plugin.formatSeed,p=le.util.createBuffer();e.key=null,g();function g(m){if(m)return u(m);if(p.length()>=c)return u(null,p.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return le.util.nextTick(function(){o(g)});var w=l(e.key,e.seed);e.generated+=w.length,p.putBytes(w),e.key=y(l(e.key,h(e.seed))),e.seed=d(l(e.key,e.seed)),le.util.setImmediate(g)}},e.generateSync=function(c){var u=e.plugin.cipher,l=e.plugin.increment,h=e.plugin.formatKey,y=e.plugin.formatSeed;e.key=null;for(var d=le.util.createBuffer();d.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=h(u(e.key,l(e.seed))),e.seed=y(u(e.key,e.seed))}return d.getBytes(c)};function o(c){if(e.pools[0].messageLength>=32)return a(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(l,h){if(l)return c(l);e.collect(h),a(),c()})}function s(){if(e.pools[0].messageLength>=32)return a();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,l=0;l<32;++l)e.reseeds%u===0&&(c.update(e.pools[l].digest().getBytes()),e.pools[l].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var h=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function f(c){var u=null,l=le.util.globalScope,h=l.crypto||l.msCrypto;h&&h.getRandomValues&&(u=function(E){return h.getRandomValues(E)});var y=le.util.createBuffer();if(u)for(;y.length()<c;){var d=Math.max(1,Math.min(c-y.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var g=0;g<p.length;++g)y.putInt32(p[g])}catch(E){if(!(typeof QuotaExceededError<"u"&&E instanceof QuotaExceededError))throw E}}if(y.length()<c)for(var m,w,b,L=Math.floor(Math.random()*65536);y.length()<c;){w=16807*(L&65535),m=16807*(L>>16),w+=(m&32767)<<16,w+=m>>15,w=(w&2147483647)+(w>>31),L=w&4294967295;for(var g=0;g<3;++g)b=L>>>(g<<3),b^=Math.floor(Math.random()*256),y.putByte(b&255)}return y.getBytes(c)}return Rn?(e.seedFile=function(c,u){Rn.randomBytes(c,function(l,h){if(l)return u(l);u(null,h.toString())})},e.seedFileSync=function(c){return Rn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(l){u(l)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,l=0;l<u;++l)e.pools[e.pool].update(c.substr(l,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var l="",h=0;h<u;h+=8)l+=String.fromCharCode(c>>h&255);e.collect(l)},e.registerWorker=function(c){if(c===self)e.seedFile=function(l,h){function y(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",y),h(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:l}}})};else{var u=function(l){var h=l.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(y,d){c.postMessage({forge:{prng:{err:y,bytes:d}}})})};c.addEventListener("message",u)}},e}});var Jr=Z((gy,Di)=>{var Pt=ct();Li();la();da();At();(function(){if(Pt.random&&Pt.random.getBytes){Di.exports=Pt.random;return}(function(t){var e={},r=new Array(4),n=Pt.util.createBuffer();e.formatKey=function(l){var h=Pt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),Pt.aes._expandKey(l,!1)},e.formatSeed=function(l){var h=Pt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),l},e.cipher=function(l,h){return Pt.aes._updateBlock(l,h,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(l){return++l[3],l},e.md=Pt.md.sha256;function i(){var l=Pt.prng.create(e);return l.getBytes=function(h,y){return l.generate(h,y)},l.getBytesSync=function(h){return l.generate(h)},l}var o=i(),s=null,a=Pt.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(s=function(l){return f.getRandomValues(l)}),Pt.options.usePureJavaScript||!Pt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}o.collect(c),c=null}t&&(t().mousemove(function(l){o.collectInt(l.clientX,16),o.collectInt(l.clientY,16)}),t().keypress(function(l){o.collectInt(l.charCode,8)}))}if(!Pt.random)Pt.random=o;else for(var u in o)Pt.random[u]=o[u];Pt.random.createInstance=i,Di.exports=Pt.random})(typeof jQuery<"u"?jQuery:null)})()});var xa=Z((xy,ga)=>{var Wt=ct();At();var Ni=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],pa=[1,2,3,5],mu=function(t,e){return t<<e&65535|(t&65535)>>16-e},vu=function(t,e){return(t&65535)>>e|t<<16-e&65535};ga.exports=Wt.rc2=Wt.rc2||{};Wt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Wt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Ni[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,Ni[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,Ni[r.at(a+1)^r.at(a+o)]);return r};var ya=function(t,e,r){var n=!1,i=null,o=null,s=null,a,f,c,u,l=[];for(t=Wt.rc2.expandKey(t,e),c=0;c<64;c++)l.push(t.getInt16Le());r?(a=function(d){for(c=0;c<4;c++)d[c]+=l[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),d[c]=mu(d[c],pa[c]),u++},f=function(d){for(c=0;c<4;c++)d[c]+=l[d[(c+3)%4]&63]}):(a=function(d){for(c=3;c>=0;c--)d[c]=vu(d[c],pa[c]),d[c]-=l[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),u--},f=function(d){for(c=3;c>=0;c--)d[c]-=l[d[(c+3)%4]&63]});var h=function(d){var p=[];for(c=0;c<4;c++){var g=i.getInt16Le();s!==null&&(r?g^=s.getInt16Le():s.putInt16Le(g)),p.push(g&65535)}u=r?0:63;for(var m=0;m<d.length;m++)for(var w=0;w<d[m][0];w++)d[m][1](p);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(p[c]):p[c]^=s.getInt16Le()),o.putInt16Le(p[c])},y=null;return y={start:function(d,p){d&&typeof d=="string"&&(d=Wt.util.createBuffer(d)),n=!1,i=Wt.util.createBuffer(),o=p||new Wt.util.createBuffer,s=d,y.output=o},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)h([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var g=i.length()===8?8:8-i.length();i.fillWithByte(g,g)}if(p&&(n=!0,y.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,o,!r);else{var m=o.length(),w=o.at(m-1);w>m?p=!1:o.truncate(w)}return p}},y};Wt.rc2.startEncrypting=function(t,e,r){var n=Wt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Wt.rc2.createEncryptionCipher=function(t,e){return ya(t,e,!0)};Wt.rc2.startDecrypting=function(t,e,r){var n=Wt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Wt.rc2.createDecryptionCipher=function(t,e){return ya(t,e,!1)}});var kn=Z((my,Aa)=>{var ki=ct();Aa.exports=ki.jsbn=ki.jsbn||{};var Ae,bu=0xdeadbeefcafe,ma=(bu&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}ki.jsbn.BigInteger=C;function rt(){return new C(null)}function wu(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Eu(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=a*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+a*c+(i>>>30),r.data[n++]=f&1073741823}return i}function va(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=a*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+a*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=va,Ae=28):ma&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Eu,Ae=30):ma&&navigator.appName!="Netscape"?(C.prototype.am=wu,Ae=26):(C.prototype.am=va,Ae=28);C.prototype.DB=Ae;C.prototype.DM=(1<<Ae)-1;C.prototype.DV=1<<Ae;var Pi=52;C.prototype.FV=Math.pow(2,Pi);C.prototype.F1=Pi-Ae;C.prototype.F2=2*Ae-Pi;var Bu="0123456789abcdefghijklmnopqrstuvwxyz",Dn=new Array,Ar,Qt;Ar="0".charCodeAt(0);for(Qt=0;Qt<=9;++Qt)Dn[Ar++]=Qt;Ar="a".charCodeAt(0);for(Qt=10;Qt<36;++Qt)Dn[Ar++]=Qt;Ar="A".charCodeAt(0);for(Qt=10;Qt<36;++Qt)Dn[Ar++]=Qt;function ba(t){return Bu.charAt(t)}function wa(t,e){var r=Dn[t.charCodeAt(e)];return r??-1}function Su(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Au(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function He(t){var e=rt();return e.fromInt(t),e}function Cu(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:wa(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Iu(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Tu(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=ba(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=ba(n));return i?o:"0"}function _u(){var t=rt();return C.ZERO.subTo(this,t),t}function Lu(){return this.s<0?this.negate():this}function Ru(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Nn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Du(){return this.t<=0?0:this.DB*(this.t-1)+Nn(this.data[this.t-1]^this.s&this.DM)}function Nu(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function ku(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Pu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function Uu(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function Ku(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Ou(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function Mu(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function qu(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=rt());var o=rt(),s=this.s,a=t.s,f=this.DB-Nn(n.data[n.t-1]);f>0?(n.lShiftTo(f,o),i.lShiftTo(f,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,u=o.data[c-1];if(u!=0){var l=u*(1<<this.F1)+(c>1?o.data[c-2]>>this.F2:0),h=this.FV/l,y=(1<<this.F1)/l,d=1<<this.F2,p=r.t,g=p-c,m=e??rt();for(o.dlShiftTo(g,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(o,o);o.t<c;)o.data[o.t++]=0;for(;--g>=0;){var w=r.data[--p]==u?this.DM:Math.floor(r.data[p]*h+(r.data[p-1]+d)*y);if((r.data[p]+=o.am(0,w,r,g,0,c))<w)for(o.dlShiftTo(g,m),r.subTo(m,r);r.data[p]<--w;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=a&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function Vu(t){var e=rt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function or(t){this.m=t}function Fu(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Hu(t){return t}function zu(t){t.divRemTo(this.m,null,t)}function Gu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Wu(t,e){t.squareTo(e),this.reduce(e)}or.prototype.convert=Fu;or.prototype.revert=Hu;or.prototype.reduce=zu;or.prototype.mulTo=Gu;or.prototype.sqrTo=Wu;function $u(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function sr(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Yu(t){var e=rt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function Zu(t){var e=rt();return t.copyTo(e),this.reduce(e),e}function Qu(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Xu(t,e){t.squareTo(e),this.reduce(e)}function Ju(t,e,r){t.multiplyTo(e,r),this.reduce(r)}sr.prototype.convert=Yu;sr.prototype.revert=Zu;sr.prototype.reduce=Qu;sr.prototype.mulTo=Ju;sr.prototype.sqrTo=Xu;function ju(){return(this.t>0?this.data[0]&1:this.s)==0}function tl(t,e){if(t>4294967295||t<1)return C.ONE;var r=rt(),n=rt(),i=e.convert(this),o=Nn(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function el(t,e){var r;return t<256||e.isEven()?r=new or(e):r=new sr(e),this.exp(t,r)}C.prototype.copyTo=Su;C.prototype.fromInt=Au;C.prototype.fromString=Cu;C.prototype.clamp=Iu;C.prototype.dlShiftTo=Nu;C.prototype.drShiftTo=ku;C.prototype.lShiftTo=Pu;C.prototype.rShiftTo=Uu;C.prototype.subTo=Ku;C.prototype.multiplyTo=Ou;C.prototype.squareTo=Mu;C.prototype.divRemTo=qu;C.prototype.invDigit=$u;C.prototype.isEven=ju;C.prototype.exp=tl;C.prototype.toString=Tu;C.prototype.negate=_u;C.prototype.abs=Lu;C.prototype.compareTo=Ru;C.prototype.bitLength=Du;C.prototype.mod=Vu;C.prototype.modPowInt=el;C.ZERO=He(0);C.ONE=He(1);function rl(){var t=rt();return this.copyTo(t),t}function nl(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function il(){return this.t==0?this.s:this.data[0]<<24>>24}function ol(){return this.t==0?this.s:this.data[0]<<16>>16}function sl(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function al(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function fl(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=He(r),i=rt(),o=rt(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function cl(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var f=wa(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function ul(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),Ui,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ll(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function hl(t){return this.compareTo(t)==0}function dl(t){return this.compareTo(t)<0?this:t}function pl(t){return this.compareTo(t)>0?this:t}function yl(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function gl(t,e){return t&e}function xl(t){var e=rt();return this.bitwiseTo(t,gl,e),e}function Ui(t,e){return t|e}function ml(t){var e=rt();return this.bitwiseTo(t,Ui,e),e}function Ea(t,e){return t^e}function vl(t){var e=rt();return this.bitwiseTo(t,Ea,e),e}function Ba(t,e){return t&~e}function bl(t){var e=rt();return this.bitwiseTo(t,Ba,e),e}function wl(){for(var t=rt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function El(t){var e=rt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Bl(t){var e=rt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Sl(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Al(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Sl(this.data[t]);return this.s<0?this.t*this.DB:-1}function Cl(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Il(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Cl(this.data[r]^e);return t}function Tl(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function _l(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Ll(t){return this.changeBit(t,Ui)}function Rl(t){return this.changeBit(t,Ba)}function Dl(t){return this.changeBit(t,Ea)}function Nl(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function kl(t){var e=rt();return this.addTo(t,e),e}function Pl(t){var e=rt();return this.subTo(t,e),e}function Ul(t){var e=rt();return this.multiplyTo(t,e),e}function Kl(t){var e=rt();return this.divRemTo(t,e,null),e}function Ol(t){var e=rt();return this.divRemTo(t,null,e),e}function Ml(t){var e=rt(),r=rt();return this.divRemTo(t,e,r),new Array(e,r)}function ql(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Vl(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function jr(){}function Sa(t){return t}function Fl(t,e,r){t.multiplyTo(e,r)}function Hl(t,e){t.squareTo(e)}jr.prototype.convert=Sa;jr.prototype.revert=Sa;jr.prototype.mulTo=Fl;jr.prototype.sqrTo=Hl;function zl(t){return this.exp(t,new jr)}function Gl(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Wl(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Cr(t){this.r2=rt(),this.q3=rt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function $l(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=rt();return t.copyTo(e),this.reduce(e),e}function Yl(t){return t}function Zl(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ql(t,e){t.squareTo(e),this.reduce(e)}function Xl(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Cr.prototype.convert=$l;Cr.prototype.revert=Yl;Cr.prototype.reduce=Zl;Cr.prototype.mulTo=Xl;Cr.prototype.sqrTo=Ql;function Jl(t,e){var r=t.bitLength(),n,i=He(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new or(e):e.isEven()?o=new Cr(e):o=new sr(e);var s=new Array,a=3,f=n-1,c=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=rt();for(o.sqrTo(s[1],u);a<=c;)s[a]=rt(),o.mulTo(u,s[a-2],s[a]),a+=2}var l=t.t-1,h,y=!0,d=rt(),p;for(r=Nn(t.data[l])-1;l>=0;){for(r>=f?h=t.data[l]>>r-f&c:(h=(t.data[l]&(1<<r+1)-1)<<f-r,l>0&&(h|=t.data[l-1]>>this.DB+r-f)),a=n;!(h&1);)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--l),y)s[h].copyTo(i),y=!1;else{for(;a>1;)o.sqrTo(i,d),o.sqrTo(d,i),a-=2;a>0?o.sqrTo(i,d):(p=i,i=d,d=p),o.mulTo(d,s[h],i)}for(;l>=0&&!(t.data[l]&1<<r);)o.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--l)}return o.revert(i)}function jl(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function th(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function eh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=He(1),o=He(0),s=He(0),a=He(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var ee=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],rh=(1<<26)/ee[ee.length-1];function nh(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=ee[ee.length-1]){for(e=0;e<ee.length;++e)if(r.data[0]==ee[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ee.length;){for(var n=ee[e],i=e+1;i<ee.length&&n<rh;)n*=ee[i++];for(n=r.modInt(n);e<i;)if(n%ee[e++]==0)return!1}return r.millerRabin(t)}function ih(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=oh(),o,s=0;s<t;++s){do o=new C(this.bitLength(),i);while(o.compareTo(C.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(C.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(C.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function oh(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=sl;C.prototype.toRadix=fl;C.prototype.fromRadix=cl;C.prototype.fromNumber=ul;C.prototype.bitwiseTo=yl;C.prototype.changeBit=_l;C.prototype.addTo=Nl;C.prototype.dMultiply=ql;C.prototype.dAddOffset=Vl;C.prototype.multiplyLowerTo=Gl;C.prototype.multiplyUpperTo=Wl;C.prototype.modInt=th;C.prototype.millerRabin=ih;C.prototype.clone=rl;C.prototype.intValue=nl;C.prototype.byteValue=il;C.prototype.shortValue=ol;C.prototype.signum=al;C.prototype.toByteArray=ll;C.prototype.equals=hl;C.prototype.min=dl;C.prototype.max=pl;C.prototype.and=xl;C.prototype.or=ml;C.prototype.xor=vl;C.prototype.andNot=bl;C.prototype.not=wl;C.prototype.shiftLeft=El;C.prototype.shiftRight=Bl;C.prototype.getLowestSetBit=Al;C.prototype.bitCount=Il;C.prototype.testBit=Tl;C.prototype.setBit=Ll;C.prototype.clearBit=Rl;C.prototype.flipBit=Dl;C.prototype.add=kl;C.prototype.subtract=Pl;C.prototype.multiply=Ul;C.prototype.divide=Kl;C.prototype.remainder=Ol;C.prototype.divideAndRemainder=Ml;C.prototype.modPow=Jl;C.prototype.modInverse=eh;C.prototype.pow=zl;C.prototype.gcd=jl;C.prototype.isProbablePrime=nh});var La=Z((vy,_a)=>{var he=ct();ir();At();var Ia=_a.exports=he.sha1=he.sha1||{};he.md.sha1=he.md.algorithms.sha1=Ia;Ia.create=function(){Ta||sh();var t=null,e=he.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=he.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=he.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Ca(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=he.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Ki.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var l={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Ca(l,r,i);var h=he.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h},n};var Ki=null,Ta=!1;function sh(){Ki=String.fromCharCode(128),Ki+=he.util.fillString(String.fromCharCode(0),64),Ta=!0}function Ca(t,e,r){for(var n,i,o,s,a,f,c,u,l=r.length();l>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o&s|a&(o^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+3395469782+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,l-=64}}});var Na=Z((by,Da)=>{var de=ct();At();Jr();La();var Ra=Da.exports=de.pkcs1=de.pkcs1||{};Ra.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=de.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),f=a-2*o.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),o.update(n,"raw");for(var u=o.digest(),l="",h=f-e.length,y=0;y<h;y++)l+="\0";var d=u.getBytes()+l+""+e;if(!i)i=de.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=o.digestLength,c}var p=Pn(i,a-o.digestLength-1,s),g=de.util.xorBytes(d,p,d.length),m=Pn(g,o.digestLength,s),w=de.util.xorBytes(i,m,i.length);return"\0"+w+g};Ra.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=e.length,g.expectedLength=s,g}if(i===void 0?i=de.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),l=Pn(u,i.digestLength,o),h=de.util.xorBytes(c,l,c.length),y=Pn(h,s-i.digestLength-1,o),d=de.util.xorBytes(u,y,u.length),p=d.substring(0,i.digestLength),g=f!=="\0",m=0;m<i.digestLength;++m)g|=a.charAt(m)!==p.charAt(m);for(var w=1,b=i.digestLength,L=i.digestLength;L<d.length;L++){var E=d.charCodeAt(L),B=E&1^1,R=w?65534:0;g|=E&R,w=w&B,b+=w}if(g||d.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)};function Pn(t,e,r){r||(r=de.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var ka=Z((wy,Oi)=>{var ze=ct();At();kn();Jr();(function(){if(ze.prime){Oi.exports=ze.prime;return}var t=Oi.exports=ze.prime=ze.prime||{},e=ze.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(l,h){return l|h};t.generateProbablePrime=function(l,h,y){typeof h=="function"&&(y=h,h={}),h=h||{};var d=h.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=h.prng||ze.random,g={nextBytes:function(m){for(var w=p.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=w.charCodeAt(b)}};if(d.name==="PRIMEINC")return o(l,g,d.options,y);throw new Error("Invalid prime generation algorithm: "+d.name)};function o(l,h,y,d){return"workers"in y?f(l,h,y,d):s(l,h,y,d)}function s(l,h,y,d){var p=c(l,h),g=0,m=u(p.bitLength());"millerRabinTests"in y&&(m=y.millerRabinTests);var w=10;"maxBlockTime"in y&&(w=y.maxBlockTime),a(p,l,h,g,m,w,d)}function a(l,h,y,d,p,g,m){var w=+new Date;do{if(l.bitLength()>h&&(l=c(h,y)),l.isProbablePrime(p))return m(null,l);l.dAddOffset(r[d++%8],0)}while(g<0||+new Date-w<g);ze.util.setImmediate(function(){a(l,h,y,d,p,g,m)})}function f(l,h,y,d){if(typeof Worker>"u")return s(l,h,y,d);var p=c(l,h),g=y.workers,m=y.workLoad||100,w=m*30/8,b=y.workerScript||"forge/prime.worker.js";if(g===-1)return ze.util.estimateCores(function(E,B){E&&(B=2),g=B-1,L()});L();function L(){g=Math.max(1,g);for(var E=[],B=0;B<g;++B)E[B]=new Worker(b);for(var R=g,B=0;B<g;++B)E[B].addEventListener("message",z);var D=!1;function z(H){if(!D){--R;var V=H.data;if(V.found){for(var J=0;J<E.length;++J)E[J].terminate();return D=!0,d(null,new e(V.prime,16))}p.bitLength()>l&&(p=c(l,h));var ft=p.toString(16);H.target.postMessage({hex:ft,workLoad:m}),p.dAddOffset(w,0)}}}}function c(l,h){var y=new e(l,h),d=l-1;return y.testBit(d)||y.bitwiseTo(e.ONE.shiftLeft(d),i,y),y.dAddOffset(31-y.mod(n).byteValue(),0),y}function u(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}})()});var Kn=Z((Ey,Va)=>{var q=ct();Xr();kn();wn();Na();ka();Jr();At();typeof et>"u"&&(et=q.jsbn.BigInteger);var et,Mi=q.util.isNodejs?Tn():null,v=q.asn1,Xt=q.util;q.pki=q.pki||{};Va.exports=q.pki.rsa=q.rsa=q.rsa||{};var G=q.pki,ah=[6,4,2,4,2,4,6,2],fh={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},ch={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},uh={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},lh=q.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},hh={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},dh=function(t){var e;if(t.algorithm in G.oids)e=G.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),o=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);o.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),o.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),v.toDer(i).getBytes()},Ma=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(et.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(et.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new et(q.util.bytesToHex(q.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(et.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};G.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=qa(t,e,r)):(i=q.util.createBuffer(),i.putBytes(t));for(var s=new et(i.toHex(),16),a=Ma(s,e,n),f=a.toString(16),c=q.util.createBuffer(),u=o-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),c.getBytes()};G.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new et(q.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Ma(s,e,r),f=a.toString(16),c=q.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),n!==!1?Un(c.getBytes(),e,r):c.getBytes()};G.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||q.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=f.charCodeAt(c)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new et(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};G.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new et(null);r.fromInt(30);for(var n=0,i=function(l,h){return l|h},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new et(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(et.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(yh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(ah[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(et.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};G.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!q.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Pa("generateKeyPair"))return Mi.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,c){if(a)return n(a);n(null,{privateKey:G.privateKeyFromPem(c),publicKey:G.publicKeyFromPem(f)})});if(Ua("generateKey")&&Ua("exportKey"))return Xt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Oa(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Xt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=G.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(a)));n(null,{privateKey:f,publicKey:G.setRsaPublicKey(f.n,f.e)})}});if(Ka("generateKey")&&Ka("exportKey")){var i=Xt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Oa(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,c=Xt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var l=u.target.result,h=G.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(l)));n(null,{privateKey:h,publicKey:G.setRsaPublicKey(h.n,h.e)})},c.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(Pa("generateKeyPairSync")){var o=Mi.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:G.privateKeyFromPem(o.privateKey),publicKey:G.publicKeyFromPem(o.publicKey)}}}var s=G.rsa.createKeyPairGenerationState(t,e,r);if(!n)return G.rsa.stepKeyPairGenerationState(s,0),s.keys;ph(s,r,n)};G.setRsaPublicKey=G.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,c){return qa(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return q.pkcs1.encode_rsa_oaep(f,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return G.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(f,c){c=Un(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),l={},h=[];if(!v.validate(u,hh,l,h)){var y=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw y.errors=h,y}var d=v.derToOid(l.algorithmIdentifier);if(!(d===q.oids.md2||d===q.oids.md5||d===q.oids.sha1||d===q.oids.sha224||d===q.oids.sha256||d===q.oids.sha384||d===q.oids.sha512||d===q.oids["sha512-224"]||d===q.oids["sha512-256"])){var y=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw y.oid=d,y}if((d===q.oids.md2||d===q.oids.md5)&&!("parameters"in l))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===l.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(f,c){return c=Un(c,r,!0),f===c}});var a=G.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};G.setRsaPrivateKey=G.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var f={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return f.decrypt=function(c,u,l){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var h=G.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Un};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(y,d){return q.pkcs1.decode_rsa_oaep(d,y,l)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(h,f,!1)},f.sign=function(c,u){var l=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:dh},l=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},l=1);var h=u.encode(c,f.n.bitLength());return G.rsa.encrypt(h,f,l)},f};G.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};G.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,fh,e,r)&&(t=v.fromDer(q.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,ch,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,f,c,u,l;return i=q.util.createBuffer(e.privateKeyModulus).toHex(),o=q.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=q.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=q.util.createBuffer(e.privateKeyPrime1).toHex(),f=q.util.createBuffer(e.privateKeyPrime2).toHex(),c=q.util.createBuffer(e.privateKeyExponent1).toHex(),u=q.util.createBuffer(e.privateKeyExponent2).toHex(),l=q.util.createBuffer(e.privateKeyCoefficient).toHex(),G.setRsaPrivateKey(new et(i,16),new et(o,16),new et(s,16),new et(a,16),new et(f,16),new et(c,16),new et(u,16),new et(l,16))};G.privateKeyToAsn1=G.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.qInv))])};G.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,lh,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==G.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,uh,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=q.util.createBuffer(e.publicKeyModulus).toHex(),s=q.util.createBuffer(e.publicKeyExponent).toHex();return G.setRsaPublicKey(new et(o,16),new et(s,16))};G.publicKeyToAsn1=G.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[G.publicKeyToRSAPublicKey(t)])])};G.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.e))])};function qa(t,e,r){var n=q.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<s;++f)n.putByte(a)}else for(;s>0;){for(var c=0,u=q.random.getBytes(s),f=0;f<s;++f)a=u.charCodeAt(f),a===0?++c:n.putByte(a);s=c}return n.putByte(0),n.putBytes(t),n}function Un(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=q.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var c=0;c<f;++c)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++f}else if(a===2)for(f=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++f}var u=o.getByte();if(u!==0||f!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function ph(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,f){q.prime.generateProbablePrime(a,n,f)}function s(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.p=null,i();return}if(t.q.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(et.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function pe(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=q.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function yh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Pa(t){return q.util.isNodejs&&typeof Mi[t]=="function"}function Ua(t){return typeof Xt.globalScope<"u"&&typeof Xt.globalScope.crypto=="object"&&typeof Xt.globalScope.crypto.subtle=="object"&&typeof Xt.globalScope.crypto.subtle[t]=="function"}function Ka(t){return typeof Xt.globalScope<"u"&&typeof Xt.globalScope.msCrypto=="object"&&typeof Xt.globalScope.msCrypto.subtle=="object"&&typeof Xt.globalScope.msCrypto.subtle[t]=="function"}function Oa(t){for(var e=q.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var $a=Z((By,Wa)=>{var U=ct();Li();Xr();Xs();ir();wn();ra();oa();Jr();xa();Kn();At();typeof Fa>"u"&&(Fa=U.jsbn.BigInteger);var Fa,S=U.asn1,W=U.pki=U.pki||{};Wa.exports=W.pbe=U.pbe=U.pbe||{};var ar=W.oids,gh={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},xh={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},mh={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,o=S.integerToDer(i),s,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,l;switch(r.algorithm){case"aes128":s=16,c=16,u=ar["aes128-CBC"],l=U.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=ar["aes192-CBC"],l=U.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=ar["aes256-CBC"],l=U.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=ar.desCBC,l=U.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Ga(y),p=U.pkcs5.pbkdf2(e,n,i,s,d),g=U.random.getBytesSync(c),m=l(p);m.start(g),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes();var w=vh(n,o,s,y);a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(ar.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(ar.pkcs5PBKDF2).getBytes()),w]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(u).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){s=24;var b=new U.util.ByteBuffer(n),p=W.pbe.generatePkcs12Key(e,b,1,i,s),g=W.pbe.generatePkcs12Key(e,b,2,i,s),m=U.des.createEncryptionCipher(p);m.start(g),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes(),a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(ar["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,n),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,o.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var L=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[a,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return L};W.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!S.validate(t,gh,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=S.derToOid(n.encryptionOid),a=W.pbe.getCipher(s,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=S.fromDer(a.output)),r};W.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};W.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};W.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(t));return n=W.encryptPrivateKeyInfo(n,e,r),W.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);u.start(o),u.update(S.toDer(W.privateKeyToAsn1(t))),u.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(l)};W.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=U.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=U.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=U.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(l){return U.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":o=8,s=function(l){return U.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":o=16,s=function(l){return U.rc2.createDecryptionCipher(l,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,a.substr(0,8),o),c=s(f);if(c.start(a),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');o=U.md.sha1.create()}var f=o.digestLength,c=o.blockLength,u=new U.util.ByteBuffer,l=new U.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)l.putInt16(t.charCodeAt(a));l.putInt16(0)}var h=l.length(),y=e.length(),d=new U.util.ByteBuffer;d.fillWithByte(r,c);var p=c*Math.ceil(y/c),g=new U.util.ByteBuffer;for(a=0;a<p;a++)g.putByte(e.at(a%y));var m=c*Math.ceil(h/c),w=new U.util.ByteBuffer;for(a=0;a<m;a++)w.putByte(l.at(a%h));var b=g;b.putBuffer(w);for(var L=Math.ceil(i/f),E=1;E<=L;E++){var B=new U.util.ByteBuffer;B.putBytes(d.bytes()),B.putBytes(b.bytes());for(var R=0;R<n;R++)o.start(),o.update(B.getBytes()),B=o.digest();var D=new U.util.ByteBuffer;for(a=0;a<c;a++)D.putByte(B.at(a%f));var z=Math.ceil(y/c)+Math.ceil(h/c),H=new U.util.ByteBuffer;for(s=0;s<z;s++){var V=new U.util.ByteBuffer(b.getBytes(c)),J=511;for(a=D.length()-1;a>=0;a--)J=J>>8,J+=D.at(a)+V.at(a),V.setAt(a,J&255);H.putBuffer(V)}b=H,u.putBuffer(B)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(t,e,r){switch(t){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(t,e,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!S.validate(e,xh,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=S.derToOid(n.kdfOid),t!==W.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=S.derToOid(n.encOid),t!==W.oids["aes128-CBC"]&&t!==W.oids["aes192-CBC"]&&t!==W.oids["aes256-CBC"]&&t!==W.oids["des-EDE3-CBC"]&&t!==W.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=U.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,c;switch(W.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=za(n.prfOid),l=U.pkcs5.pbkdf2(r,s,a,f,u),h=n.encIv,y=c(l);return y.start(h),y};W.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!S.validate(e,mh,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=U.util.createBuffer(n.salt),a=U.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,c,u;switch(t){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(p,g){var m=U.rc2.createDecryptionCipher(p,40);return m.start(g,null),m};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var l=za(n.prfOid),h=W.pbe.generatePkcs12Key(r,s,1,a,f,l);l.start();var y=W.pbe.generatePkcs12Key(r,s,2,a,c,l);return u(h,y)};W.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[Ha(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(Ha(n,i[s-1]+t+e));return i.join("").substr(0,r)};function Ha(t,e){return t.start().update(e).digest().getBytes()}function za(t){var e;if(!t)e="hmacWithSHA1";else if(e=W.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Ga(e)}function Ga(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function vh(t,e,r,n){var i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(W.oids[n]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),i}});var M0=Z((lg,O0)=>{"use strict";O0.exports=_p;function _p(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,f){r[n]=function(u){if(o)if(o=!1,u)f(u);else{for(var l=new Array(arguments.length-1),h=0;h<l.length;)l[h++]=arguments[h];a.apply(null,l)}};try{t.apply(e||null,r)}catch(c){o&&(o=!1,f(c))}})}});var H0=Z(F0=>{"use strict";var ei=F0;ei.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Or=new Array(64),V0=new Array(123);for(oe=0;oe<64;)V0[Or[oe]=oe<26?oe+65:oe<52?oe+71:oe<62?oe-4:oe-59|43]=oe++;var oe;ei.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,f;r<n;){var c=e[r++];switch(a){case 0:o[s++]=Or[c>>2],f=(c&3)<<4,a=1;break;case 1:o[s++]=Or[f|c>>4],f=(c&15)<<2,a=2;break;case 2:o[s++]=Or[f|c>>6],o[s++]=Or[c&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=Or[f],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var q0="invalid encoding";ei.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var f=e.charCodeAt(a++);if(f===61&&o>1)break;if((f=V0[f])===void 0)throw Error(q0);switch(o){case 0:s=f,o=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,o=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,o=3;break;case 3:r[n++]=(s&3)<<6|f,o=0;break}}if(o===1)throw Error(q0);return n-i};ei.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var G0=Z((dg,z0)=>{"use strict";z0.exports=ri;function ri(){this._listeners={}}ri.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};ri.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};ri.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var J0=Z((pg,X0)=>{"use strict";X0.exports=W0(W0);function W0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function o(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function a(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|c)>>>0,o,s)}}t.writeFloatLE=e.bind(null,$0),t.writeFloatBE=e.bind(null,Y0);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:a*(1/0):f===0?a*1401298464324817e-60*c:a*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,Z0),t.readFloatBE=r.bind(null,Q0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function o(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function a(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,a,f+i),n(1/s>0?0:2147483648,a,f+o);else if(isNaN(s))n(0,a,f+i),n(2146959360,a,f+o);else if(s>17976931348623157e292)n(0,a,f+i),n((c<<31|2146435072)>>>0,a,f+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,f+i),n((c<<31|u/4294967296)>>>0,a,f+o);else{var l=Math.floor(Math.log(s)/Math.LN2);l===1024&&(l=1023),u=s*Math.pow(2,-l),n(u*4503599627370496>>>0,a,f+i),n((c<<31|l+1023<<20|u*1048576&1048575)>>>0,a,f+o)}}}t.writeDoubleLE=e.bind(null,$0,0,4),t.writeDoubleBE=e.bind(null,Y0,4,0);function r(n,i,o,s,a){var f=n(s,a+i),c=n(s,a+o),u=(c>>31)*2+1,l=c>>>20&2047,h=4294967296*(c&1048575)+f;return l===2047?h?NaN:u*(1/0):l===0?u*5e-324*h:u*Math.pow(2,l-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,Z0,0,4),t.readDoubleBE=r.bind(null,Q0,4,0)}(),t}function $0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Y0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Z0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Q0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var j0=Z((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var ef=Z(tf=>{"use strict";var Co=tf;Co.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Co.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,f;r<n;)f=e[r++],f<128?s[a++]=f:f>191&&f<224?s[a++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(f>>10),s[a++]=56320+(f&1023)):s[a++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Co.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var nf=Z((gg,rf)=>{"use strict";rf.exports=Lp;function Lp(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(o=t(n),s=0);var c=e.call(o,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var sf=Z((xg,of)=>{"use strict";of.exports=Kt;var an=yr();function Kt(t,e){this.lo=t>>>0,this.hi=e>>>0}var pr=Kt.zero=new Kt(0,0);pr.toNumber=function(){return 0};pr.zzEncode=pr.zzDecode=function(){return this};pr.length=function(){return 1};var Rp=Kt.zeroHash="\0\0\0\0\0\0\0\0";Kt.fromNumber=function(e){if(e===0)return pr;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Kt(n,i)};Kt.from=function(e){if(typeof e=="number")return Kt.fromNumber(e);if(an.isString(e))if(an.Long)e=an.Long.fromString(e);else return Kt.fromNumber(parseInt(e,10));return e.low||e.high?new Kt(e.low>>>0,e.high>>>0):pr};Kt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Kt.prototype.toLong=function(e){return an.Long?new an.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Je=String.prototype.charCodeAt;Kt.fromHash=function(e){return e===Rp?pr:new Kt((Je.call(e,0)|Je.call(e,1)<<8|Je.call(e,2)<<16|Je.call(e,3)<<24)>>>0,(Je.call(e,4)|Je.call(e,5)<<8|Je.call(e,6)<<16|Je.call(e,7)<<24)>>>0)};Kt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Kt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Kt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Kt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var yr=Z(Io=>{"use strict";var M=Io;M.asPromise=M0();M.base64=H0();M.EventEmitter=G0();M.float=J0();M.inquire=j0();M.utf8=ef();M.pool=nf();M.LongBits=sf();M.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);M.global=M.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Io;M.emptyArray=Object.freeze?Object.freeze([]):[];M.emptyObject=Object.freeze?Object.freeze({}):{};M.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};M.isString=function(e){return typeof e=="string"||e instanceof String};M.isObject=function(e){return e&&typeof e=="object"};M.isset=M.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};M.Buffer=function(){try{var t=M.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();M._Buffer_from=null;M._Buffer_allocUnsafe=null;M.newBuffer=function(e){return typeof e=="number"?M.Buffer?M._Buffer_allocUnsafe(e):new M.Array(e):M.Buffer?M._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};M.Array=typeof Uint8Array<"u"?Uint8Array:Array;M.Long=M.global.dcodeIO&&M.global.dcodeIO.Long||M.global.Long||M.inquire("long");M.key2Re=/^true|false|0|1$/;M.key32Re=/^-?(?:0|[1-9][0-9]*)$/;M.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;M.longToHash=function(e){return e?M.LongBits.from(e).toHash():M.LongBits.zeroHash};M.longFromHash=function(e,r){var n=M.LongBits.fromHash(e);return M.Long?M.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function af(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}M.merge=af;M.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ff(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&af(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}M.newError=ff;M.ProtocolError=ff("ProtocolError");M.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};M.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};M.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};M._configure=function(){var t=M.Buffer;if(!t){M._Buffer_from=M._Buffer_allocUnsafe=null;return}M._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},M._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Lo=Z((vg,df)=>{"use strict";df.exports=Bt;var se=yr(),_o,lf=se.LongBits,Dp=se.utf8;function ae(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Bt(t){this.buf=t,this.pos=0,this.len=t.length}var cf=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Bt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Bt(e);throw Error("illegal buffer")},hf=function(){return se.Buffer?function(r){return(Bt.create=function(i){return se.Buffer.isBuffer(i)?new _o(i):cf(i)})(r)}:cf};Bt.create=hf();Bt.prototype._slice=se.Array.prototype.subarray||se.Array.prototype.slice;Bt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ae(this,10);return e}}();Bt.prototype.int32=function(){return this.uint32()|0};Bt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function To(){var t=new lf(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ae(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw ae(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Bt.prototype.bool=function(){return this.uint32()!==0};function ni(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Bt.prototype.fixed32=function(){if(this.pos+4>this.len)throw ae(this,4);return ni(this.buf,this.pos+=4)};Bt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ae(this,4);return ni(this.buf,this.pos+=4)|0};function uf(){if(this.pos+8>this.len)throw ae(this,8);return new lf(ni(this.buf,this.pos+=4),ni(this.buf,this.pos+=4))}Bt.prototype.float=function(){if(this.pos+4>this.len)throw ae(this,4);var e=se.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Bt.prototype.double=function(){if(this.pos+8>this.len)throw ae(this,4);var e=se.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Bt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ae(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var i=se.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};Bt.prototype.string=function(){var e=this.bytes();return Dp.read(e,0,e.length)};Bt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ae(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ae(this);while(this.buf[this.pos++]&128);return this};Bt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Bt._configure=function(t){_o=t,Bt.create=hf(),_o._configure();var e=se.Long?"toLong":"toNumber";se.merge(Bt.prototype,{int64:function(){return To.call(this)[e](!1)},uint64:function(){return To.call(this)[e](!0)},sint64:function(){return To.call(this).zzDecode()[e](!1)},fixed64:function(){return uf.call(this)[e](!0)},sfixed64:function(){return uf.call(this)[e](!1)}})}});var xf=Z((bg,gf)=>{"use strict";gf.exports=gr;var yf=Lo();(gr.prototype=Object.create(yf.prototype)).constructor=gr;var pf=yr();function gr(t){yf.call(this,t)}gr._configure=function(){pf.Buffer&&(gr.prototype._slice=pf.Buffer.prototype.slice)};gr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};gr._configure()});var Ko=Z((wg,wf)=>{"use strict";wf.exports=nt;var Jt=yr(),Ro,ii=Jt.LongBits,mf=Jt.base64,vf=Jt.utf8;function fn(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function No(){}function Np(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function nt(){this.len=0,this.head=new fn(No,0,0),this.tail=this.head,this.states=null}var bf=function(){return Jt.Buffer?function(){return(nt.create=function(){return new Ro})()}:function(){return new nt}};nt.create=bf();nt.alloc=function(e){return new Jt.Array(e)};Jt.Array!==Array&&(nt.alloc=Jt.pool(nt.alloc,Jt.Array.prototype.subarray));nt.prototype._push=function(e,r,n){return this.tail=this.tail.next=new fn(e,r,n),this.len+=r,this};function ko(t,e,r){e[r]=t&255}function kp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Po(t,e){this.len=t,this.next=void 0,this.val=e}Po.prototype=Object.create(fn.prototype);Po.prototype.fn=kp;nt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Po((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};nt.prototype.int32=function(e){return e<0?this._push(Uo,10,ii.fromNumber(e)):this.uint32(e)};nt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Uo(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}nt.prototype.uint64=function(e){var r=ii.from(e);return this._push(Uo,r.length(),r)};nt.prototype.int64=nt.prototype.uint64;nt.prototype.sint64=function(e){var r=ii.from(e).zzEncode();return this._push(Uo,r.length(),r)};nt.prototype.bool=function(e){return this._push(ko,1,e?1:0)};function Do(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}nt.prototype.fixed32=function(e){return this._push(Do,4,e>>>0)};nt.prototype.sfixed32=nt.prototype.fixed32;nt.prototype.fixed64=function(e){var r=ii.from(e);return this._push(Do,4,r.lo)._push(Do,4,r.hi)};nt.prototype.sfixed64=nt.prototype.fixed64;nt.prototype.float=function(e){return this._push(Jt.float.writeFloatLE,4,e)};nt.prototype.double=function(e){return this._push(Jt.float.writeDoubleLE,8,e)};var Pp=Jt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};nt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(ko,1,0);if(Jt.isString(e)){var n=nt.alloc(r=mf.length(e));mf.decode(e,n,0),e=n}return this.uint32(r)._push(Pp,r,e)};nt.prototype.string=function(e){var r=vf.length(e);return r?this.uint32(r)._push(vf.write,r,e):this._push(ko,1,0)};nt.prototype.fork=function(){return this.states=new Np(this),this.head=this.tail=new fn(No,0,0),this.len=0,this};nt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new fn(No,0,0),this.len=0),this};nt.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};nt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};nt._configure=function(t){Ro=t,nt.create=bf(),Ro._configure()}});var Sf=Z((Eg,Bf)=>{"use strict";Bf.exports=xe;var Ef=Ko();(xe.prototype=Object.create(Ef.prototype)).constructor=xe;var je=yr();function xe(){Ef.call(this)}xe._configure=function(){xe.alloc=je._Buffer_allocUnsafe,xe.writeBytesBuffer=je.Buffer&&je.Buffer.prototype instanceof Uint8Array&&je.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};xe.prototype.bytes=function(e){je.isString(e)&&(e=je._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(xe.writeBytesBuffer,r,e),this};function Up(t,e,r){t.length<40?je.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}xe.prototype.string=function(e){var r=je.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Up,r,e),this};xe._configure()});var Uf=Z((Ex,Pf)=>{var yt=ct();ir();At();var un=Pf.exports=yt.sha512=yt.sha512||{};yt.md.sha512=yt.md.algorithms.sha512=un;var Nf=yt.sha384=yt.sha512.sha384=yt.sha512.sha384||{};Nf.create=function(){return un.create("SHA-384")};yt.md.sha384=yt.md.algorithms.sha384=Nf;yt.sha512.sha256=yt.sha512.sha256||{create:function(){return un.create("SHA-512/256")}};yt.md["sha512/256"]=yt.md.algorithms["sha512/256"]=yt.sha512.sha256;yt.sha512.sha224=yt.sha512.sha224||{create:function(){return un.create("SHA-512/224")}};yt.md["sha512/224"]=yt.md.algorithms["sha512/224"]=yt.sha512.sha224;un.create=function(t){if(kf||Wp(),typeof t>"u"&&(t="SHA-512"),!(t in mr))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=mr[t],r=null,n=yt.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,c=0;c<f;++c)a.fullMessageLength.push(0);n=yt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return a},a.start(),a.update=function(f,c){c==="utf8"&&(f=yt.util.encodeUtf8(f));var u=f.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=u[1],u[1]=u[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),Df(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=yt.util.createBuffer();f.putBytes(n.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=c&a.blockLength-1;f.putBytes(Go.substr(0,a.blockLength-u));for(var l,h,y=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)l=a.fullMessageLength[d+1]*8,h=l/4294967296>>>0,y+=h,f.putInt32(y>>>0),y=l>>>0;f.putInt32(y);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);Df(p,i,f);var g=yt.util.createBuffer(),m;t==="SHA-512"?m=p.length:t==="SHA-384"?m=p.length-2:m=p.length-4;for(var d=0;d<m;++d)g.putInt32(p[d][0]),(d!==m-1||t!=="SHA-512/224")&&g.putInt32(p[d][1]);return g},a};var Go=null,kf=!1,Wo=null,mr=null;function Wp(){Go=String.fromCharCode(128),Go+=yt.util.fillString(String.fromCharCode(0),128),Wo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],mr={},mr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],mr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],mr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],mr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],kf=!0}function Df(t,e,r){for(var n,i,o,s,a,f,c,u,l,h,y,d,p,g,m,w,b,L,E,B,R,D,z,H,V,J,ft,Ot,I,k,_,N,A,K,O,F=r.length();F>=128;){for(I=0;I<16;++I)e[I][0]=r.getInt32()>>>0,e[I][1]=r.getInt32()>>>0;for(;I<80;++I)N=e[I-2],k=N[0],_=N[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,K=e[I-15],k=K[0],_=K[1],o=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,s=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[I-7],O=e[I-16],_=i+A[1]+s+O[1],e[I][0]=n+A[0]+o+O[0]+(_/4294967296>>>0)>>>0,e[I][1]=_>>>0;for(p=t[0][0],g=t[0][1],m=t[1][0],w=t[1][1],b=t[2][0],L=t[2][1],E=t[3][0],B=t[3][1],R=t[4][0],D=t[4][1],z=t[5][0],H=t[5][1],V=t[6][0],J=t[6][1],ft=t[7][0],Ot=t[7][1],I=0;I<80;++I)c=((R>>>14|D<<18)^(R>>>18|D<<14)^(D>>>9|R<<23))>>>0,u=((R<<18|D>>>14)^(R<<14|D>>>18)^(D<<23|R>>>9))>>>0,l=(V^R&(z^V))>>>0,h=(J^D&(H^J))>>>0,a=((p>>>28|g<<4)^(g>>>2|p<<30)^(g>>>7|p<<25))>>>0,f=((p<<4|g>>>28)^(g<<30|p>>>2)^(g<<25|p>>>7))>>>0,y=(p&m|b&(p^m))>>>0,d=(g&w|L&(g^w))>>>0,_=Ot+u+h+Wo[I][1]+e[I][1],n=ft+c+l+Wo[I][0]+e[I][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+d,o=a+y+(_/4294967296>>>0)>>>0,s=_>>>0,ft=V,Ot=J,V=z,J=H,z=R,H=D,_=B+i,R=E+n+(_/4294967296>>>0)>>>0,D=_>>>0,E=b,B=L,b=m,L=w,m=p,w=g,_=i+s,p=n+o+(_/4294967296>>>0)>>>0,g=_>>>0;_=t[0][1]+g,t[0][0]=t[0][0]+p+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+w,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+L,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+B,t[3][0]=t[3][0]+E+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+D,t[4][0]=t[4][0]+R+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+H,t[5][0]=t[5][0]+z+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+J,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+Ot,t[7][0]=t[7][0]+ft+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,F-=128}}});var X1={};Rt(X1,{PeerRecord:()=>gi,RecordEnvelope:()=>hi});var Cm=Dt(Xr(),1),Im=Dt($a(),1);var Q=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var m1=Dt(ct(),1);function fr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var zi={};Rt(zi,{base10:()=>Ah});function bh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,f=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,g=0,m=0,w=d.length;m!==w&&d[m]===0;)m++,p++;for(var b=(w-m)*u+1>>>0,L=new Uint8Array(b);m!==w;){for(var E=d[m],B=0,R=b-1;(E!==0||B<g)&&R!==-1;R--,B++)E+=256*L[R]>>>0,L[R]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=B,m++}for(var D=b-g;D!==b&&L[D]===0;)D++;for(var z=f.repeat(p);D<b;++D)z+=t.charAt(L[D]);return z}function h(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var g=0,m=0;d[p]===f;)g++,p++;for(var w=(d.length-p)*c+1>>>0,b=new Uint8Array(w);d[p];){var L=r[d.charCodeAt(p)];if(L===255)return;for(var E=0,B=w-1;(L!==0||E<m)&&B!==-1;B--,E++)L+=a*b[B]>>>0,b[B]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");m=E,p++}if(d[p]!==" "){for(var R=w-m;R!==w&&b[R]===0;)R++;for(var D=new Uint8Array(g+(w-R)),z=g;R!==w;)D[z++]=b[R++];return D}}}function y(d){var p=h(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:h,decode:y}}var wh=bh,Eh=wh,Ya=Eh;var Iy=new Uint8Array(0);var Za=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Ce=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Qa=t=>new TextEncoder().encode(t),Xa=t=>new TextDecoder().decode(t);var qi=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Vi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ja(this,e)}},Fi=class{constructor(e){this.decoders=e}or(e){return ja(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},ja=(t,e)=>new Fi({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Hi=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new qi(e,r,n),this.decoder=new Vi(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ir=({name:t,prefix:e,encode:r,decode:n})=>new Hi(t,e,r,n),Ge=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Ya(r,e);return Ir({prefix:t,name:e,encode:n,decode:o=>Ce(i(o))})},Bh=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,f=0,c=0;for(let u=0;u<o;++u){let l=i[t[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|l,a+=r,a>=8&&(a-=8,s[c++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return s},Sh=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},wt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ir({prefix:e,name:t,encode(i){return Sh(i,n,r)},decode(i){return Bh(i,n,r,t)}});var Ah=Ge({prefix:"9",name:"base10",alphabet:"0123456789"});var Gi={};Rt(Gi,{base16:()=>Ch,base16upper:()=>Ih});var Ch=wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ih=wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Wi={};Rt(Wi,{base2:()=>Th});var Th=wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $i={};Rt($i,{base256emoji:()=>Nh});var t0=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),_h=t0.reduce((t,e,r)=>(t[r]=e,t),[]),Lh=t0.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Rh(t){return t.reduce((e,r)=>(e+=_h[r],e),"")}function Dh(t){let e=[];for(let r of t){let n=Lh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Nh=Ir({prefix:"\u{1F680}",name:"base256emoji",encode:Rh,decode:Dh});var Yi={};Rt(Yi,{base32:()=>Ie,base32hex:()=>Kh,base32hexpad:()=>Mh,base32hexpadupper:()=>qh,base32hexupper:()=>Oh,base32pad:()=>Ph,base32padupper:()=>Uh,base32upper:()=>kh,base32z:()=>Vh});var Ie=wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kh=wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ph=wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Uh=wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Kh=wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Oh=wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mh=wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qh=wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Vh=wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zi={};Rt(Zi,{base36:()=>Fh,base36upper:()=>Hh});var Fh=Ge({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hh=Ge({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Qi={};Rt(Qi,{base58btc:()=>It,base58flickr:()=>zh});var It=Ge({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zh=Ge({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xi={};Rt(Xi,{base64:()=>On,base64pad:()=>Gh,base64url:()=>Wh,base64urlpad:()=>$h});var On=wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Gh=wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Wh=wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$h=wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ji={};Rt(Ji,{base8:()=>Yh});var Yh=wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ji={};Rt(ji,{identity:()=>Zh});var Zh=Ir({prefix:"\0",name:"identity",encode:t=>Xa(t),decode:t=>Qa(t)});var Fy=new TextEncoder,Hy=new TextDecoder;var eo={};Rt(eo,{identity:()=>We});var Jh=n0,e0=128,jh=127,td=~jh,ed=Math.pow(2,31);function n0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=ed;)e[r++]=t&255|e0,t/=128;for(;t&td;)e[r++]=t&255|e0,t>>>=7;return e[r]=t|0,n0.bytes=r-n+1,e}var rd=to,nd=128,r0=127;function to(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw to.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&r0)<<i:(s&r0)*Math.pow(2,i),i+=7}while(s>=nd);return to.bytes=o-n,r}var id=Math.pow(2,7),od=Math.pow(2,14),sd=Math.pow(2,21),ad=Math.pow(2,28),fd=Math.pow(2,35),cd=Math.pow(2,42),ud=Math.pow(2,49),ld=Math.pow(2,56),hd=Math.pow(2,63),dd=function(t){return t<id?1:t<od?2:t<sd?3:t<ad?4:t<fd?5:t<cd?6:t<ud?7:t<ld?8:t<hd?9:10},pd={encode:Jh,decode:rd,encodingLength:dd},yd=pd,tn=yd;var en=(t,e=0)=>[tn.decode(t,e),tn.decode.bytes],Tr=(t,e,r=0)=>(tn.encode(t,e,r),e),_r=t=>tn.encodingLength(t);var ye=(t,e)=>{let r=e.byteLength,n=_r(t),i=n+_r(r),o=new Uint8Array(i+r);return Tr(t,o,0),Tr(r,o,n),o.set(e,i),new Lr(t,r,e,o)},cr=t=>{let e=Ce(t),[r,n]=en(e),[i,o]=en(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Lr(r,i,s,e)},i0=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Za(t.bytes,r.bytes)}},Lr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var o0=0,gd="identity",s0=Ce,xd=t=>ye(o0,s0(t)),We={code:o0,name:gd,encode:s0,digest:xd};var io={};Rt(io,{sha256:()=>Vt,sha512:()=>md});var no=({name:t,code:e,encode:r})=>new ro(t,e,r),ro=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ye(this.code,r):r.then(n=>ye(this.code,n))}else throw Error("Unknown type, must be binary type")}};var f0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Vt=no({name:"sha2-256",code:18,encode:f0("SHA-256")}),md=no({name:"sha2-512",code:19,encode:f0("SHA-512")});var c0=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return bd(r,oo(t),e||It.encoder);default:return wd(r,oo(t),e||Ie.encoder)}};var u0=new WeakMap,oo=t=>{let e=u0.get(t);if(e==null){let r=new Map;return u0.set(t,r),r}return e},re=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==rn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ed)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ye(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&i0(e.multihash,n.multihash)}toString(e){return c0(this,e)}toJSON(){return{"/":c0(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||l0(n,i,o.bytes))}else if(r[Bd]===!0){let{version:n,multihash:i,code:o}=r,s=cr(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==rn)throw new Error(`Version 0 CID must use dag-pb (code: ${rn}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=l0(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,rn,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Ce(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new Lr(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[l,h]=en(e.subarray(r));return r+=h,l},i=n(),o=rn;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:o,multihashCode:a,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=vd(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return oo(o).set(n,e),o}},vd=(t,e)=>{switch(t[0]){case"Q":{let r=e||It;return[It.prefix,r.decode(`${It.prefix}${t}`)]}case It.prefix:{let r=e||It;return[It.prefix,r.decode(t)]}case Ie.prefix:{let r=e||Ie;return[Ie.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},bd=(t,e,r)=>{let{prefix:n}=r;if(n!==It.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},wd=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},rn=112,Ed=18,l0=(t,e,r)=>{let n=_r(t),i=n+_r(e),o=new Uint8Array(i+r.byteLength);return Tr(t,o,0),Tr(e,o,n),o.set(r,i),o},Bd=Symbol.for("@ipld/js-cid/CID");var $e={...ji,...Wi,...Ji,...zi,...Gi,...Yi,...Zi,...Qi,...Xi,...$i},o2={...io,...eo};function Te(t=0){return globalThis.Buffer?.alloc!=null?fr(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function _e(t=0){return globalThis.Buffer?.allocUnsafe!=null?fr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function d0(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var h0=d0("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),so=d0("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=_e(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Sd={utf8:h0,"utf-8":h0,hex:$e.base16,latin1:so,ascii:so,binary:so,...$e},qn=Sd;function Ut(t,e="utf8"){let r=qn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var zo={};Rt(zo,{Ed25519PrivateKey:()=>xr,Ed25519PublicKey:()=>cn,generateKeyPair:()=>Fp,generateKeyPairFromSeed:()=>_f,unmarshalEd25519PrivateKey:()=>qp,unmarshalEd25519PublicKey:()=>Vp});function Tt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function p0(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function ao(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function y0(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");p0(t.outputLen),p0(t.blockLen)}function Rr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function g0(t,e){ao(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Vn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var x0=t=>t instanceof Uint8Array;var Fn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ne=(t,e)=>t<<32-e|t>>>e,Ad=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ad)throw new Error("Non little-endian hardware is not supported");function fo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function nn(t){if(typeof t=="string"&&(t=fo(t)),!x0(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Hn(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!x0(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var Dr=class{clone(){return this._cloneInto()}},v2={}.toString;function zn(t){let e=n=>t().update(nn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Nr(t=32){if(Vn&&typeof Vn.getRandomValues=="function")return Vn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Cd(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,a,n)}var kr=class extends Dr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Fn(this.buffer)}update(e){Rr(this);let{view:r,buffer:n,blockLen:i}=this;e=nn(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let f=Fn(e);for(;i<=o-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Rr(this),g0(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let l=s;l<i;l++)r[l]=0;Cd(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Fn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<c;l++)a.setUint32(4*l,u[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var Gn=BigInt(4294967295),co=BigInt(32);function m0(t,e=!1){return e?{h:Number(t&Gn),l:Number(t>>co&Gn)}:{h:Number(t>>co&Gn)|0,l:Number(t&Gn)|0}}function Id(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=m0(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var Td=(t,e)=>BigInt(t>>>0)<<co|BigInt(e>>>0),_d=(t,e,r)=>t>>>r,Ld=(t,e,r)=>t<<32-r|e>>>r,Rd=(t,e,r)=>t>>>r|e<<32-r,Dd=(t,e,r)=>t<<32-r|e>>>r,Nd=(t,e,r)=>t<<64-r|e>>>r-32,kd=(t,e,r)=>t>>>r-32|e<<64-r,Pd=(t,e)=>e,Ud=(t,e)=>t,Kd=(t,e,r)=>t<<r|e>>>32-r,Od=(t,e,r)=>e<<r|t>>>32-r,Md=(t,e,r)=>e<<r-32|t>>>64-r,qd=(t,e,r)=>t<<r-32|e>>>64-r;function Vd(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var Fd=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Hd=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,zd=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Gd=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,Wd=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),$d=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;var Yd={fromBig:m0,split:Id,toBig:Td,shrSH:_d,shrSL:Ld,rotrSH:Rd,rotrSL:Dd,rotrBH:Nd,rotrBL:kd,rotr32H:Pd,rotr32L:Ud,rotlSH:Kd,rotlSL:Od,rotlBH:Md,rotlBL:qd,add:Vd,add3L:Fd,add3H:Hd,add4L:zd,add4H:Gd,add5H:$d,add5L:Wd},$=Yd;var[Zd,Qd]=(()=>$.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),Ye=new Uint32Array(80),Ze=new Uint32Array(80),uo=class extends kr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:f,Eh:c,El:u,Fh:l,Fl:h,Gh:y,Gl:d,Hh:p,Hl:g}=this;return[e,r,n,i,o,s,a,f,c,u,l,h,y,d,p,g]}set(e,r,n,i,o,s,a,f,c,u,l,h,y,d,p,g){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=l|0,this.Fl=h|0,this.Gh=y|0,this.Gl=d|0,this.Hh=p|0,this.Hl=g|0}process(e,r){for(let b=0;b<16;b++,r+=4)Ye[b]=e.getUint32(r),Ze[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let L=Ye[b-15]|0,E=Ze[b-15]|0,B=$.rotrSH(L,E,1)^$.rotrSH(L,E,8)^$.shrSH(L,E,7),R=$.rotrSL(L,E,1)^$.rotrSL(L,E,8)^$.shrSL(L,E,7),D=Ye[b-2]|0,z=Ze[b-2]|0,H=$.rotrSH(D,z,19)^$.rotrBH(D,z,61)^$.shrSH(D,z,6),V=$.rotrSL(D,z,19)^$.rotrBL(D,z,61)^$.shrSL(D,z,6),J=$.add4L(R,V,Ze[b-7],Ze[b-16]),ft=$.add4H(J,B,H,Ye[b-7],Ye[b-16]);Ye[b]=ft|0,Ze[b]=J|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:f,Dh:c,Dl:u,Eh:l,El:h,Fh:y,Fl:d,Gh:p,Gl:g,Hh:m,Hl:w}=this;for(let b=0;b<80;b++){let L=$.rotrSH(l,h,14)^$.rotrSH(l,h,18)^$.rotrBH(l,h,41),E=$.rotrSL(l,h,14)^$.rotrSL(l,h,18)^$.rotrBL(l,h,41),B=l&y^~l&p,R=h&d^~h&g,D=$.add5L(w,E,R,Qd[b],Ze[b]),z=$.add5H(D,m,L,B,Zd[b],Ye[b]),H=D|0,V=$.rotrSH(n,i,28)^$.rotrBH(n,i,34)^$.rotrBH(n,i,39),J=$.rotrSL(n,i,28)^$.rotrBL(n,i,34)^$.rotrBL(n,i,39),ft=n&o^n&a^o&a,Ot=i&s^i&f^s&f;m=p|0,w=g|0,p=y|0,g=d|0,y=l|0,d=h|0,{h:l,l:h}=$.add(c|0,u|0,z|0,H|0),c=a|0,u=f|0,a=o|0,f=s|0,o=n|0,s=i|0;let I=$.add3L(H,J,Ot);n=$.add3H(I,z,V,ft),i=I|0}({h:n,l:i}=$.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=$.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:f}=$.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=$.add(this.Dh|0,this.Dl|0,c|0,u|0),{h:l,l:h}=$.add(this.Eh|0,this.El|0,l|0,h|0),{h:y,l:d}=$.add(this.Fh|0,this.Fl|0,y|0,d|0),{h:p,l:g}=$.add(this.Gh|0,this.Gl|0,p|0,g|0),{h:m,l:w}=$.add(this.Hh|0,this.Hl|0,m|0,w|0),this.set(n,i,o,s,a,f,c,u,l,h,y,d,p,g,m,w)}roundClean(){Ye.fill(0),Ze.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var lo=zn(()=>new uo);var Yn={};Rt(Yn,{bitGet:()=>np,bitLen:()=>rp,bitMask:()=>on,bitSet:()=>ip,bytesToHex:()=>Le,bytesToNumberBE:()=>Re,bytesToNumberLE:()=>Qe,concatBytes:()=>De,createHmacDrbg:()=>yo,ensureBytes:()=>Et,equalBytes:()=>tp,hexToBytes:()=>lr,hexToNumber:()=>po,numberToBytesBE:()=>Xe,numberToBytesLE:()=>hr,numberToHexUnpadded:()=>w0,numberToVarBytesBE:()=>jd,utf8ToBytes:()=>ep,validateObject:()=>ge});var b0=BigInt(0),Wn=BigInt(1),Xd=BigInt(2),$n=t=>t instanceof Uint8Array,Jd=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Le(t){if(!$n(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Jd[t[r]];return e}function w0(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function po(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function lr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function Re(t){return po(Le(t))}function Qe(t){if(!$n(t))throw new Error("Uint8Array expected");return po(Le(Uint8Array.from(t).reverse()))}function Xe(t,e){return lr(t.toString(16).padStart(e*2,"0"))}function hr(t,e){return Xe(t,e).reverse()}function jd(t){return lr(w0(t))}function Et(t,e,r){let n;if(typeof e=="string")try{n=lr(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if($n(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function De(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!$n(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function tp(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function ep(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function rp(t){let e;for(e=0;t>b0;t>>=Wn,e+=1);return e}function np(t,e){return t>>BigInt(e)&Wn}var ip=(t,e,r)=>t|(r?Wn:b0)<<BigInt(e),on=t=>(Xd<<BigInt(t-1))-Wn,ho=t=>new Uint8Array(t),v0=t=>Uint8Array.from(t);function yo(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ho(t),i=ho(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...l)=>r(i,n,...l),f=(l=ho())=>{i=a(v0([0]),l),n=a(),l.length!==0&&(i=a(v0([1]),l),n=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,h=[];for(;l<e;){n=a();let y=n.slice();h.push(y),l+=n.length}return De(...h)};return(l,h)=>{s(),f(l);let y;for(;!(y=h(c()));)f();return s(),y}}var op={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ge(t,e,r={}){let n=(i,o,s)=>{let a=op[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!a(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var _t=BigInt(0),xt=BigInt(1),dr=BigInt(2),sp=BigInt(3),go=BigInt(4),E0=BigInt(5),B0=BigInt(8),ap=BigInt(9),fp=BigInt(16);function ut(t,e){let r=t%e;return r>=_t?r:e+r}function cp(t,e,r){if(r<=_t||e<_t)throw new Error("Expected power/modulo > 0");if(r===xt)return _t;let n=xt;for(;e>_t;)e&xt&&(n=n*t%r),t=t*t%r,e>>=xt;return n}function mt(t,e,r){let n=t;for(;e-- >_t;)n*=n,n%=r;return n}function Zn(t,e){if(t===_t||e<=_t)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ut(t,e),n=e,i=_t,o=xt,s=xt,a=_t;for(;r!==_t;){let c=n/r,u=n%r,l=i-s*c,h=o-a*c;n=r,r=u,i=s,o=a,s=l,a=h}if(n!==xt)throw new Error("invert: does not exist");return ut(i,e)}function up(t){let e=(t-xt)/dr,r,n,i;for(r=t-xt,n=0;r%dr===_t;r/=dr,n++);for(i=dr;i<t&&cp(i,e,t)!==t-xt;i++);if(n===1){let s=(t+xt)/go;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let o=(r+xt)/dr;return function(a,f){if(a.pow(f,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=n,u=a.pow(a.mul(a.ONE,i),r),l=a.pow(f,o),h=a.pow(f,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let y=1;for(let p=a.sqr(h);y<c&&!a.eql(p,a.ONE);y++)p=a.sqr(p);let d=a.pow(u,xt<<BigInt(c-y-1));u=a.sqr(d),l=a.mul(l,d),h=a.mul(h,u),c=y}return l}}function lp(t){if(t%go===sp){let e=(t+xt)/go;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%B0===E0){let e=(t-E0)/B0;return function(n,i){let o=n.mul(i,dr),s=n.pow(o,e),a=n.mul(i,s),f=n.mul(n.mul(a,dr),s),c=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%fp,up(t)}var S0=(t,e)=>(ut(t,e)&xt)===xt,hp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function xo(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=hp.reduce((n,i)=>(n[i]="function",n),e);return ge(t,r)}function dp(t,e,r){if(r<_t)throw new Error("Expected power > 0");if(r===_t)return t.ONE;if(r===xt)return e;let n=t.ONE,i=e;for(;r>_t;)r&xt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=xt;return n}function pp(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function mo(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Qn(t,e,r=!1,n={}){if(t<=_t)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=mo(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=lp(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:on(i),ZERO:_t,ONE:xt,create:f=>ut(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return _t<=f&&f<t},is0:f=>f===_t,isOdd:f=>(f&xt)===xt,neg:f=>ut(-f,t),eql:(f,c)=>f===c,sqr:f=>ut(f*f,t),add:(f,c)=>ut(f+c,t),sub:(f,c)=>ut(f-c,t),mul:(f,c)=>ut(f*c,t),pow:(f,c)=>dp(a,f,c),div:(f,c)=>ut(f*Zn(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>Zn(f,t),sqrt:n.sqrt||(f=>s(a,f)),invertBatch:f=>pp(a,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?hr(f,o):Xe(f,o),fromBytes:f=>{if(f.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${f.length}`);return r?Qe(f):Re(f)}});return Object.freeze(a)}function A0(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function C0(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function vo(t){let e=C0(t);return e+Math.ceil(e/2)}function I0(t,e,r=!1){let n=t.length,i=C0(e),o=vo(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?Re(t):Qe(t),a=ut(s,e-xt)+xt;return r?hr(a,i):Xe(a,i)}var gp=BigInt(0),bo=BigInt(1);function Xn(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>gp;)o&bo&&(s=s.add(a)),a=a.double(),o>>=bo;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),f=[],c=i,u=c;for(let l=0;l<s;l++){u=c,f.push(u);for(let h=1;h<a;h++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,o,s){let{windows:a,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,l=BigInt(2**i-1),h=2**i,y=BigInt(i);for(let d=0;d<a;d++){let p=d*f,g=Number(s&l);s>>=y,g>f&&(g-=h,s+=bo);let m=p,w=p+Math.abs(g)-1,b=d%2!==0,L=g<0;g===0?u=u.add(r(b,o[m])):c=c.add(r(L,o[w]))}return{p:c,f:u}},wNAFCached(i,o,s,a){let f=i._WINDOW_SIZE||1,c=o.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&o.set(i,a(c))),this.wNAF(f,c,s)}}}function sn(t){return xo(t.Fp),ge(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...mo(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var ie=BigInt(0),Yt=BigInt(1),Jn=BigInt(2),xp=BigInt(8),mp={zip215:!0};function vp(t){let e=sn(t);return ge(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function jn(t){let e=vp(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:f}=e,c=Jn<<BigInt(a*8)-Yt,u=r.create,l=e.uvRatio||((N,A)=>{try{return{isValid:!0,value:r.sqrt(N*r.inv(A))}}catch{return{isValid:!1,value:ie}}}),h=e.adjustScalarBytes||(N=>N),y=e.domain||((N,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return N}),d=N=>typeof N=="bigint"&&ie<N,p=(N,A)=>d(N)&&d(A)&&N<A,g=N=>N===ie||p(N,c);function m(N,A){if(p(N,A))return N;throw new Error(`Expected valid scalar < ${A}, got ${typeof N} ${N}`)}function w(N){return N===ie?N:m(N,n)}let b=new Map;function L(N){if(!(N instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(A,K,O,F){if(this.ex=A,this.ey=K,this.ez=O,this.et=F,!g(A))throw new Error("x required");if(!g(K))throw new Error("y required");if(!g(O))throw new Error("z required");if(!g(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof E)throw new Error("extended point not allowed");let{x:K,y:O}=A||{};if(!g(K)||!g(O))throw new Error("invalid affine point");return new E(K,O,Yt,u(K*O))}static normalizeZ(A){let K=r.invertBatch(A.map(O=>O.ez));return A.map((O,F)=>O.toAffine(K[F])).map(E.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:F,ez:Y,et:j}=this,at=u(O*O),tt=u(F*F),it=u(Y*Y),St=u(it*it),bt=u(at*A),Mt=u(it*u(bt+tt)),qt=u(St+u(K*u(at*tt)));if(Mt!==qt)throw new Error("bad point: equation left != right (1)");let Ct=u(O*F),Ft=u(Y*j);if(Ct!==Ft)throw new Error("bad point: equation left != right (2)")}equals(A){L(A);let{ex:K,ey:O,ez:F}=this,{ex:Y,ey:j,ez:at}=A,tt=u(K*at),it=u(Y*F),St=u(O*at),bt=u(j*F);return tt===it&&St===bt}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:K,ey:O,ez:F}=this,Y=u(K*K),j=u(O*O),at=u(Jn*u(F*F)),tt=u(A*Y),it=K+O,St=u(u(it*it)-Y-j),bt=tt+j,Mt=bt-at,qt=tt-j,Ct=u(St*Mt),Ft=u(bt*qt),Ee=u(St*qt),rr=u(Mt*bt);return new E(Ct,Ft,rr,Ee)}add(A){L(A);let{a:K,d:O}=e,{ex:F,ey:Y,ez:j,et:at}=this,{ex:tt,ey:it,ez:St,et:bt}=A;if(K===BigInt(-1)){let Ss=u((Y-F)*(it+tt)),As=u((Y+F)*(it-tt)),xi=u(As-Ss);if(xi===ie)return this.double();let Cs=u(j*Jn*bt),Is=u(at*Jn*St),Ts=Is+Cs,_s=As+Ss,Ls=Is-Cs,qc=u(Ts*xi),Vc=u(_s*Ls),Fc=u(Ts*Ls),Hc=u(xi*_s);return new E(qc,Vc,Hc,Fc)}let Mt=u(F*tt),qt=u(Y*it),Ct=u(at*O*bt),Ft=u(j*St),Ee=u((F+Y)*(tt+it)-Mt-qt),rr=Ft-Ct,$r=Ft+Ct,Bs=u(qt-K*Mt),Uc=u(Ee*rr),Kc=u($r*Bs),Oc=u(Ee*Bs),Mc=u(rr*$r);return new E(Uc,Kc,Mc,Oc)}subtract(A){return this.add(A.negate())}wNAF(A){return D.wNAFCached(this,b,A,E.normalizeZ)}multiply(A){let{p:K,f:O}=this.wNAF(m(A,n));return E.normalizeZ([K,O])[0]}multiplyUnsafe(A){let K=w(A);return K===ie?R:this.equals(R)||K===Yt?this:this.equals(B)?this.wNAF(K).p:D.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return D.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:O,ez:F}=this,Y=this.is0();A==null&&(A=Y?xp:r.inv(F));let j=u(K*A),at=u(O*A),tt=u(F*A);if(Y)return{x:ie,y:Yt};if(tt!==Yt)throw new Error("invZ was invalid");return{x:j,y:at}}clearCofactor(){let{h:A}=e;return A===Yt?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:O,a:F}=e,Y=r.BYTES;A=Et("pointHex",A,Y);let j=A.slice(),at=A[Y-1];j[Y-1]=at&-129;let tt=Qe(j);tt===ie||(K?m(tt,c):m(tt,r.ORDER));let it=u(tt*tt),St=u(it-Yt),bt=u(O*it-F),{isValid:Mt,value:qt}=l(St,bt);if(!Mt)throw new Error("Point.fromHex: invalid y coordinate");let Ct=(qt&Yt)===Yt,Ft=(at&128)!==0;if(!K&&qt===ie&&Ft)throw new Error("Point.fromHex: x=0 and x_0=1");return Ft!==Ct&&(qt=u(-qt)),E.fromAffine({x:qt,y:tt})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),O=hr(K,r.BYTES);return O[O.length-1]|=A&Yt?128:0,O}toHex(){return Le(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,Yt,u(e.Gx*e.Gy)),E.ZERO=new E(ie,Yt,Yt,ie);let{BASE:B,ZERO:R}=E,D=Xn(E,a*8);function z(N){return ut(N,n)}function H(N){return z(Qe(N))}function V(N){let A=a;N=Et("private key",N,A);let K=Et("hashed private key",o(N),2*A),O=h(K.slice(0,A)),F=K.slice(A,2*A),Y=H(O),j=B.multiply(Y),at=j.toRawBytes();return{head:O,prefix:F,scalar:Y,point:j,pointBytes:at}}function J(N){return V(N).pointBytes}function ft(N=new Uint8Array,...A){let K=De(...A);return H(o(y(K,Et("context",N),!!i)))}function Ot(N,A,K={}){N=Et("message",N),i&&(N=i(N));let{prefix:O,scalar:F,pointBytes:Y}=V(A),j=ft(K.context,O,N),at=B.multiply(j).toRawBytes(),tt=ft(K.context,at,Y,N),it=z(j+tt*F);w(it);let St=De(at,hr(it,r.BYTES));return Et("result",St,a*2)}let I=mp;function k(N,A,K,O=I){let{context:F,zip215:Y}=O,j=r.BYTES;N=Et("signature",N,2*j),A=Et("message",A),i&&(A=i(A));let at=Qe(N.slice(j,2*j)),tt,it,St;try{tt=E.fromHex(K,Y),it=E.fromHex(N.slice(0,j),Y),St=B.multiplyUnsafe(at)}catch{return!1}if(!Y&&tt.isSmallOrder())return!1;let bt=ft(F,it.toRawBytes(),tt.toRawBytes(),A);return it.add(tt.multiplyUnsafe(bt)).subtract(St).clearCofactor().equals(E.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:J,sign:Ot,verify:k,ExtendedPoint:E,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(N=8,A=E.BASE){return A._setWindowSize(N),A.multiply(BigInt(3)),A}}}}var Eo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),T0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),V2=BigInt(0),bp=BigInt(1),wo=BigInt(2),wp=BigInt(5),_0=BigInt(10),Ep=BigInt(20),Bp=BigInt(40),L0=BigInt(80);function Sp(t){let e=Eo,n=t*t%e*t%e,i=mt(n,wo,e)*n%e,o=mt(i,bp,e)*t%e,s=mt(o,wp,e)*o%e,a=mt(s,_0,e)*s%e,f=mt(a,Ep,e)*a%e,c=mt(f,Bp,e)*f%e,u=mt(c,L0,e)*c%e,l=mt(u,L0,e)*c%e,h=mt(l,_0,e)*s%e;return{pow_p_5_8:mt(h,wo,e)*t%e,b2:n}}function Ap(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Cp(t,e){let r=Eo,n=ut(e*e*e,r),i=ut(n*n*e,r),o=Sp(t*i).pow_p_5_8,s=ut(t*n*o,r),a=ut(e*s*s,r),f=s,c=ut(s*T0,r),u=a===t,l=a===ut(-t,r),h=a===ut(-t*T0,r);return u&&(s=f),(l||h)&&(s=c),S0(s,r)&&(s=ut(-s,r)),{isValid:u||l,value:s}}var Ne=Qn(Eo,void 0,!0),Bo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ne,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:lo,randomBytes:Nr,adjustScalarBytes:Ap,uvRatio:Cp},Pr=jn(Bo);function R0(t,e,r){if(e.length>255)throw new Error("Context is too big");return Hn(fo("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var F2=jn({...Bo,domain:R0}),H2=jn({...Bo,domain:R0,prehash:lo});var Ip=(Ne.ORDER+BigInt(3))/BigInt(8),z2=Ne.pow(wo,Ip),G2=Ne.sqrt(Ne.neg(Ne.ONE)),W2=(Ne.ORDER-BigInt(5))/BigInt(8),$2=BigInt(486662);var Y2=A0(Ne,Ne.neg(BigInt(486664)));var Z2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Q2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),X2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),J2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var j2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Ur=32,ke=64,ti=32;async function D0(){let t=Pr.utils.randomPrivateKey(),e=Pr.getPublicKey(t);return{privateKey:U0(t,e),publicKey:e}}async function N0(t){if(t.length!==ti)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Pr.getPublicKey(e);return{privateKey:U0(e,r),publicKey:r}}async function k0(t,e){let r=t.subarray(0,ti);return Pr.sign(e,r)}async function P0(t,e,r){return Pr.verify(e,r,t)}function U0(t,e){let r=new Uint8Array(ke);for(let n=0;n<ti;n++)r[n]=t[n],r[ti+n]=e[n];return r}function Lt(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=_e(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return fr(r)}var $t={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var So={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Ao(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=$t.get();r*=8;async function f(l,h){let y=a.getRandomValues(new Uint8Array(o)),d=a.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof h=="string"&&(h=Ut(h));let g;if(h.length===0){g=await a.subtle.importKey("jwk",So,{name:"AES-GCM"},!0,["encrypt"]);try{let w={name:"PBKDF2",salt:y,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(w,b,{name:e,length:r},!0,["encrypt"])}catch{g=await a.subtle.importKey("jwk",So,{name:"AES-GCM"},!0,["encrypt"])}}else{let w={name:"PBKDF2",salt:y,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(w,b,{name:e,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(p,g,l);return Lt([y,p.iv,new Uint8Array(m)])}async function c(l,h){let y=l.subarray(0,o),d=l.subarray(o,o+n),p=l.subarray(o+n),g={name:e,iv:d};typeof h=="string"&&(h=Ut(h));let m;if(h.length===0)try{let b={name:"PBKDF2",salt:y,iterations:s,hash:{name:i}},L=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,L,{name:e,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",So,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:y,iterations:s,hash:{name:i}},L=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,L,{name:e,length:r},!0,["decrypt"])}let w=await a.subtle.decrypt(g,m,p);return new Uint8Array(w)}return{encrypt:f,decrypt:c}}async function Kr(t,e){let n=await Ao().encrypt(t,e);return On.encode(n)}var Oo=Dt(Lo(),1),Af=Dt(xf(),1),Cf=Dt(yr(),1),Mo=Dt(Ko(),1),If=Dt(Sf(),1);function Kp(){Cf.default._configure(),Oo.default._configure(Af.default),Mo.default._configure(If.default)}Kp();var Tf=["uint64","int64","sint64","fixed64","sfixed64"];function Op(t){for(let e of Tf){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function qo(t){return Op(new Oo.default(t))}function Mp(t){for(let e of Tf){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Vo(){return Mp(Mo.default.create())}function Pe(t,e){let r=qo(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Ue(t,e){let r=Vo();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Mr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Mr||(Mr={}));function oi(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Fo(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return oi("enum",Mr.VARINT,r,n)}function Ke(t,e){return oi("message",Mr.LENGTH_DELIMITED,t,e)}var vt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(vt||(vt={}));var Ho;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ho||(Ho={}));(function(t){t.codec=()=>Fo(Ho)})(vt||(vt={}));var me;(function(t){let e;t.codec=()=>(e==null&&(e=Ke((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),vt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=vt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Ue(r,t.codec()),t.decode=r=>Pe(r,t.codec())})(me||(me={}));var ve;(function(t){let e;t.codec=()=>(e==null&&(e=Ke((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),vt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=vt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Ue(r,t.codec()),t.decode=r=>Pe(r,t.codec())})(ve||(ve={}));var cn=class{_key;constructor(e){this._key=qr(e,Ur)}async verify(e,r){return P0(this._key,r,e)}marshal(){return this._key}get bytes(){return me.encode({Type:vt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Tt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},xr=class{_key;_publicKey;constructor(e,r){this._key=qr(e,ke),this._publicKey=qr(r,Ur)}async sign(e){return k0(this._key,e)}get public(){return new cn(this._publicKey)}marshal(){return this._key}get bytes(){return ve.encode({Type:vt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Tt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=We.digest(this.public.bytes);return It.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Kr(this.bytes,e);throw new Q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function qp(t){if(t.length>ke){t=qr(t,ke+Ur);let n=t.subarray(0,ke),i=t.subarray(ke,t.length);return new xr(n,i)}t=qr(t,ke);let e=t.subarray(0,ke),r=t.subarray(Ur);return new xr(e,r)}function Vp(t){return t=qr(t,Ur),new cn(t)}async function Fp(){let{privateKey:t,publicKey:e}=await D0();return new xr(t,e)}async function _f(t){let{privateKey:e,publicKey:r}=await N0(t);return new xr(e,r)}function qr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new Q(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function lt(t,e="utf8"){let r=qn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Yg=Dt(At(),1),Zg=Dt(kn(),1),Lf=Dt(ct(),1);function fe(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Lt([new Uint8Array(e-r.length),r])}return lt(r,"base64url")}function Zt(t){let e=Rf(t);return new Lf.default.jsbn.BigInteger(lt(e,"base16"),16)}function Rf(t,e){let r=Ut(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Lt([new Uint8Array(e-r.length),r])}return r}var Hp={"P-256":256,"P-384":384,"P-521":521},zp=Object.keys(Hp),sx=zp.join(" / ");var Zo={};Rt(Zo,{MAX_KEY_SIZE:()=>dn,RsaPrivateKey:()=>Vr,RsaPublicKey:()=>hn,fromJwk:()=>e1,generateKeyPair:()=>r1,unmarshalRsaPrivateKey:()=>jp,unmarshalRsaPublicKey:()=>t1});var ln=Dt(ct(),1);var zx=Dt(Uf(),1);function ai(t){if(isNaN(t)||t<=0)throw new Q("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Nr(t)}var Cx=Dt(Kn(),1),$o=Dt(ct(),1);function Kf(t,e){return e.map(r=>Zt(t[r]))}function Of(t){return $o.default.pki.setRsaPrivateKey(...Kf(t,["n","e","d","p","q","dp","dq","qi"]))}function Mf(t){return $o.default.pki.setRsaPublicKey(...Kf(t,["n","e"]))}var vr={};Rt(vr,{jwkToPkcs1:()=>Yp,jwkToPkix:()=>Qp,pkcs1ToJwk:()=>$p,pkixToJwk:()=>Zp});var _x=Dt(Xr(),1),Lx=Dt(Kn(),1);var Oe=Dt(ct(),1);function $p(t){let e=Oe.default.asn1.fromDer(lt(t,"ascii")),r=Oe.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:fe(r.n),e:fe(r.e),d:fe(r.d),p:fe(r.p),q:fe(r.q),dp:fe(r.dP),dq:fe(r.dQ),qi:fe(r.qInv),alg:"RS256"}}function Yp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new Q("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Oe.default.pki.privateKeyToAsn1({n:Zt(t.n),e:Zt(t.e),d:Zt(t.d),p:Zt(t.p),q:Zt(t.q),dP:Zt(t.dp),dQ:Zt(t.dq),qInv:Zt(t.qi)});return Ut(Oe.default.asn1.toDer(e).getBytes(),"ascii")}function Zp(t){let e=Oe.default.asn1.fromDer(lt(t,"ascii")),r=Oe.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:fe(r.n),e:fe(r.e)}}function Qp(t){if(t.n==null||t.e==null)throw new Q("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Oe.default.pki.publicKeyToAsn1({n:Zt(t.n),e:Zt(t.e)});return Ut(Oe.default.asn1.toDer(e).getBytes(),"ascii")}async function qf(t){let e=await $t.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Hf(e);return{privateKey:r[0],publicKey:r[1]}}async function Yo(t){let r=[await $t.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Xp(t)],n=await Hf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Vf(t,e){let r=await $t.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await $t.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Ff(t,e,r){let n=await $t.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return $t.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Hf(t){if(t.privateKey==null||t.publicKey==null)throw new Q("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([$t.get().subtle.exportKey("jwk",t.privateKey),$t.get().subtle.exportKey("jwk",t.publicKey)])}async function Xp(t){return $t.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function zf(t,e,r,n){let i=e?Mf(t):Of(t),o=lt(Uint8Array.from(r),"ascii"),s=n(o,i);return Ut(s,"ascii")}function Gf(t,e){return zf(t,!0,e,(r,n)=>n.encrypt(r))}function Wf(t,e){return zf(t,!1,e,(r,n)=>n.decrypt(r))}function fi(t){if(t.kty!=="RSA")throw new Q("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new Q("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Ut(t.n,"base64url").length*8}var dn=8192,hn=class{_key;constructor(e){this._key=e}async verify(e,r){return Ff(this._key,r,e)}marshal(){return vr.jwkToPkix(this._key)}get bytes(){return me.encode({Type:vt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Gf(this._key,e)}equals(e){return Tt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},Vr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return ai(16)}async sign(e){return Vf(this._key,e)}get public(){if(this._publicKey==null)throw new Q("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new hn(this._publicKey)}decrypt(e){return Wf(this._key,e)}marshal(){return vr.jwkToPkcs1(this._key)}get bytes(){return ve.encode({Type:vt.RSA,Data:this.marshal()}).subarray()}equals(e){return Tt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return lt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new ln.default.util.ByteBuffer(this.marshal()),i=ln.default.asn1.fromDer(n),o=ln.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return ln.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return Kr(this.bytes,e);throw new Q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function jp(t){let e=vr.pkcs1ToJwk(t);if(fi(e)>dn)throw new Q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Yo(e);return new Vr(r.privateKey,r.publicKey)}function t1(t){let e=vr.pkixToJwk(t);if(fi(e)>dn)throw new Q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new hn(e)}async function e1(t){if(fi(t)>dn)throw new Q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Yo(t);return new Vr(e.privateKey,e.publicKey)}async function r1(t){if(t>dn)throw new Q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await qf(t);return new Vr(e.privateKey,e.publicKey)}var es={};Rt(es,{Secp256k1PrivateKey:()=>yn,Secp256k1PublicKey:()=>pn,generateKeyPair:()=>x1,unmarshalSecp256k1PrivateKey:()=>y1,unmarshalSecp256k1PublicKey:()=>g1});var n1=(t,e,r)=>t&e^~t&r,i1=(t,e,r)=>t&e^t&r^e&r,o1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=new Uint32Array(64),Qo=class extends kr{constructor(){super(64,32,8,!1),this.A=tr[0]|0,this.B=tr[1]|0,this.C=tr[2]|0,this.D=tr[3]|0,this.E=tr[4]|0,this.F=tr[5]|0,this.G=tr[6]|0,this.H=tr[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:f}=this;return[e,r,n,i,o,s,a,f]}set(e,r,n,i,o,s,a,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=f|0}process(e,r){for(let l=0;l<16;l++,r+=4)er[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){let h=er[l-15],y=er[l-2],d=ne(h,7)^ne(h,18)^h>>>3,p=ne(y,17)^ne(y,19)^y>>>10;er[l]=p+er[l-7]+d+er[l-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:f,G:c,H:u}=this;for(let l=0;l<64;l++){let h=ne(a,6)^ne(a,11)^ne(a,25),y=u+h+n1(a,f,c)+o1[l]+er[l]|0,p=(ne(n,2)^ne(n,13)^ne(n,22))+i1(n,i,o)|0;u=c,c=f,f=a,a=s+y|0,s=o,o=i,i=n,n=y+p|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,f,c,u)}roundClean(){er.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var $f=zn(()=>new Qo);function s1(t){let e=sn(t);ge(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:a1,hexToBytes:f1}=Yn,br={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=br;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:a1(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=br,r=typeof t=="string"?f1(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=br._parseInt(r.subarray(2)),{d:s,l:a}=br._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),f=r(s);return`30${r(s+o+4)}02${f}${i}02${a}${n}`}},Me=BigInt(0),jt=BigInt(1),jx=BigInt(2),Yf=BigInt(3),tm=BigInt(4);function c1(t){let e=s1(t),{Fp:r}=e,n=e.toBytes||((d,p,g)=>{let m=p.toAffine();return De(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),g=r.fromBytes(p.subarray(0,r.BYTES)),m=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:g,y:m}});function o(d){let{a:p,b:g}=e,m=r.sqr(d),w=r.mul(m,d);return r.add(r.add(w,r.mul(d,p)),g)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(d){return typeof d=="bigint"&&Me<d&&d<e.n}function a(d){if(!s(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(d){let{allowedPrivateKeyLengths:p,nByteLength:g,wrapPrivateKey:m,n:w}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=Le(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(g*2,"0")}let b;try{b=typeof d=="bigint"?d:Re(Et("private key",d,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof d}`)}return m&&(b=ut(b,w)),a(b),b}let c=new Map;function u(d){if(!(d instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(p,g,m){if(this.px=p,this.py=g,this.pz=m,p==null||!r.isValid(p))throw new Error("x required");if(g==null||!r.isValid(g))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(p){let{x:g,y:m}=p||{};if(!p||!r.isValid(g)||!r.isValid(m))throw new Error("invalid affine point");if(p instanceof l)throw new Error("projective point not allowed");let w=b=>r.eql(b,r.ZERO);return w(g)&&w(m)?l.ZERO:new l(g,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let g=r.invertBatch(p.map(m=>m.pz));return p.map((m,w)=>m.toAffine(g[w])).map(l.fromAffine)}static fromHex(p){let g=l.fromAffine(i(Et("pointHex",p)));return g.assertValidity(),g}static fromPrivateKey(p){return l.BASE.multiply(f(p))}_setWindowSize(p){this._WINDOW_SIZE=p,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y:g}=this.toAffine();if(!r.isValid(p)||!r.isValid(g))throw new Error("bad point: x or y not FE");let m=r.sqr(g),w=o(p);if(!r.eql(m,w))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:g,py:m,pz:w}=this,{px:b,py:L,pz:E}=p,B=r.eql(r.mul(g,E),r.mul(b,w)),R=r.eql(r.mul(m,E),r.mul(L,w));return B&&R}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:g}=e,m=r.mul(g,Yf),{px:w,py:b,pz:L}=this,E=r.ZERO,B=r.ZERO,R=r.ZERO,D=r.mul(w,w),z=r.mul(b,b),H=r.mul(L,L),V=r.mul(w,b);return V=r.add(V,V),R=r.mul(w,L),R=r.add(R,R),E=r.mul(p,R),B=r.mul(m,H),B=r.add(E,B),E=r.sub(z,B),B=r.add(z,B),B=r.mul(E,B),E=r.mul(V,E),R=r.mul(m,R),H=r.mul(p,H),V=r.sub(D,H),V=r.mul(p,V),V=r.add(V,R),R=r.add(D,D),D=r.add(R,D),D=r.add(D,H),D=r.mul(D,V),B=r.add(B,D),H=r.mul(b,L),H=r.add(H,H),D=r.mul(H,V),E=r.sub(E,D),R=r.mul(H,z),R=r.add(R,R),R=r.add(R,R),new l(E,B,R)}add(p){u(p);let{px:g,py:m,pz:w}=this,{px:b,py:L,pz:E}=p,B=r.ZERO,R=r.ZERO,D=r.ZERO,z=e.a,H=r.mul(e.b,Yf),V=r.mul(g,b),J=r.mul(m,L),ft=r.mul(w,E),Ot=r.add(g,m),I=r.add(b,L);Ot=r.mul(Ot,I),I=r.add(V,J),Ot=r.sub(Ot,I),I=r.add(g,w);let k=r.add(b,E);return I=r.mul(I,k),k=r.add(V,ft),I=r.sub(I,k),k=r.add(m,w),B=r.add(L,E),k=r.mul(k,B),B=r.add(J,ft),k=r.sub(k,B),D=r.mul(z,I),B=r.mul(H,ft),D=r.add(B,D),B=r.sub(J,D),D=r.add(J,D),R=r.mul(B,D),J=r.add(V,V),J=r.add(J,V),ft=r.mul(z,ft),I=r.mul(H,I),J=r.add(J,ft),ft=r.sub(V,ft),ft=r.mul(z,ft),I=r.add(I,ft),V=r.mul(J,I),R=r.add(R,V),V=r.mul(k,I),B=r.mul(Ot,B),B=r.sub(B,V),V=r.mul(Ot,J),D=r.mul(k,D),D=r.add(D,V),new l(B,R,D)}subtract(p){return this.add(p.negate())}is0(){return this.equals(l.ZERO)}wNAF(p){return y.wNAFCached(this,c,p,g=>{let m=r.invertBatch(g.map(w=>w.pz));return g.map((w,b)=>w.toAffine(m[b])).map(l.fromAffine)})}multiplyUnsafe(p){let g=l.ZERO;if(p===Me)return g;if(a(p),p===jt)return this;let{endo:m}=e;if(!m)return y.unsafeLadder(this,p);let{k1neg:w,k1:b,k2neg:L,k2:E}=m.splitScalar(p),B=g,R=g,D=this;for(;b>Me||E>Me;)b&jt&&(B=B.add(D)),E&jt&&(R=R.add(D)),D=D.double(),b>>=jt,E>>=jt;return w&&(B=B.negate()),L&&(R=R.negate()),R=new l(r.mul(R.px,m.beta),R.py,R.pz),B.add(R)}multiply(p){a(p);let g=p,m,w,{endo:b}=e;if(b){let{k1neg:L,k1:E,k2neg:B,k2:R}=b.splitScalar(g),{p:D,f:z}=this.wNAF(E),{p:H,f:V}=this.wNAF(R);D=y.constTimeNegate(L,D),H=y.constTimeNegate(B,H),H=new l(r.mul(H.px,b.beta),H.py,H.pz),m=D.add(H),w=z.add(V)}else{let{p:L,f:E}=this.wNAF(g);m=L,w=E}return l.normalizeZ([m,w])[0]}multiplyAndAddUnsafe(p,g,m){let w=l.BASE,b=(E,B)=>B===Me||B===jt||!E.equals(w)?E.multiplyUnsafe(B):E.multiply(B),L=b(this,g).add(b(p,m));return L.is0()?void 0:L}toAffine(p){let{px:g,py:m,pz:w}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(w));let L=r.mul(g,p),E=r.mul(m,p),B=r.mul(w,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:L,y:E}}isTorsionFree(){let{h:p,isTorsionFree:g}=e;if(p===jt)return!0;if(g)return g(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:g}=e;return p===jt?this:g?g(l,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(l,this,p)}toHex(p=!0){return Le(this.toRawBytes(p))}}l.BASE=new l(e.Gx,e.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);let h=e.nBitLength,y=Xn(l,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:f,weierstrassEquation:o,isWithinCurveOrder:s}}function u1(t){let e=sn(t);return ge(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Zf(t){let e=u1(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(I){return Me<I&&I<r.ORDER}function a(I){return ut(I,n)}function f(I){return Zn(I,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=c1({...e,toBytes(I,k,_){let N=k.toAffine(),A=r.toBytes(N.x),K=De;return _?K(Uint8Array.from([k.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(N.y))},fromBytes(I){let k=I.length,_=I[0],N=I.subarray(1);if(k===i&&(_===2||_===3)){let A=Re(N);if(!s(A))throw new Error("Point is not on curve");let K=l(A),O=r.sqrt(K),F=(O&jt)===jt;return(_&1)===1!==F&&(O=r.neg(O)),{x:A,y:O}}else if(k===o&&_===4){let A=r.fromBytes(N.subarray(0,r.BYTES)),K=r.fromBytes(N.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),y=I=>Le(Xe(I,e.nByteLength));function d(I){let k=n>>jt;return I>k}function p(I){return d(I)?a(-I):I}let g=(I,k,_)=>Re(I.slice(k,_));class m{constructor(k,_,N){this.r=k,this.s=_,this.recovery=N,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=Et("compactSignature",k,_*2),new m(g(k,0,_),g(k,_,2*_))}static fromDER(k){let{r:_,s:N}=br.toSig(Et("DER",k));return new m(_,N)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:N,recovery:A}=this,K=R(Et("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=A&1?"03":"02",Y=c.fromHex(F+y(O)),j=f(O),at=a(-K*j),tt=a(N*j),it=c.BASE.multiplyAndAddUnsafe(Y,at,tt);if(!it)throw new Error("point at infinify");return it.assertValidity(),it}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return lr(this.toDERHex())}toDERHex(){return br.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return lr(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let w={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let I=vo(e.n);return I0(e.randomBytes(I),e.n)},precompute(I=8,k=c.BASE){return k._setWindowSize(I),k.multiply(BigInt(3)),k}};function b(I,k=!0){return c.fromPrivateKey(I).toRawBytes(k)}function L(I){let k=I instanceof Uint8Array,_=typeof I=="string",N=(k||_)&&I.length;return k?N===i||N===o:_?N===2*i||N===2*o:I instanceof c}function E(I,k,_=!0){if(L(I))throw new Error("first arg must be private key");if(!L(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(I)).toRawBytes(_)}let B=e.bits2int||function(I){let k=Re(I),_=I.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},R=e.bits2int_modN||function(I){return a(B(I))},D=on(e.nBitLength);function z(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(Me<=I&&I<D))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Xe(I,e.nByteLength)}function H(I,k,_=V){if(["recovered","canonical"].some(bt=>bt in _))throw new Error("sign() legacy options not supported");let{hash:N,randomBytes:A}=e,{lowS:K,prehash:O,extraEntropy:F}=_;K==null&&(K=!0),I=Et("msgHash",I),O&&(I=Et("prehashed msgHash",N(I)));let Y=R(I),j=u(k),at=[z(j),z(Y)];if(F!=null){let bt=F===!0?A(r.BYTES):F;at.push(Et("extraEntropy",bt))}let tt=De(...at),it=Y;function St(bt){let Mt=B(bt);if(!h(Mt))return;let qt=f(Mt),Ct=c.BASE.multiply(Mt).toAffine(),Ft=a(Ct.x);if(Ft===Me)return;let Ee=a(qt*a(it+Ft*j));if(Ee===Me)return;let rr=(Ct.x===Ft?0:2)|Number(Ct.y&jt),$r=Ee;return K&&d(Ee)&&($r=p(Ee),rr^=1),new m(Ft,$r,rr)}return{seed:tt,k2sig:St}}let V={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function ft(I,k,_=V){let{seed:N,k2sig:A}=H(I,k,_),K=e;return yo(K.hash.outputLen,K.nByteLength,K.hmac)(N,A)}c.BASE._setWindowSize(8);function Ot(I,k,_,N=J){let A=I;if(k=Et("msgHash",k),_=Et("publicKey",_),"strict"in N)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:O}=N,F,Y;try{if(typeof A=="string"||A instanceof Uint8Array)try{F=m.fromDER(A)}catch(Ct){if(!(Ct instanceof br.Err))throw Ct;F=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:Ct,s:Ft}=A;F=new m(Ct,Ft)}else throw new Error("PARSE");Y=c.fromHex(_)}catch(Ct){if(Ct.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&F.hasHighS())return!1;O&&(k=e.hash(k));let{r:j,s:at}=F,tt=R(k),it=f(at),St=a(tt*it),bt=a(j*it),Mt=c.BASE.multiplyAndAddUnsafe(Y,St,bt)?.toAffine();return Mt?a(Mt.x)===j:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:E,sign:ft,verify:Ot,ProjectivePoint:c,Signature:m,utils:w}}var ci=class extends Dr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,y0(e);let n=nn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Rr(this),this.iHash.update(e),this}digestInto(e){Rr(this),ao(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Xo=(t,e,r)=>new ci(t,e).update(r).digest();Xo.create=(t,e)=>new ci(t,e);function l1(t){return{hash:t,hmac:(e,...r)=>Xo(t,e,Hn(...r)),randomBytes:Nr}}function Qf(t,e){let r=n=>Zf({...t,...l1(n)});return Object.freeze({...r(e),create:r})}var jf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Xf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h1=BigInt(1),Jo=BigInt(2),Jf=(t,e)=>(t+e/Jo)/e;function d1(t){let e=jf,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,l=mt(u,r,e)*u%e,h=mt(l,r,e)*u%e,y=mt(h,Jo,e)*c%e,d=mt(y,i,e)*y%e,p=mt(d,o,e)*d%e,g=mt(p,a,e)*p%e,m=mt(g,f,e)*g%e,w=mt(m,a,e)*p%e,b=mt(w,r,e)*u%e,L=mt(b,s,e)*d%e,E=mt(L,n,e)*c%e,B=mt(E,Jo,e);if(!jo.eql(jo.sqr(B),t))throw new Error("Cannot find square root");return B}var jo=Qn(jf,void 0,void 0,{sqrt:d1}),qe=Qf({a:BigInt(0),b:BigInt(7),Fp:jo,n:Xf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Xf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-h1*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Jf(o*t,e),f=Jf(-n*t,e),c=ut(t-a*r-f*i,e),u=ut(-a*n-f*o,e),l=c>s,h=u>s;if(l&&(c=e-c),h&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:c,k2neg:h,k2:u}}}},$f),hm=BigInt(0);var dm=qe.ProjectivePoint;function tc(){return qe.utils.randomPrivateKey()}async function ec(t,e){let{digest:r}=await Vt.digest(e);try{return qe.sign(r,t).toDERRawBytes()}catch(n){throw new Q(String(n),"ERR_INVALID_INPUT")}}async function rc(t,e,r){try{let{digest:n}=await Vt.digest(r);return qe.verify(e,n,t)}catch(n){throw new Q(String(n),"ERR_INVALID_INPUT")}}function nc(t){return qe.ProjectivePoint.fromHex(t).toRawBytes(!0)}function ic(t){try{qe.getPublicKey(t,!0)}catch(e){throw new Q(String(e),"ERR_INVALID_PRIVATE_KEY")}}function ts(t){try{qe.ProjectivePoint.fromHex(t)}catch(e){throw new Q(String(e),"ERR_INVALID_PUBLIC_KEY")}}function oc(t){try{return qe.getPublicKey(t,!0)}catch(e){throw new Q(String(e),"ERR_INVALID_PRIVATE_KEY")}}var pn=class{_key;constructor(e){ts(e),this._key=e}async verify(e,r){return rc(this._key,r,e)}marshal(){return nc(this._key)}get bytes(){return me.encode({Type:vt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Tt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},yn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??oc(e),ic(this._key),ts(this._publicKey)}async sign(e){return ec(this._key,e)}get public(){return new pn(this._publicKey)}marshal(){return this._key}get bytes(){return ve.encode({Type:vt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Tt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return lt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Kr(this.bytes,e);throw new Q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function y1(t){return new yn(t)}function g1(t){return new pn(t)}async function x1(){let t=tc();return new yn(t)}var wr={rsa:Zo,ed25519:zo,secp256k1:es};function sc(t){let e=Object.keys(wr).join(" / ");return new Q(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function ac(t){let e=me.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case vt.RSA:return wr.rsa.unmarshalRsaPublicKey(r);case vt.Ed25519:return wr.ed25519.unmarshalEd25519PublicKey(r);case vt.Secp256k1:return wr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw sc(e.Type??"unknown")}}async function fc(t){let e=ve.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case vt.RSA:return wr.rsa.unmarshalRsaPrivateKey(r);case vt.Ed25519:return wr.ed25519.unmarshalEd25519PrivateKey(r);case vt.Secp256k1:return wr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw sc(e.Type??"RSA")}}var cc=Symbol.for("@libp2p/peer-id");var v1=Symbol.for("nodejs.util.inspect.custom"),uc=Object.values($e).map(t=>t.decoder).reduce((t,e)=>t.or(e),$e.identity.decoder),lc=114,rs=36,ns=37,gn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[cc]=!0;toString(){return this.string==null&&(this.string=It.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return re.createV1(lc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Tt(this.multihash.bytes,e);if(typeof e=="string")return b1(e).equals(this);if(e?.multihash?.bytes!=null)return Tt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[v1](){return`PeerId(${this.toString()})`}},Fr=class extends gn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Hr=class extends gn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},zr=class extends gn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function b1(t,e){if(e=e??uc,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=cr(It.decode(`z${t}`));return t.startsWith("12D")?new Hr({multihash:r}):t.startsWith("16U")?new zr({multihash:r}):new Fr({multihash:r})}return is(uc.decode(t))}function is(t){try{let e=cr(t);if(e.code===We.code){if(e.digest.length===rs)return new Hr({multihash:e});if(e.digest.length===ns)return new zr({multihash:e})}if(e.code===Vt.code)return new Fr({multihash:e})}catch{return w1(re.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function w1(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==lc)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Vt.code)return new Fr({multihash:t.multihash});if(e.code===We.code){if(e.digest.length===rs)return new Hr({multihash:t.multihash});if(e.digest.length===ns)return new zr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function hc(t,e){return t.length===rs?new Hr({multihash:ye(We.code,t),privateKey:e}):t.length===ns?new zr({multihash:ye(We.code,t),privateKey:e}):new Fr({multihash:await Vt.digest(t),publicKey:t,privateKey:e})}var E1=Math.pow(2,7),B1=Math.pow(2,14),S1=Math.pow(2,21),os=Math.pow(2,28),ss=Math.pow(2,35),as=Math.pow(2,42),fs=Math.pow(2,49),st=128,Ht=127;function be(t){if(t<E1)return 1;if(t<B1)return 2;if(t<S1)return 3;if(t<os)return 4;if(t<ss)return 5;if(t<as)return 6;if(t<fs)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function A1(t,e,r=0){switch(be(t)){case 8:e[r++]=t&255|st,t/=128;case 7:e[r++]=t&255|st,t/=128;case 6:e[r++]=t&255|st,t/=128;case 5:e[r++]=t&255|st,t/=128;case 4:e[r++]=t&255|st,t>>>=7;case 3:e[r++]=t&255|st,t>>>=7;case 2:e[r++]=t&255|st,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function C1(t,e,r=0){switch(be(t)){case 8:e.set(r++,t&255|st),t/=128;case 7:e.set(r++,t&255|st),t/=128;case 6:e.set(r++,t&255|st),t/=128;case 5:e.set(r++,t&255|st),t/=128;case 4:e.set(r++,t&255|st),t>>>=7;case 3:e.set(r++,t&255|st),t>>>=7;case 2:e.set(r++,t&255|st),t>>>=7;case 1:{e.set(r++,t&255),t>>>=7;break}default:throw new Error("unreachable")}return e}function I1(t,e){let r=t[e],n=0;if(n+=r&Ht,r<st||(r=t[e+1],n+=(r&Ht)<<7,r<st)||(r=t[e+2],n+=(r&Ht)<<14,r<st)||(r=t[e+3],n+=(r&Ht)<<21,r<st)||(r=t[e+4],n+=(r&Ht)*os,r<st)||(r=t[e+5],n+=(r&Ht)*ss,r<st)||(r=t[e+6],n+=(r&Ht)*as,r<st)||(r=t[e+7],n+=(r&Ht)*fs,r<st))return n;throw new RangeError("Could not decode varint")}function T1(t,e){let r=t.get(e),n=0;if(n+=r&Ht,r<st||(r=t.get(e+1),n+=(r&Ht)<<7,r<st)||(r=t.get(e+2),n+=(r&Ht)<<14,r<st)||(r=t.get(e+3),n+=(r&Ht)<<21,r<st)||(r=t.get(e+4),n+=(r&Ht)*os,r<st)||(r=t.get(e+5),n+=(r&Ht)*ss,r<st)||(r=t.get(e+6),n+=(r&Ht)*as,r<st)||(r=t.get(e+7),n+=(r&Ht)*fs,r<st))return n;throw new RangeError("Could not decode varint")}function we(t,e,r=0){return e==null&&(e=_e(be(t))),e instanceof Uint8Array?A1(t,e,r):C1(t,e,r)}function Er(t,e=0){return t instanceof Uint8Array?I1(t,e):T1(t,e)}var pc=Symbol.for("@achingbrain/uint8arraylist");function dc(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function ui(t){return!!t?.[pc]}var li=class t{constructor(...e){Object.defineProperty(this,pc,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ui(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(ui(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=dc(this.bufs,e);return r.buf[r.index]}set(e,r){let n=dc(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(ui(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return Lt(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:Lt(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),o=new t;return o.length=i,o.bufs=n,o}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,f=a+s.byteLength;if(i=f,e>=f)continue;let c=e>=a&&e<f,u=r>a&&r<=f;if(c&&u){if(e===a&&r===f){n.push(s);break}let l=e-a;n.push(s.subarray(l,l+(r-e)));break}if(c){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(u){if(r===f){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!ui(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let l=0;l<o;l++)s[l]=-1;for(let l=0;l<i;l++)s[n[l]]=l;let a=s,f=this.byteLength-n.byteLength,c=n.byteLength-1,u;for(let l=r;l<=f;l+=u){u=0;for(let h=c;h>=0;h--){let y=this.get(l+h);if(n[h]!==y){u=Math.max(1,h-a[y]);break}}if(u===0)return l}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=_e(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=Te(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=Te(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=Te(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=_e(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=Te(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=Te(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=Te(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=Te(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=Te(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof t)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Tt(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new t;return n.bufs=e,r==null&&(r=e.reduce((i,o)=>i+o.byteLength,0)),n.length=r,n}};var yc={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var xn;(function(t){let e;t.codec=()=>(e==null&&(e=Ke((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.publicKey!=null&&r.publicKey.byteLength>0&&(n.uint32(10),n.bytes(r.publicKey)),r.payloadType!=null&&r.payloadType.byteLength>0&&(n.uint32(18),n.bytes(r.payloadType)),r.payload!=null&&r.payload.byteLength>0&&(n.uint32(26),n.bytes(r.payload)),r.signature!=null&&r.signature.byteLength>0&&(n.uint32(42),n.bytes(r.signature)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.publicKey=r.bytes();break;case 2:i.payloadType=r.bytes();break;case 3:i.payload=r.bytes();break;case 5:i.signature=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Ue(r,t.codec()),t.decode=r=>Pe(r,t.codec())})(xn||(xn={}));var hi=class t{static createFromProtobuf=async e=>{let r=xn.decode(e),n=await hc(r.publicKey);return new t({peerId:n,payloadType:r.payloadType,payload:r.payload,signature:r.signature})};static seal=async(e,r)=>{if(r.privateKey==null)throw new Error("Missing private key");let n=e.domain,i=e.codec,o=e.marshal(),s=gc(n,i,o),f=await(await fc(r.privateKey)).sign(s.subarray());return new t({peerId:r,payloadType:i,payload:o,signature:f})};static openAndCertify=async(e,r)=>{let n=await t.createFromProtobuf(e);if(!await n.validate(r))throw new Q("envelope signature is not valid for the given domain",yc.ERR_SIGNATURE_NOT_VALID);return n};peerId;payloadType;payload;signature;marshaled;constructor(e){let{peerId:r,payloadType:n,payload:i,signature:o}=e;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=o}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=xn.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return Tt(this.marshal(),e.marshal())}async validate(e){let r=gc(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return ac(this.peerId.publicKey).verify(r.subarray(),this.signature)}},gc=(t,e,r)=>{let n=Ut(t),i=we(n.byteLength),o=we(e.length),s=we(r.length);return new li(i,n,o,e,s,r)};function xc(t,e){let r=(n,i)=>n.toString().localeCompare(i.toString());return t.length!==e.length?!1:(e.sort(r),t.sort(r).every((n,i)=>e[i].equals(n)))}var di=class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){let r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){let r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{let r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,i){return this.readAtomically(()=>{let o=0,s=0,a=this.peekChar();if(a===void 0)return;let f=a==="0",c=2**(8*i)-1;for(;;){let u=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let h=Number.parseInt(l,e);if(!Number.isNaN(h))return h});if(u===void 0)break;if(o*=e,o+=u,o>c||(s+=1,r!==void 0&&s>r))return}if(s!==0)return!n&&f&&s>1?void 0:o})}readIPv4Addr(){return this.readAtomically(()=>{let e=new Uint8Array(4);for(let r=0;r<e.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){let e=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let s=this.readSeparator(":",n,()=>this.readIPv4Addr());if(s!==void 0)return r[i]=s[0],r[i+1]=s[1],r[i+2]=s[2],r[i+3]=s[3],[i+4,!0]}let o=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(o===void 0)return[i,!1];r[i]=o>>8,r[i+1]=o&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=e(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let o=new Uint8Array(14),s=16-(n+2),[a]=e(o.subarray(0,s));return r.set(o.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var mc=45,_1=15,Gr=new di;function us(t){if(!(t.length>_1))return Gr.new(t).parseWith(()=>Gr.readIPv4Addr())}function ls(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>mc))return Gr.new(t).parseWith(()=>Gr.readIPv6Addr())}function pi(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>mc))return Gr.new(t).parseWith(()=>Gr.readIPAddr())}var xv=parseInt("0xFFFF",16),mv=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function wc(t){return!!us(t)}function Ec(t){return!!ls(t)}function yi(t){return!!pi(t)}var Bc=wc,k1=Ec,hs=function(t){let e=0;if(t=t.toString().trim(),Bc(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(k1(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let o=Bc(r[n]),s;o&&(s=hs(r[n]),r[n]=lt(s.slice(0,2),"base16")),s!=null&&++n<8&&r.splice(n,0,lt(s.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let o=[n,1];for(n=9-r.length;n>0;n--)o.push("0");r.splice.apply(r,o)}let i=new Uint8Array(e+16);for(n=0;n<r.length;n++){let o=parseInt(r[n],16);i[e++]=o>>8&255,i[e++]=o&255}return i}throw new Error("invalid ip address")},Sc=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let i=[];for(let o=0;o<r;o++)i.push(t[e+o]);return i.join(".")}if(r===16){let i=[];for(let o=0;o<r;o+=2)i.push(n.getUint16(e+o).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Wr={},ds={},U1=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];U1.forEach(t=>{let e=K1(...t);ds[e.code]=e,Wr[e.name]=e});function K1(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:!!n,path:!!i}}function dt(t){if(typeof t=="number"){if(ds[t]!=null)return ds[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(Wr[t]!=null)return Wr[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var eb=dt("ip4"),rb=dt("ip6"),nb=dt("ipcidr");function ys(t,e){switch(dt(t).code){case 4:case 41:return M1(e);case 42:return Ic(e);case 6:case 273:case 33:case 132:return _c(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Ic(e);case 421:return H1(e);case 444:return Tc(e);case 445:return Tc(e);case 466:return F1(e);default:return lt(e,"base16")}}function gs(t,e){switch(dt(t).code){case 4:return Ac(e);case 41:return Ac(e);case 42:return Cc(e);case 6:case 273:case 33:case 132:return xs(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Cc(e);case 421:return q1(e);case 444:return z1(e);case 445:return G1(e);case 466:return V1(e);default:return Ut(e,"base16")}}var ps=Object.values($e).map(t=>t.decoder),O1=function(){let t=ps[0].or(ps[1]);return ps.slice(2).forEach(e=>t=t.or(e)),t}();function Ac(t){if(!yi(t))throw new Error("invalid ip address");return hs(t)}function M1(t){let e=Sc(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!yi(e))throw new Error("invalid ip address");return e}function xs(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function _c(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Cc(t){let e=Ut(t),r=Uint8Array.from(we(e.length));return Lt([r,e],r.length+e.length)}function Ic(t){let e=Er(t);if(t=t.slice(be(e)),t.length!==e)throw new Error("inconsistent lengths");return lt(t)}function q1(t){let e;t[0]==="Q"||t[0]==="1"?e=cr(It.decode(`z${t}`)).bytes:e=re.parse(t).multihash.bytes;let r=Uint8Array.from(we(e.length));return Lt([r,e],r.length+e.length)}function V1(t){let e=O1.decode(t),r=Uint8Array.from(we(e.length));return Lt([r,e],r.length+e.length)}function F1(t){let e=Er(t),r=t.slice(be(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+lt(r,"base64url")}function H1(t){let e=Er(t),r=t.slice(be(e));if(r.length!==e)throw new Error("inconsistent lengths");return lt(r,"base58btc")}function z1(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=Ie.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=xs(n);return Lt([r,i],r.length+i.length)}function G1(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=Ie.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=xs(n);return Lt([r,i],r.length+i.length)}function Tc(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=lt(e,"base32"),i=_c(r);return`${n}:${i}`}function Lc(t){t=ms(t);let e=[],r=[],n=null,i=t.split("/").slice(1);if(i.length===1&&i[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let o=0;o<i.length;o++){let s=i[o],a=dt(s);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(o++,o>=i.length)throw Dc("invalid address: "+t);if(a.path===!0){n=ms(i.slice(o).join("/")),e.push([a.code,gs(a.code,n)]),r.push([a.code,n]);break}let f=gs(a.code,i[o]);e.push([a.code,f]),r.push([a.code,ys(a.code,f)])}return{string:Rc(r),bytes:bs(e),tuples:e,stringTuples:r,path:n}}function vs(t){let e=[],r=[],n=null,i=0;for(;i<t.length;){let o=Er(t,i),s=be(o),a=dt(o),f=W1(a,t.slice(i+s));if(f===0){e.push([o]),r.push([o]),i+=s;continue}let c=t.slice(i+s,i+s+f);if(i+=f+s,i>t.length)throw Dc("Invalid address Uint8Array: "+lt(t,"base16"));e.push([o,c]);let u=ys(o,c);if(r.push([o,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(t),string:Rc(r),tuples:e,stringTuples:r,path:n}}function Rc(t){let e=[];return t.map(r=>{let n=dt(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),ms(e.join("/"))}function bs(t){return Lt(t.map(e=>{let r=dt(e[0]),n=Uint8Array.from(we(r.code));return e.length>1&&e[1]!=null&&(n=Lt([n,e[1]])),n}))}function W1(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=Er(e instanceof Uint8Array?e:Uint8Array.from(e));return r+be(r)}}function ms(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function Dc(t){return new Error("Error parsing address: "+t)}var $1=Symbol.for("nodejs.util.inspect.custom"),Y1=[dt("dns").code,dt("dns4").code,dt("dns6").code,dt("dnsaddr").code],Z1=new Map,Nc=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Q1(t){return!!t?.[Nc]}var Es=class t{bytes;#e;#t;#r;#n;[Nc]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=vs(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=Lc(e)}else if(Q1(e))r=vs(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,i,o="",s=dt("tcp"),a=dt("udp"),f=dt("ip4"),c=dt("ip6"),u=dt("dns6"),l=dt("ip6zone");for(let[y,d]of this.stringTuples())y===l.code&&(o=`%${d??""}`),Y1.includes(y)&&(r=s.name,i=443,n=`${d??""}${o}`,e=y===u.code?6:4),(y===s.code||y===a.code)&&(r=dt(y).name,i=parseInt(d??"")),(y===f.code||y===c.code)&&(r=dt(y).name,n=`${d??""}${o}`,e=y===c.code?6:4);if(e==null||r==null||n==null||i==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:i}}protos(){return this.#t.map(([e])=>Object.assign({},dt(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>dt(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new t(e),new t(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new t(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new t(bs(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,i])=>{n===Wr.p2p.code&&e.push([n,i]),n===Wr["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?lt(It.decode(`z${n}`),"base58btc"):lt(re.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return Tt(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(o=>o.resolvable);if(r==null)return[this];let n=Z1.get(r.name);if(n==null)throw new Q(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(o=>new t(o))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[$1](){return`Multiaddr(${this.#e})`}};function ws(t){return new Es(t)}var kc="libp2p-peer-record",Pc=Uint8Array.from([3,1]);var mn;(function(t){let e;(function(n){let i;n.codec=()=>(i==null&&(i=Ke((o,s,a={})=>{a.lengthDelimited!==!1&&s.fork(),o.multiaddr!=null&&o.multiaddr.byteLength>0&&(s.uint32(10),s.bytes(o.multiaddr)),a.lengthDelimited!==!1&&s.ldelim()},(o,s)=>{let a={multiaddr:new Uint8Array(0)},f=s==null?o.len:o.pos+s;for(;o.pos<f;){let c=o.uint32();switch(c>>>3){case 1:a.multiaddr=o.bytes();break;default:o.skipType(c&7);break}}return a})),i),n.encode=o=>Ue(o,n.codec()),n.decode=o=>Pe(o,n.codec())})(e=t.AddressInfo||(t.AddressInfo={}));let r;t.codec=()=>(r==null&&(r=Ke((n,i,o={})=>{if(o.lengthDelimited!==!1&&i.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(i.uint32(10),i.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(i.uint32(16),i.uint64(n.seq)),n.addresses!=null)for(let s of n.addresses)i.uint32(26),t.AddressInfo.codec().encode(s,i);o.lengthDelimited!==!1&&i.ldelim()},(n,i)=>{let o={peerId:new Uint8Array(0),seq:0n,addresses:[]},s=i==null?n.len:n.pos+i;for(;n.pos<s;){let a=n.uint32();switch(a>>>3){case 1:o.peerId=n.bytes();break;case 2:o.seq=n.uint64();break;case 3:o.addresses.push(t.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return o})),r),t.encode=n=>Ue(n,t.codec()),t.decode=n=>Pe(n,t.codec())})(mn||(mn={}));var gi=class t{static createFromProtobuf=e=>{let r=mn.decode(e),n=is(r.peerId),i=(r.addresses??[]).map(s=>ws(s.multiaddr)),o=r.seq;return new t({peerId:n,multiaddrs:i,seqNumber:o})};static DOMAIN=kc;static CODEC=Pc;peerId;multiaddrs;seqNumber;domain=t.DOMAIN;codec=t.CODEC;marshaled;constructor(e){let{peerId:r,multiaddrs:n,seqNumber:i}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=mn.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof t)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!xc(this.multiaddrs,e.multiaddrs))}};return Zc(X1);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
