(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PKeychain = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PKeychain=(()=>{var Wc=Object.create;var An=Object.defineProperty;var $c=Object.getOwnPropertyDescriptor;var Zc=Object.getOwnPropertyNames;var Qc=Object.getPrototypeOf,Xc=Object.prototype.hasOwnProperty;var z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Rt=(t,e)=>{for(var r in e)An(t,r,{get:e[r],enumerable:!0})},Aa=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Zc(e))!Xc.call(t,i)&&i!==r&&An(t,i,{get:()=>e[i],enumerable:!(n=$c(e,i))||n.enumerable});return t};var pt=(t,e,r)=>(r=t!=null?Wc(Qc(t)):{},Aa(e||!t||!t.__esModule?An(r,"default",{value:t,enumerable:!0}):r,t)),Jc=t=>Aa(An({},"__esModule",{value:!0}),t);var ft=z((p1,Ca)=>{Ca.exports={options:{usePureJavaScript:!1}}});var Ta=z((y1,Ia)=>{var Ii={};Ia.exports=Ii;var _a={};Ii.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=jc(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<a.length;++f)c+=a[f]<<8,a[f]=c%o,c=c/o|0;for(;c>0;)a.push(c%o),c=c/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Ii.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=_a[e];if(!r){r=_a[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,c=a;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function jc(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=o.length-1;r>=0;--r)f+=e[o[r]];return f}});var Bt=z((g1,Da)=>{var Ra=ft(),La=Ta(),x=Da.exports=Ra.util=Ra.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(a){return setImmediate(a)};return}if(x.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];x.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var o=x.setImmediate;x.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),o(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?globalThis:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};x.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};x.isArrayBufferView=function(t){return t&&x.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Jr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}x.ByteBuffer=Ti;function Ti(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(x.isArrayBuffer(t)||x.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ti||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}x.ByteStringBuffer=Ti;var tu=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>tu&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};x.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};x.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};x.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(x.encodeUtf8(t))};x.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};x.ByteStringBuffer.prototype.putInt=function(t,e){Jr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};x.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};x.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};x.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};x.ByteStringBuffer.prototype.getInt=function(t){Jr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};x.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};x.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var t=x.createBuffer(this.data);return t.read=this.read,t};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function eu(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=x.isArrayBuffer(t),n=x.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}x.DataBuffer=eu;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};x.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};x.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};x.DataBuffer.prototype.putBytes=function(t,e){if(x.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(x.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof x.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&x.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof x.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=x.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};x.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};x.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};x.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(t,e){Jr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};x.DataBuffer.prototype.putSignedInt=function(t,e){return Jr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};x.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};x.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};x.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};x.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};x.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};x.DataBuffer.prototype.getInt=function(t){Jr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};x.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};x.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return x.binary.raw.encode(e);if(t==="hex")return x.binary.hex.encode(e);if(t==="base64")return x.binary.base64.encode(e);if(t==="utf8")return x.text.utf8.decode(e);if(t==="utf16")return x.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};x.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=x.encodeUtf8(t)),new x.ByteBuffer(t)};x.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};x.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};x.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};x.bytesToHex=function(t){return x.createBuffer(t).toHex()};x.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ke=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Na="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=Pe.charAt(i>>2),r+=Pe.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Pe.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Pe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=Ke[t.charCodeAt(s++)-43],n=Ke[t.charCodeAt(s++)-43],i=Ke[t.charCodeAt(s++)-43],o=Ke[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};x.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};x.decodeUtf8=function(t){return decodeURIComponent(escape(t))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:La.encode,decode:La.decode}};x.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};x.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};x.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=Pe.charAt(i>>2),r+=Pe.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Pe.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Pe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,f=0,c=r;f<t.length;)i=Ke[t.charCodeAt(f++)-43],o=Ke[t.charCodeAt(f++)-43],s=Ke[t.charCodeAt(f++)-43],a=Ke[t.charCodeAt(f++)-43],n[c++]=i<<2|o>>4,s!==64&&(n[c++]=(o&15)<<4|s>>2,a!==64&&(n[c++]=(s&3)<<6|a));return e?c-r:n.subarray(0,c)};x.binary.base58.encode=function(t,e){return x.binary.baseN.encode(t,Na,e)};x.binary.base58.decode=function(t,e){return x.binary.baseN.decode(t,Na,e)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(t,e,r){t=x.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};x.text.utf8.decode=function(t){return x.decodeUtf8(String.fromCharCode.apply(null,t))};x.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};x.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};x.deflate=function(t,e,r){if(e=x.decode64(t.deflate(x.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};x.inflate=function(t,e,r){var n=t.inflate(x.encode64(e)).rval;return n===null?null:x.decode64(n)};var Ri=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=x.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Li=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(x.decode64(r))),r},ru=function(t,e,r,n){var i=Li(t,e);i===null&&(i={}),i[r]=n,Ri(t,e,i)},nu=function(t,e,r){var n=Li(t,e);return n!==null&&(n=r in n?n[r]:null),n},iu=function(t,e,r){var n=Li(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),Ri(t,e,n)}},ou=function(t,e){Ri(t,e,null)},Cn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(f){s=f}if(o)break}if(!o)throw s;return n};x.setItem=function(t,e,r,n,i){Cn(ru,arguments,i)};x.getItem=function(t,e,r,n){return Cn(nu,arguments,n)};x.removeItem=function(t,e,r,n){Cn(iu,arguments,n)};x.clearItems=function(t,e,r){Cn(ou,arguments,r)};x.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};x.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};x.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+a:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-c).toFixed(o).slice(2):"")};x.formatSize=function(t){return t>=1073741824?t=x.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=x.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=x.formatNumber(t/1024,0)+" KiB":t=x.formatNumber(t,0)+" bytes",t};x.bytesFromIP=function(t){return t.indexOf(".")!==-1?x.bytesFromIPv4(t):t.indexOf(":")!==-1?x.bytesFromIPv6(t):null};x.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=x.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};x.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=x.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=x.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};x.bytesToIP=function(t){return t.length===4?x.bytesToIPv4(t):t.length===16?x.bytesToIPv6(t):null};x.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};x.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=x.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};x.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in x&&!t.update)return e(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,e(null,x.cores);if(typeof Worker>"u")return x.cores=1,e(null,x.cores);if(typeof Blob>"u")return x.cores=2,e(null,x.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,f){if(a===0){var c=Math.floor(s.reduce(function(u,l){return u+l},0)/s.length);return x.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,x.cores)}i(f,function(u,l){s.push(o(f,l)),n(s,a-1,f)})}function i(s,a){for(var f=[],c=[],u=0;u<s;++u){var l=new Worker(r);l.addEventListener("message",function(h){if(c.push(h.data),c.length===s){for(var g=0;g<s;++g)f[g].terminate();a(null,c)}}),f.push(l)}for(var u=0;u<s;++u)f[u].postMessage(u)}function o(s,a){for(var f=[],c=0;c<s;++c)for(var u=a[c],l=f[c]=[],h=0;h<s;++h)if(c!==h){var g=a[h];(u.st>g.st&&u.st<g.et||g.st>u.st&&g.st<u.et)&&l.push(h)}return f.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var Di=z((x1,ka)=>{var Lt=ft();Bt();ka.exports=Lt.cipher=Lt.cipher||{};Lt.cipher.algorithms=Lt.cipher.algorithms||{};Lt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Lt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Lt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Lt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Lt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Lt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Lt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Lt.cipher.algorithms[t]=e};Lt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Lt.cipher.algorithms?Lt.cipher.algorithms[t]:null};var Ni=Lt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Ni.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Lt.util.createBuffer(),this.output=t.output||Lt.util.createBuffer(),this.mode.start(e)};Ni.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Ni.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Pi=z((m1,Pa)=>{var Nt=ft();Bt();Nt.cipher=Nt.cipher||{};var X=Pa.exports=Nt.cipher.modes=Nt.cipher.modes||{};X.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.ecb.prototype.start=function(t){};X.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=_n(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};X.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};X.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};X.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0};X.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=_n(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0};X.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=_n(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb.prototype.decrypt=X.ofb.prototype.encrypt;X.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0};X.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=_n(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}In(this._inBlock)};X.ctr.prototype.decrypt=X.ctr.prototype.encrypt;X.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};X.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Nt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Nt.util.createBuffer(t.additionalData):r=Nt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Nt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ki(n*8)))}this._inBlock=this._j0.slice(0),In(this._inBlock),this._partialBytes=0,r=Nt.util.createBuffer(r),this._aDataLength=ki(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};X.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),In(this._inBlock)};X.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),In(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};X.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Nt.util.createBuffer();var n=this._aDataLength.concat(ki(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};X.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};X.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};X.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};X.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};X.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;a[f]=1<<e-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};X.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],f=i[s];i[o+s]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var c=i[o^n];i[o]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function _n(t,e){if(typeof t=="string"&&(t=Nt.util.createBuffer(t)),Nt.util.isArray(t)&&t.length>4){var r=t;t=Nt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Nt.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function In(t){t[t.length-1]=t[t.length-1]+1&4294967295}function ki(t){return[t/4294967296|0,t&4294967295]}});var Rn=z((v1,Ma)=>{var dt=ft();Di();Pi();Bt();Ma.exports=dt.aes=dt.aes||{};dt.aes.startEncrypting=function(t,e,r,n){var i=Tn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};dt.aes.createEncryptionCipher=function(t,e){return Tn({key:t,output:null,decrypt:!1,mode:e})};dt.aes.startDecrypting=function(t,e,r,n){var i=Tn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};dt.aes.createDecryptionCipher=function(t,e){return Tn({key:t,output:null,decrypt:!0,mode:e})};dt.aes.Algorithm=function(t,e){Oi||Ua();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Ui(r._w,n,i,!1)},decrypt:function(n,i){return Ui(r._w,n,i,!0)}}}),r._init=!1};dt.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=dt.util.createBuffer(e);else if(dt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=dt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!dt.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!dt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=Oa(e,t.decrypt&&!s),this._init=!0}};dt.aes._expandKey=function(t,e){return Oi||Ua(),Oa(t,e)};dt.aes._updateBlock=Ui;Er("AES-ECB",dt.cipher.modes.ecb);Er("AES-CBC",dt.cipher.modes.cbc);Er("AES-CFB",dt.cipher.modes.cfb);Er("AES-OFB",dt.cipher.modes.ofb);Er("AES-CTR",dt.cipher.modes.ctr);Er("AES-GCM",dt.cipher.modes.gcm);function Er(t,e){var r=function(){return new dt.aes.Algorithm(t,e)};dt.cipher.registerAlgorithm(t,r)}var Oi=!1,br=4,Vt,Ki,Ka,Je,te;function Ua(){Oi=!0,Ka=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Vt=new Array(256),Ki=new Array(256),Je=new Array(4),te=new Array(4);for(var e=0;e<4;++e)Je[e]=new Array(256),te[e]=new Array(256);for(var r=0,n=0,i,o,s,a,f,c,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Vt[r]=a,Ki[a]=r,f=t[a],i=t[r],o=t[i],s=t[o],c=f<<24^a<<16^a<<8^(a^f),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var l=0;l<4;++l)Je[l][r]=c,te[l][a]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function Oa(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=br*s,f=o;f<a;++f)n=r[f-1],f%o===0?(n=Vt[n>>>16&255]<<24^Vt[n>>>8&255]<<16^Vt[n&255]<<8^Vt[n>>>24]^Ka[i]<<24,i++):o>6&&f%o===4&&(n=Vt[n>>>24]<<24^Vt[n>>>16&255]<<16^Vt[n>>>8&255]<<8^Vt[n&255]),r[f]=r[f-o]^n;if(e){var c,u=te[0],l=te[1],h=te[2],g=te[3],d=r.slice(0);a=r.length;for(var f=0,p=a-br;f<a;f+=br,p-=br)if(f===0||f===a-br)d[f]=r[p],d[f+1]=r[p+3],d[f+2]=r[p+2],d[f+3]=r[p+1];else for(var y=0;y<br;++y)c=r[p+y],d[f+(3&-y)]=u[Vt[c>>>24]]^l[Vt[c>>>16&255]]^h[Vt[c>>>8&255]]^g[Vt[c&255]];r=d}return r}function Ui(t,e,r,n){var i=t.length/4-1,o,s,a,f,c;n?(o=te[0],s=te[1],a=te[2],f=te[3],c=Ki):(o=Je[0],s=Je[1],a=Je[2],f=Je[3],c=Vt);var u,l,h,g,d,p,y;u=e[0]^t[0],l=e[n?3:1]^t[1],h=e[2]^t[2],g=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)d=o[u>>>24]^s[l>>>16&255]^a[h>>>8&255]^f[g&255]^t[++m],p=o[l>>>24]^s[h>>>16&255]^a[g>>>8&255]^f[u&255]^t[++m],y=o[h>>>24]^s[g>>>16&255]^a[u>>>8&255]^f[l&255]^t[++m],g=o[g>>>24]^s[u>>>16&255]^a[l>>>8&255]^f[h&255]^t[++m],u=d,l=p,h=y;r[0]=c[u>>>24]<<24^c[l>>>16&255]<<16^c[h>>>8&255]<<8^c[g&255]^t[++m],r[n?3:1]=c[l>>>24]<<24^c[h>>>16&255]<<16^c[g>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[h>>>24]<<24^c[g>>>16&255]<<16^c[u>>>8&255]<<8^c[l&255]^t[++m],r[n?1:3]=c[g>>>24]<<24^c[u>>>16&255]<<16^c[l>>>8&255]<<8^c[h&255]^t[++m]}function Tn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=dt.cipher.createDecipher(r,t.key):n=dt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof dt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var kn=z((B2,ss)=>{var nn=ft();nn.pki=nn.pki||{};var ao=ss.exports=nn.pki.oids=nn.oids=nn.oids||{};function I(t,e){ao[t]=e,ao[e]=t}function at(t,e){ao[t]=e}I("1.2.840.113549.1.1.1","rsaEncryption");I("1.2.840.113549.1.1.4","md5WithRSAEncryption");I("1.2.840.113549.1.1.5","sha1WithRSAEncryption");I("1.2.840.113549.1.1.7","RSAES-OAEP");I("1.2.840.113549.1.1.8","mgf1");I("1.2.840.113549.1.1.9","pSpecified");I("1.2.840.113549.1.1.10","RSASSA-PSS");I("1.2.840.113549.1.1.11","sha256WithRSAEncryption");I("1.2.840.113549.1.1.12","sha384WithRSAEncryption");I("1.2.840.113549.1.1.13","sha512WithRSAEncryption");I("1.3.101.112","EdDSA25519");I("1.2.840.10040.4.3","dsa-with-sha1");I("1.3.14.3.2.7","desCBC");I("1.3.14.3.2.26","sha1");I("1.3.14.3.2.29","sha1WithRSASignature");I("2.16.840.1.101.3.4.2.1","sha256");I("2.16.840.1.101.3.4.2.2","sha384");I("2.16.840.1.101.3.4.2.3","sha512");I("2.16.840.1.101.3.4.2.4","sha224");I("2.16.840.1.101.3.4.2.5","sha512-224");I("2.16.840.1.101.3.4.2.6","sha512-256");I("1.2.840.113549.2.2","md2");I("1.2.840.113549.2.5","md5");I("1.2.840.113549.1.7.1","data");I("1.2.840.113549.1.7.2","signedData");I("1.2.840.113549.1.7.3","envelopedData");I("1.2.840.113549.1.7.4","signedAndEnvelopedData");I("1.2.840.113549.1.7.5","digestedData");I("1.2.840.113549.1.7.6","encryptedData");I("1.2.840.113549.1.9.1","emailAddress");I("1.2.840.113549.1.9.2","unstructuredName");I("1.2.840.113549.1.9.3","contentType");I("1.2.840.113549.1.9.4","messageDigest");I("1.2.840.113549.1.9.5","signingTime");I("1.2.840.113549.1.9.6","counterSignature");I("1.2.840.113549.1.9.7","challengePassword");I("1.2.840.113549.1.9.8","unstructuredAddress");I("1.2.840.113549.1.9.14","extensionRequest");I("1.2.840.113549.1.9.20","friendlyName");I("1.2.840.113549.1.9.21","localKeyId");I("1.2.840.113549.1.9.22.1","x509Certificate");I("1.2.840.113549.1.12.10.1.1","keyBag");I("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");I("1.2.840.113549.1.12.10.1.3","certBag");I("1.2.840.113549.1.12.10.1.4","crlBag");I("1.2.840.113549.1.12.10.1.5","secretBag");I("1.2.840.113549.1.12.10.1.6","safeContentsBag");I("1.2.840.113549.1.5.13","pkcs5PBES2");I("1.2.840.113549.1.5.12","pkcs5PBKDF2");I("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");I("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");I("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");I("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");I("1.2.840.113549.2.7","hmacWithSHA1");I("1.2.840.113549.2.8","hmacWithSHA224");I("1.2.840.113549.2.9","hmacWithSHA256");I("1.2.840.113549.2.10","hmacWithSHA384");I("1.2.840.113549.2.11","hmacWithSHA512");I("1.2.840.113549.3.7","des-EDE3-CBC");I("2.16.840.1.101.3.4.1.2","aes128-CBC");I("2.16.840.1.101.3.4.1.22","aes192-CBC");I("2.16.840.1.101.3.4.1.42","aes256-CBC");I("2.5.4.3","commonName");I("2.5.4.4","surname");I("2.5.4.5","serialNumber");I("2.5.4.6","countryName");I("2.5.4.7","localityName");I("2.5.4.8","stateOrProvinceName");I("2.5.4.9","streetAddress");I("2.5.4.10","organizationName");I("2.5.4.11","organizationalUnitName");I("2.5.4.12","title");I("2.5.4.13","description");I("2.5.4.15","businessCategory");I("2.5.4.17","postalCode");I("2.5.4.42","givenName");I("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");I("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");I("2.16.840.1.113730.1.1","nsCertType");I("2.16.840.1.113730.1.13","nsComment");at("2.5.29.1","authorityKeyIdentifier");at("2.5.29.2","keyAttributes");at("2.5.29.3","certificatePolicies");at("2.5.29.4","keyUsageRestriction");at("2.5.29.5","policyMapping");at("2.5.29.6","subtreesConstraint");at("2.5.29.7","subjectAltName");at("2.5.29.8","issuerAltName");at("2.5.29.9","subjectDirectoryAttributes");at("2.5.29.10","basicConstraints");at("2.5.29.11","nameConstraints");at("2.5.29.12","policyConstraints");at("2.5.29.13","basicConstraints");I("2.5.29.14","subjectKeyIdentifier");I("2.5.29.15","keyUsage");at("2.5.29.16","privateKeyUsagePeriod");I("2.5.29.17","subjectAltName");I("2.5.29.18","issuerAltName");I("2.5.29.19","basicConstraints");at("2.5.29.20","cRLNumber");at("2.5.29.21","cRLReason");at("2.5.29.22","expirationDate");at("2.5.29.23","instructionCode");at("2.5.29.24","invalidityDate");at("2.5.29.25","cRLDistributionPoints");at("2.5.29.26","issuingDistributionPoint");at("2.5.29.27","deltaCRLIndicator");at("2.5.29.28","issuingDistributionPoint");at("2.5.29.29","certificateIssuer");at("2.5.29.30","nameConstraints");I("2.5.29.31","cRLDistributionPoints");I("2.5.29.32","certificatePolicies");at("2.5.29.33","policyMappings");at("2.5.29.34","policyConstraints");I("2.5.29.35","authorityKeyIdentifier");at("2.5.29.36","policyConstraints");I("2.5.29.37","extKeyUsage");at("2.5.29.46","freshestCRL");at("2.5.29.54","inhibitAnyPolicy");I("1.3.6.1.4.1.11129.2.4.2","timestampList");I("1.3.6.1.5.5.7.1.1","authorityInfoAccess");I("1.3.6.1.5.5.7.3.1","serverAuth");I("1.3.6.1.5.5.7.3.2","clientAuth");I("1.3.6.1.5.5.7.3.3","codeSigning");I("1.3.6.1.5.5.7.3.4","emailProtection");I("1.3.6.1.5.5.7.3.8","timeStamping")});var an=z((A2,cs)=>{var yt=ft();Bt();kn();var P=cs.exports=yt.asn1=yt.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(yt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||yt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=P.copy(a)),a};P.copy=function(t,e){var r;if(yt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(yt.util.isArray(t)){if(!yt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function on(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var pl=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;on(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=yt.util.createBuffer(t));var r=t.length(),n=Pn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Pn(t,e,r,n){var i;on(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var f=pl(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,l,h=(o&32)===32;if(h)if(u=[],f===void 0)for(;;){if(on(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(Pn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(Pn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&(l=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&f>1){var g=t.read,d=e,p=0;if(a===P.Type.BITSTRING&&(on(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=Pn(t,e,r+1,y),E=i-t.length();e-=E,a==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=g,e=d)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===P.Type.BMPSTRING)for(u="";f>0;f-=2)on(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var T=l===void 0?null:{bitStringContents:l};return P.create(s,a,h,u,T)}P.toDer=function(t){var e=yt.util.createBuffer(),r=t.tagClass|t.type,n=yt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(P.toDer(t.value[o]))}else if(t.type===P.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=yt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=yt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),l=parseInt(t.substr(c+4,2),10),h=u*60+l;h*=6e4,f==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var l=t.length-5,h=t.charAt(l);if(h==="+"||h==="-"){var g=parseInt(t.substr(l+1,2),10),d=parseInt(t.substr(l+4,2),10);c=g*60+d,c*=6e4,h==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(o,s,a,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=yt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=yt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&yt.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=P.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var fs=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=P.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,yt.pki&&yt.pki.oids&&f in yt.pki.oids&&(n+=" ("+yt.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+yt.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+yt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)fs.test(t.value)||(n+="("+t.value+") "),n+="0x"+yt.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=yt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+yt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:fs.test(t.value)?n+="0x"+yt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var hs=z((C2,ls)=>{var mt=ft();Di();Pi();Bt();ls.exports=mt.des=mt.des||{};mt.des.startEncrypting=function(t,e,r,n){var i=Kn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};mt.des.createEncryptionCipher=function(t,e){return Kn({key:t,output:null,decrypt:!1,mode:e})};mt.des.startDecrypting=function(t,e,r,n){var i=Kn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};mt.des.createDecryptionCipher=function(t,e){return Kn({key:t,output:null,decrypt:!0,mode:e})};mt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return us(r._keys,n,i,!1)},decrypt:function(n,i){return us(r._keys,n,i,!0)}}}),r._init=!1};mt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=mt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Sl(e),this._init=!0}};ce("DES-ECB",mt.cipher.modes.ecb);ce("DES-CBC",mt.cipher.modes.cbc);ce("DES-CFB",mt.cipher.modes.cfb);ce("DES-OFB",mt.cipher.modes.ofb);ce("DES-CTR",mt.cipher.modes.ctr);ce("3DES-ECB",mt.cipher.modes.ecb);ce("3DES-CBC",mt.cipher.modes.cbc);ce("3DES-CFB",mt.cipher.modes.cfb);ce("3DES-OFB",mt.cipher.modes.ofb);ce("3DES-CTR",mt.cipher.modes.ctr);function ce(t,e){var r=function(){return new mt.des.Algorithm(t,e)};mt.cipher.registerAlgorithm(t,r)}var yl=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],gl=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],xl=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],ml=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],vl=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],bl=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],El=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],wl=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Sl(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,T=0;T<p;T++){var w=t.getInt32(),S=t.getInt32();b=(w>>>4^S)&252645135,S^=b,w^=b<<4,b=(S>>>-16^w)&65535,w^=b,S^=b<<-16,b=(w>>>2^S)&858993459,S^=b,w^=b<<2,b=(S>>>-16^w)&65535,w^=b,S^=b<<-16,b=(w>>>1^S)&1431655765,S^=b,w^=b<<1,b=(S>>>8^w)&16711935,w^=b,S^=b<<8,b=(w>>>1^S)&1431655765,S^=b,w^=b<<1,b=w<<8|S>>>20&240,w=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,S=S<<2|S>>>26):(w=w<<1|w>>>27,S=S<<1|S>>>27),w&=-15,S&=-15;var N=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|o[w>>>12&15]|s[w>>>8&15]|a[w>>>4&15],G=f[S>>>28]|c[S>>>24&15]|u[S>>>20&15]|l[S>>>16&15]|h[S>>>12&15]|g[S>>>8&15]|d[S>>>4&15];b=(G>>>16^N)&65535,y[E++]=N^b,y[E++]=G^b<<16}}return y}function us(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],f=e[1];s=(a>>>4^f)&252645135,f^=s,a^=s<<4,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=o[c+1],l=o[c+2],h=o[c];h!=u;h+=l){var g=f^t[h],d=(f>>>4|f<<28)^t[h+1];s=a,a=f,f=s^(gl[g>>>24&63]|ml[g>>>16&63]|bl[g>>>8&63]|wl[g&63]|yl[d>>>24&63]|xl[d>>>16&63]|vl[d>>>8&63]|El[d&63])}s=a,a=f,f=s}a=a>>>1|a<<31,f=f>>>1|f<<31,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(a>>>4^f)&252645135,f^=s,a^=s<<4,r[0]=a,r[1]=f}function Kn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=mt.cipher.createDecipher(r,t.key):n=mt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof mt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var er=z((_2,ds)=>{var Un=ft();ds.exports=Un.md=Un.md||{};Un.md.algorithms=Un.md.algorithms||{}});var ys=z((I2,ps)=>{var Ee=ft();er();Bt();var Bl=ps.exports=Ee.hmac=Ee.hmac||{};Bl.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Ee.md.algorithms)e=Ee.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=Ee.util.createBuffer(s);else if(Ee.util.isArray(s)){var a=s;s=Ee.util.createBuffer();for(var f=0;f<a.length;++f)s.putByte(a[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=Ee.util.createBuffer(),n=Ee.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var a=s.at(f);r.putByte(54^a),n.putByte(92^a)}if(c<e.blockLength)for(var a=e.blockLength-c,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var On=z(()=>{});var so=z((L2,gs)=>{var qt=ft();ys();er();Bt();var Al=qt.pkcs5=qt.pkcs5||{},we;qt.util.isNodejs&&!qt.options.usePureJavaScript&&(we=On());gs.exports=qt.pbkdf2=Al.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),qt.util.isNodejs&&!qt.options.usePureJavaScript&&we.pbkdf2&&(i===null||typeof i!="object")&&(we.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?we.pbkdf2Sync.length===4?we.pbkdf2(t,e,r,n,function(b,T){if(b)return o(b);o(null,T.toString("binary"))}):we.pbkdf2(t,e,r,n,i,function(b,T){if(b)return o(b);o(null,T.toString("binary"))}):we.pbkdf2Sync.length===4?we.pbkdf2Sync(t,e,r,n).toString("binary"):we.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in qt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=qt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var f=Math.ceil(n/s),c=n-(f-1)*s,u=qt.hmac.create();u.start(i,t);var l="",h,g,d;if(!o){for(var p=1;p<=f;++p){u.start(null,null),u.update(e),u.update(qt.util.int32ToBytes(p)),h=d=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(d),g=u.digest().getBytes(),h=qt.util.xorBytes(h,g,s),d=g;l+=p<f?h:h.substr(0,c)}return l}var p=1,y;function m(){if(p>f)return o(null,l);u.start(null,null),u.update(e),u.update(qt.util.int32ToBytes(p)),h=d=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(d),g=u.digest().getBytes(),h=qt.util.xorBytes(h,g,s),d=g,++y,qt.util.setImmediate(E);l+=p<f?h:h.substr(0,c),++p,m()}m()}});var vs=z((N2,ms)=>{var Fn=ft();Bt();var xs=ms.exports=Fn.pem=Fn.pem||{};xs.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Mn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Mn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Mn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Mn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Fn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};xs.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Fn.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var f=o[2].split(i),c=0;o&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),l=c+1;l<f.length;++l){var h=f[l];if(!/\s/.test(h[0]))break;u+=h,c=l}if(o=u.match(n),o){for(var g={name:o[1],values:[]},d=o[2].split(","),p=0;p<d.length;++p)g.values.push(Cl(d[p]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++c}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Mn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Cl(t){return t.replace(/^\s+/,"")}});var As=z((D2,Bs)=>{var ue=ft();er();Bt();var Es=Bs.exports=ue.sha256=ue.sha256||{};ue.md.sha256=ue.md.algorithms.sha256=Es;Es.create=function(){ws||_l();var t=null,e=ue.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=ue.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=ue.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),bs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ue.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(fo.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var l={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};bs(l,r,i);var h=ue.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h.putInt32(l.h5),h.putInt32(l.h6),h.putInt32(l.h7),h},n};var fo=null,ws=!1,Ss=null;function _l(){fo=String.fromCharCode(128),fo+=ue.util.fillString(String.fromCharCode(0),64),Ss=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ws=!0}function bs(t,e,r){for(var n,i,o,s,a,f,c,u,l,h,g,d,p,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,l=t.h1,h=t.h2,g=t.h3,d=t.h4,p=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)s=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=y^d&(p^y),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&l|h&(u^l),n=m+s+a+Ss[c]+e[c],i=o+f,m=y,y=p,p=d,d=g+n>>>0,g=h,h=l,l=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+l|0,t.h2=t.h2+h|0,t.h3=t.h3+g|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var _s=z((k2,Cs)=>{var le=ft();Bt();var Vn=null;le.util.isNodejs&&!le.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Vn=On());var Il=Cs.exports=le.prng=le.prng||{};Il.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var l=e.plugin.cipher,h=e.plugin.increment,g=e.plugin.formatKey,d=e.plugin.formatSeed,p=le.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(p.length()>=c)return u(null,p.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return le.util.nextTick(function(){o(y)});var E=l(e.key,e.seed);e.generated+=E.length,p.putBytes(E),e.key=g(l(e.key,h(e.seed))),e.seed=d(l(e.key,e.seed)),le.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,l=e.plugin.increment,h=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var d=le.util.createBuffer();d.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=h(u(e.key,l(e.seed))),e.seed=g(u(e.key,e.seed))}return d.getBytes(c)};function o(c){if(e.pools[0].messageLength>=32)return a(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(l,h){if(l)return c(l);e.collect(h),a(),c()})}function s(){if(e.pools[0].messageLength>=32)return a();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,l=0;l<32;++l)e.reseeds%u===0&&(c.update(e.pools[l].digest().getBytes()),e.pools[l].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var h=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function f(c){var u=null,l=le.util.globalScope,h=l.crypto||l.msCrypto;h&&h.getRandomValues&&(u=function(w){return h.getRandomValues(w)});var g=le.util.createBuffer();if(u)for(;g.length()<c;){var d=Math.max(1,Math.min(c-g.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var y=0;y<p.length;++y)g.putInt32(p[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(g.length()<c)for(var m,E,b,T=Math.floor(Math.random()*65536);g.length()<c;){E=16807*(T&65535),m=16807*(T>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),T=E&4294967295;for(var y=0;y<3;++y)b=T>>>(y<<3),b^=Math.floor(Math.random()*256),g.putByte(b&255)}return g.getBytes(c)}return Vn?(e.seedFile=function(c,u){Vn.randomBytes(c,function(l,h){if(l)return u(l);u(null,h.toString())})},e.seedFileSync=function(c){return Vn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(l){u(l)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,l=0;l<u;++l)e.pools[e.pool].update(c.substr(l,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var l="",h=0;h<u;h+=8)l+=String.fromCharCode(c>>h&255);e.collect(l)},e.registerWorker=function(c){if(c===self)e.seedFile=function(l,h){function g(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",g),h(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:l}}})};else{var u=function(l){var h=l.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(g,d){c.postMessage({forge:{prng:{err:g,bytes:d}}})})};c.addEventListener("message",u)}},e}});var sn=z((P2,co)=>{var Dt=ft();Rn();As();_s();Bt();(function(){if(Dt.random&&Dt.random.getBytes){co.exports=Dt.random;return}(function(t){var e={},r=new Array(4),n=Dt.util.createBuffer();e.formatKey=function(l){var h=Dt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),Dt.aes._expandKey(l,!1)},e.formatSeed=function(l){var h=Dt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),l},e.cipher=function(l,h){return Dt.aes._updateBlock(l,h,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(l){return++l[3],l},e.md=Dt.md.sha256;function i(){var l=Dt.prng.create(e);return l.getBytes=function(h,g){return l.generate(h,g)},l.getBytesSync=function(h){return l.generate(h)},l}var o=i(),s=null,a=Dt.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(s=function(l){return f.getRandomValues(l)}),Dt.options.usePureJavaScript||!Dt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}o.collect(c),c=null}t&&(t().mousemove(function(l){o.collectInt(l.clientX,16),o.collectInt(l.clientY,16)}),t().keypress(function(l){o.collectInt(l.charCode,8)}))}if(!Dt.random)Dt.random=o;else for(var u in o)Dt.random[u]=o[u];Dt.random.createInstance=i,co.exports=Dt.random})(typeof jQuery<"u"?jQuery:null)})()});var Ls=z((K2,Rs)=>{var zt=ft();Bt();var uo=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Is=[1,2,3,5],Tl=function(t,e){return t<<e&65535|(t&65535)>>16-e},Rl=function(t,e){return(t&65535)>>e|t<<16-e&65535};Rs.exports=zt.rc2=zt.rc2||{};zt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=zt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(uo[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,uo[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,uo[r.at(a+1)^r.at(a+o)]);return r};var Ts=function(t,e,r){var n=!1,i=null,o=null,s=null,a,f,c,u,l=[];for(t=zt.rc2.expandKey(t,e),c=0;c<64;c++)l.push(t.getInt16Le());r?(a=function(d){for(c=0;c<4;c++)d[c]+=l[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),d[c]=Tl(d[c],Is[c]),u++},f=function(d){for(c=0;c<4;c++)d[c]+=l[d[(c+3)%4]&63]}):(a=function(d){for(c=3;c>=0;c--)d[c]=Rl(d[c],Is[c]),d[c]-=l[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),u--},f=function(d){for(c=3;c>=0;c--)d[c]-=l[d[(c+3)%4]&63]});var h=function(d){var p=[];for(c=0;c<4;c++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var m=0;m<d.length;m++)for(var E=0;E<d[m][0];E++)d[m][1](p);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(p[c]):p[c]^=s.getInt16Le()),o.putInt16Le(p[c])},g=null;return g={start:function(d,p){d&&typeof d=="string"&&(d=zt.util.createBuffer(d)),n=!1,i=zt.util.createBuffer(),o=p||new zt.util.createBuffer,s=d,g.output=o},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)h([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,g.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,o,!r);else{var m=o.length(),E=o.at(m-1);E>m?p=!1:o.truncate(E)}return p}},g};zt.rc2.startEncrypting=function(t,e,r){var n=zt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};zt.rc2.createEncryptionCipher=function(t,e){return Ts(t,e,!0)};zt.rc2.startDecrypting=function(t,e,r){var n=zt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};zt.rc2.createDecryptionCipher=function(t,e){return Ts(t,e,!1)}});var zn=z((U2,Ms)=>{var lo=ft();Ms.exports=lo.jsbn=lo.jsbn||{};var Se,Ll=0xdeadbeefcafe,Ns=(Ll&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}lo.jsbn.BigInteger=C;function nt(){return new C(null)}function Nl(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Dl(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=a*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+a*c+(i>>>30),r.data[n++]=f&1073741823}return i}function Ds(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=a*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+a*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=Ds,Se=28):Ns&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Dl,Se=30):Ns&&navigator.appName!="Netscape"?(C.prototype.am=Nl,Se=26):(C.prototype.am=Ds,Se=28);C.prototype.DB=Se;C.prototype.DM=(1<<Se)-1;C.prototype.DV=1<<Se;var ho=52;C.prototype.FV=Math.pow(2,ho);C.prototype.F1=ho-Se;C.prototype.F2=2*Se-ho;var kl="0123456789abcdefghijklmnopqrstuvwxyz",qn=new Array,Tr,Qt;Tr="0".charCodeAt(0);for(Qt=0;Qt<=9;++Qt)qn[Tr++]=Qt;Tr="a".charCodeAt(0);for(Qt=10;Qt<36;++Qt)qn[Tr++]=Qt;Tr="A".charCodeAt(0);for(Qt=10;Qt<36;++Qt)qn[Tr++]=Qt;function ks(t){return kl.charAt(t)}function Ps(t,e){var r=qn[t.charCodeAt(e)];return r??-1}function Pl(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Kl(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Fe(t){var e=nt();return e.fromInt(t),e}function Ul(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:Ps(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Ol(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Ml(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=ks(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=ks(n));return i?o:"0"}function Fl(){var t=nt();return C.ZERO.subTo(this,t),t}function Vl(){return this.s<0?this.negate():this}function ql(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Hn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Hl(){return this.t<=0?0:this.DB*(this.t-1)+Hn(this.data[this.t-1]^this.s&this.DM)}function zl(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Gl(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Yl(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function Wl(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function $l(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Zl(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function Ql(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Xl(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=nt());var o=nt(),s=this.s,a=t.s,f=this.DB-Hn(n.data[n.t-1]);f>0?(n.lShiftTo(f,o),i.lShiftTo(f,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,u=o.data[c-1];if(u!=0){var l=u*(1<<this.F1)+(c>1?o.data[c-2]>>this.F2:0),h=this.FV/l,g=(1<<this.F1)/l,d=1<<this.F2,p=r.t,y=p-c,m=e??nt();for(o.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(o,o);o.t<c;)o.data[o.t++]=0;for(;--y>=0;){var E=r.data[--p]==u?this.DM:Math.floor(r.data[p]*h+(r.data[p-1]+d)*g);if((r.data[p]+=o.am(0,E,r,y,0,c))<E)for(o.dlShiftTo(y,m),r.subTo(m,r);r.data[p]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=a&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function Jl(t){var e=nt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function rr(t){this.m=t}function jl(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function th(t){return t}function eh(t){t.divRemTo(this.m,null,t)}function rh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function nh(t,e){t.squareTo(e),this.reduce(e)}rr.prototype.convert=jl;rr.prototype.revert=th;rr.prototype.reduce=eh;rr.prototype.mulTo=rh;rr.prototype.sqrTo=nh;function ih(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function nr(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function oh(t){var e=nt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function ah(t){var e=nt();return t.copyTo(e),this.reduce(e),e}function sh(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function fh(t,e){t.squareTo(e),this.reduce(e)}function ch(t,e,r){t.multiplyTo(e,r),this.reduce(r)}nr.prototype.convert=oh;nr.prototype.revert=ah;nr.prototype.reduce=sh;nr.prototype.mulTo=ch;nr.prototype.sqrTo=fh;function uh(){return(this.t>0?this.data[0]&1:this.s)==0}function lh(t,e){if(t>4294967295||t<1)return C.ONE;var r=nt(),n=nt(),i=e.convert(this),o=Hn(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function hh(t,e){var r;return t<256||e.isEven()?r=new rr(e):r=new nr(e),this.exp(t,r)}C.prototype.copyTo=Pl;C.prototype.fromInt=Kl;C.prototype.fromString=Ul;C.prototype.clamp=Ol;C.prototype.dlShiftTo=zl;C.prototype.drShiftTo=Gl;C.prototype.lShiftTo=Yl;C.prototype.rShiftTo=Wl;C.prototype.subTo=$l;C.prototype.multiplyTo=Zl;C.prototype.squareTo=Ql;C.prototype.divRemTo=Xl;C.prototype.invDigit=ih;C.prototype.isEven=uh;C.prototype.exp=lh;C.prototype.toString=Ml;C.prototype.negate=Fl;C.prototype.abs=Vl;C.prototype.compareTo=ql;C.prototype.bitLength=Hl;C.prototype.mod=Jl;C.prototype.modPowInt=hh;C.ZERO=Fe(0);C.ONE=Fe(1);function dh(){var t=nt();return this.copyTo(t),t}function ph(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function yh(){return this.t==0?this.s:this.data[0]<<24>>24}function gh(){return this.t==0?this.s:this.data[0]<<16>>16}function xh(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function mh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function vh(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Fe(r),i=nt(),o=nt(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function bh(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var f=Ps(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function Eh(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),po,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function wh(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Sh(t){return this.compareTo(t)==0}function Bh(t){return this.compareTo(t)<0?this:t}function Ah(t){return this.compareTo(t)>0?this:t}function Ch(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function _h(t,e){return t&e}function Ih(t){var e=nt();return this.bitwiseTo(t,_h,e),e}function po(t,e){return t|e}function Th(t){var e=nt();return this.bitwiseTo(t,po,e),e}function Ks(t,e){return t^e}function Rh(t){var e=nt();return this.bitwiseTo(t,Ks,e),e}function Us(t,e){return t&~e}function Lh(t){var e=nt();return this.bitwiseTo(t,Us,e),e}function Nh(){for(var t=nt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Dh(t){var e=nt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function kh(t){var e=nt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Ph(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Kh(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Ph(this.data[t]);return this.s<0?this.t*this.DB:-1}function Uh(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Oh(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Uh(this.data[r]^e);return t}function Mh(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Fh(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Vh(t){return this.changeBit(t,po)}function qh(t){return this.changeBit(t,Us)}function Hh(t){return this.changeBit(t,Ks)}function zh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Gh(t){var e=nt();return this.addTo(t,e),e}function Yh(t){var e=nt();return this.subTo(t,e),e}function Wh(t){var e=nt();return this.multiplyTo(t,e),e}function $h(t){var e=nt();return this.divRemTo(t,e,null),e}function Zh(t){var e=nt();return this.divRemTo(t,null,e),e}function Qh(t){var e=nt(),r=nt();return this.divRemTo(t,e,r),new Array(e,r)}function Xh(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Jh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function fn(){}function Os(t){return t}function jh(t,e,r){t.multiplyTo(e,r)}function td(t,e){t.squareTo(e)}fn.prototype.convert=Os;fn.prototype.revert=Os;fn.prototype.mulTo=jh;fn.prototype.sqrTo=td;function ed(t){return this.exp(t,new fn)}function rd(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function nd(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Rr(t){this.r2=nt(),this.q3=nt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function id(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nt();return t.copyTo(e),this.reduce(e),e}function od(t){return t}function ad(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function sd(t,e){t.squareTo(e),this.reduce(e)}function fd(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Rr.prototype.convert=id;Rr.prototype.revert=od;Rr.prototype.reduce=ad;Rr.prototype.mulTo=fd;Rr.prototype.sqrTo=sd;function cd(t,e){var r=t.bitLength(),n,i=Fe(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new rr(e):e.isEven()?o=new Rr(e):o=new nr(e);var s=new Array,a=3,f=n-1,c=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=nt();for(o.sqrTo(s[1],u);a<=c;)s[a]=nt(),o.mulTo(u,s[a-2],s[a]),a+=2}var l=t.t-1,h,g=!0,d=nt(),p;for(r=Hn(t.data[l])-1;l>=0;){for(r>=f?h=t.data[l]>>r-f&c:(h=(t.data[l]&(1<<r+1)-1)<<f-r,l>0&&(h|=t.data[l-1]>>this.DB+r-f)),a=n;!(h&1);)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--l),g)s[h].copyTo(i),g=!1;else{for(;a>1;)o.sqrTo(i,d),o.sqrTo(d,i),a-=2;a>0?o.sqrTo(i,d):(p=i,i=d,d=p),o.mulTo(d,s[h],i)}for(;l>=0&&!(t.data[l]&1<<r);)o.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--l)}return o.revert(i)}function ud(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function ld(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function hd(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Fe(1),o=Fe(0),s=Fe(0),a=Fe(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var ee=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],dd=(1<<26)/ee[ee.length-1];function pd(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=ee[ee.length-1]){for(e=0;e<ee.length;++e)if(r.data[0]==ee[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ee.length;){for(var n=ee[e],i=e+1;i<ee.length&&n<dd;)n*=ee[i++];for(n=r.modInt(n);e<i;)if(n%ee[e++]==0)return!1}return r.millerRabin(t)}function yd(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=gd(),o,s=0;s<t;++s){do o=new C(this.bitLength(),i);while(o.compareTo(C.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(C.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(C.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function gd(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=xh;C.prototype.toRadix=vh;C.prototype.fromRadix=bh;C.prototype.fromNumber=Eh;C.prototype.bitwiseTo=Ch;C.prototype.changeBit=Fh;C.prototype.addTo=zh;C.prototype.dMultiply=Xh;C.prototype.dAddOffset=Jh;C.prototype.multiplyLowerTo=rd;C.prototype.multiplyUpperTo=nd;C.prototype.modInt=ld;C.prototype.millerRabin=yd;C.prototype.clone=dh;C.prototype.intValue=ph;C.prototype.byteValue=yh;C.prototype.shortValue=gh;C.prototype.signum=mh;C.prototype.toByteArray=wh;C.prototype.equals=Sh;C.prototype.min=Bh;C.prototype.max=Ah;C.prototype.and=Ih;C.prototype.or=Th;C.prototype.xor=Rh;C.prototype.andNot=Lh;C.prototype.not=Nh;C.prototype.shiftLeft=Dh;C.prototype.shiftRight=kh;C.prototype.getLowestSetBit=Kh;C.prototype.bitCount=Oh;C.prototype.testBit=Mh;C.prototype.setBit=Vh;C.prototype.clearBit=qh;C.prototype.flipBit=Hh;C.prototype.add=Gh;C.prototype.subtract=Yh;C.prototype.multiply=Wh;C.prototype.divide=$h;C.prototype.remainder=Zh;C.prototype.divideAndRemainder=Qh;C.prototype.modPow=cd;C.prototype.modInverse=hd;C.prototype.pow=ed;C.prototype.gcd=ud;C.prototype.isProbablePrime=pd});var zs=z((O2,Hs)=>{var he=ft();er();Bt();var Vs=Hs.exports=he.sha1=he.sha1||{};he.md.sha1=he.md.algorithms.sha1=Vs;Vs.create=function(){qs||xd();var t=null,e=he.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=he.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=he.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Fs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=he.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(yo.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var l={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Fs(l,r,i);var h=he.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h},n};var yo=null,qs=!1;function xd(){yo=String.fromCharCode(128),yo+=he.util.fillString(String.fromCharCode(0),64),qs=!0}function Fs(t,e,r){for(var n,i,o,s,a,f,c,u,l=r.length();l>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o&s|a&(o^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+3395469782+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,l-=64}}});var Ws=z((M2,Ys)=>{var de=ft();Bt();sn();zs();var Gs=Ys.exports=de.pkcs1=de.pkcs1||{};Gs.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=de.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),f=a-2*o.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),o.update(n,"raw");for(var u=o.digest(),l="",h=f-e.length,g=0;g<h;g++)l+="\0";var d=u.getBytes()+l+""+e;if(!i)i=de.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=o.digestLength,c}var p=Gn(i,a-o.digestLength-1,s),y=de.util.xorBytes(d,p,d.length),m=Gn(y,o.digestLength,s),E=de.util.xorBytes(i,m,i.length);return"\0"+E+y};Gs.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=de.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),l=Gn(u,i.digestLength,o),h=de.util.xorBytes(c,l,c.length),g=Gn(h,s-i.digestLength-1,o),d=de.util.xorBytes(u,g,u.length),p=d.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=a.charAt(m)!==p.charAt(m);for(var E=1,b=i.digestLength,T=i.digestLength;T<d.length;T++){var w=d.charCodeAt(T),S=w&1^1,L=E?65534:0;y|=w&L,E=E&S,b+=E}if(y||d.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)};function Gn(t,e,r){r||(r=de.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var $s=z((F2,go)=>{var Ve=ft();Bt();zn();sn();(function(){if(Ve.prime){go.exports=Ve.prime;return}var t=go.exports=Ve.prime=Ve.prime||{},e=Ve.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(l,h){return l|h};t.generateProbablePrime=function(l,h,g){typeof h=="function"&&(g=h,h={}),h=h||{};var d=h.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=h.prng||Ve.random,y={nextBytes:function(m){for(var E=p.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(d.name==="PRIMEINC")return o(l,y,d.options,g);throw new Error("Invalid prime generation algorithm: "+d.name)};function o(l,h,g,d){return"workers"in g?f(l,h,g,d):s(l,h,g,d)}function s(l,h,g,d){var p=c(l,h),y=0,m=u(p.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var E=10;"maxBlockTime"in g&&(E=g.maxBlockTime),a(p,l,h,y,m,E,d)}function a(l,h,g,d,p,y,m){var E=+new Date;do{if(l.bitLength()>h&&(l=c(h,g)),l.isProbablePrime(p))return m(null,l);l.dAddOffset(r[d++%8],0)}while(y<0||+new Date-E<y);Ve.util.setImmediate(function(){a(l,h,g,d,p,y,m)})}function f(l,h,g,d){if(typeof Worker>"u")return s(l,h,g,d);var p=c(l,h),y=g.workers,m=g.workLoad||100,E=m*30/8,b=g.workerScript||"forge/prime.worker.js";if(y===-1)return Ve.util.estimateCores(function(w,S){w&&(S=2),y=S-1,T()});T();function T(){y=Math.max(1,y);for(var w=[],S=0;S<y;++S)w[S]=new Worker(b);for(var L=y,S=0;S<y;++S)w[S].addEventListener("message",G);var N=!1;function G(Y){if(!N){--L;var q=Y.data;if(q.found){for(var J=0;J<w.length;++J)w[J].terminate();return N=!0,d(null,new e(q.prime,16))}p.bitLength()>l&&(p=c(l,h));var ct=p.toString(16);Y.target.postMessage({hex:ct,workLoad:m}),p.dAddOffset(E,0)}}}}function c(l,h){var g=new e(l,h),d=l-1;return g.testBit(d)||g.bitwiseTo(e.ONE.shiftLeft(d),i,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function u(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}})()});var Wn=z((V2,e0)=>{var V=ft();an();zn();kn();Ws();$s();sn();Bt();typeof et>"u"&&(et=V.jsbn.BigInteger);var et,xo=V.util.isNodejs?On():null,v=V.asn1,Xt=V.util;V.pki=V.pki||{};e0.exports=V.pki.rsa=V.rsa=V.rsa||{};var W=V.pki,md=[6,4,2,4,2,4,6,2],vd={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},bd={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Ed={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},wd=V.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Sd={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Bd=function(t){var e;if(t.algorithm in W.oids)e=W.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),o=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);o.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),o.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),v.toDer(i).getBytes()},js=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(et.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(et.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new et(V.util.bytesToHex(V.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(et.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};W.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=t0(t,e,r)):(i=V.util.createBuffer(),i.putBytes(t));for(var s=new et(i.toHex(),16),a=js(s,e,n),f=a.toString(16),c=V.util.createBuffer(),u=o-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(V.util.hexToBytes(f)),c.getBytes()};W.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new et(V.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=js(s,e,r),f=a.toString(16),c=V.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(V.util.hexToBytes(f)),n!==!1?Yn(c.getBytes(),e,r):c.getBytes()};W.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||V.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=f.charCodeAt(c)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new et(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};W.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new et(null);r.fromInt(30);for(var n=0,i=function(l,h){return l|h},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new et(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(et.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Cd(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(md[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(et.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};W.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!V.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Zs("generateKeyPair"))return xo.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,c){if(a)return n(a);n(null,{privateKey:W.privateKeyFromPem(c),publicKey:W.publicKeyFromPem(f)})});if(Qs("generateKey")&&Qs("exportKey"))return Xt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Js(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Xt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=W.privateKeyFromAsn1(v.fromDer(V.util.createBuffer(a)));n(null,{privateKey:f,publicKey:W.setRsaPublicKey(f.n,f.e)})}});if(Xs("generateKey")&&Xs("exportKey")){var i=Xt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Js(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,c=Xt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var l=u.target.result,h=W.privateKeyFromAsn1(v.fromDer(V.util.createBuffer(l)));n(null,{privateKey:h,publicKey:W.setRsaPublicKey(h.n,h.e)})},c.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(Zs("generateKeyPairSync")){var o=xo.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:W.privateKeyFromPem(o.privateKey),publicKey:W.publicKeyFromPem(o.publicKey)}}}var s=W.rsa.createKeyPairGenerationState(t,e,r);if(!n)return W.rsa.stepKeyPairGenerationState(s,0),s.keys;Ad(s,r,n)};W.setRsaPublicKey=W.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,c){return t0(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return V.pkcs1.encode_rsa_oaep(f,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return W.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(f,c){c=Yn(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),l={},h=[];if(!v.validate(u,Sd,l,h)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=h,g}var d=v.derToOid(l.algorithmIdentifier);if(!(d===V.oids.md2||d===V.oids.md5||d===V.oids.sha1||d===V.oids.sha224||d===V.oids.sha256||d===V.oids.sha384||d===V.oids.sha512||d===V.oids["sha512-224"]||d===V.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=d,g}if((d===V.oids.md2||d===V.oids.md5)&&!("parameters"in l))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===l.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(f,c){return c=Yn(c,r,!0),f===c}});var a=W.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};W.setRsaPrivateKey=W.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var f={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return f.decrypt=function(c,u,l){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var h=W.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Yn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(g,d){return V.pkcs1.decode_rsa_oaep(d,g,l)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(h,f,!1)},f.sign=function(c,u){var l=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Bd},l=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},l=1);var h=u.encode(c,f.n.bitLength());return W.rsa.encrypt(h,f,l)},f};W.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(W.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};W.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,vd,e,r)&&(t=v.fromDer(V.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,bd,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,f,c,u,l;return i=V.util.createBuffer(e.privateKeyModulus).toHex(),o=V.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=V.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=V.util.createBuffer(e.privateKeyPrime1).toHex(),f=V.util.createBuffer(e.privateKeyPrime2).toHex(),c=V.util.createBuffer(e.privateKeyExponent1).toHex(),u=V.util.createBuffer(e.privateKeyExponent2).toHex(),l=V.util.createBuffer(e.privateKeyCoefficient).toHex(),W.setRsaPrivateKey(new et(i,16),new et(o,16),new et(s,16),new et(a,16),new et(f,16),new et(c,16),new et(u,16),new et(l,16))};W.privateKeyToAsn1=W.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.qInv))])};W.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,wd,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==W.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,Ed,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=V.util.createBuffer(e.publicKeyModulus).toHex(),s=V.util.createBuffer(e.publicKeyExponent).toHex();return W.setRsaPublicKey(new et(o,16),new et(s,16))};W.publicKeyToAsn1=W.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(W.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[W.publicKeyToRSAPublicKey(t)])])};W.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,pe(t.e))])};function t0(t,e,r){var n=V.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<s;++f)n.putByte(a)}else for(;s>0;){for(var c=0,u=V.random.getBytes(s),f=0;f<s;++f)a=u.charCodeAt(f),a===0?++c:n.putByte(a);s=c}return n.putByte(0),n.putBytes(t),n}function Yn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=V.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var c=0;c<f;++c)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++f}else if(a===2)for(f=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++f}var u=o.getByte();if(u!==0||f!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function Ad(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,f){V.prime.generateProbablePrime(a,n,f)}function s(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.p=null,i();return}if(t.q.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(et.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function pe(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=V.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Cd(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Zs(t){return V.util.isNodejs&&typeof xo[t]=="function"}function Qs(t){return typeof Xt.globalScope<"u"&&typeof Xt.globalScope.crypto=="object"&&typeof Xt.globalScope.crypto.subtle=="object"&&typeof Xt.globalScope.crypto.subtle[t]=="function"}function Xs(t){return typeof Xt.globalScope<"u"&&typeof Xt.globalScope.msCrypto=="object"&&typeof Xt.globalScope.msCrypto.subtle=="object"&&typeof Xt.globalScope.msCrypto.subtle[t]=="function"}function Js(t){for(var e=V.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var s0=z((q2,a0)=>{var U=ft();Rn();an();hs();er();kn();so();vs();sn();Ls();Wn();Bt();typeof r0>"u"&&(r0=U.jsbn.BigInteger);var r0,B=U.asn1,$=U.pki=U.pki||{};a0.exports=$.pbe=U.pbe=U.pbe||{};var ir=$.oids,_d={name:"EncryptedPrivateKeyInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Id={name:"PBES2Algorithms",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Td={name:"pkcs-12PbeParams",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"iterations"}]};$.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,o=B.integerToDer(i),s,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,l;switch(r.algorithm){case"aes128":s=16,c=16,u=ir["aes128-CBC"],l=U.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=ir["aes192-CBC"],l=U.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=ir["aes256-CBC"],l=U.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=ir.desCBC,l=U.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),d=o0(g),p=U.pkcs5.pbkdf2(e,n,i,s,d),y=U.random.getBytesSync(c),m=l(p);m.start(y),m.update(B.toDer(t)),m.finish(),f=m.output.getBytes();var E=Rd(n,o,s,g);a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(ir.pkcs5PBES2).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(ir.pkcs5PBKDF2).getBytes()),E]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(u).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var b=new U.util.ByteBuffer(n),p=$.pbe.generatePkcs12Key(e,b,1,i,s),y=$.pbe.generatePkcs12Key(e,b,2,i,s),m=U.des.createEncryptionCipher(p);m.start(y),m.update(B.toDer(t)),m.finish(),f=m.output.getBytes(),a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(ir["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,n),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,o.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var T=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[a,B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,f)]);return T};$.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!B.validate(t,_d,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=B.derToOid(n.encryptionOid),a=$.pbe.getCipher(s,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=B.fromDer(a.output)),r};$.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:B.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};$.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return B.fromDer(e.body)};$.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=$.wrapRsaPrivateKey($.privateKeyToAsn1(t));return n=$.encryptPrivateKeyInfo(n,e,r),$.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);u.start(o),u.update(B.toDer($.privateKeyToAsn1(t))),u.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(l)};$.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=U.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=U.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=U.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(l){return U.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":o=8,s=function(l){return U.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":o=16,s=function(l){return U.rc2.createDecryptionCipher(l,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,a.substr(0,8),o),c=s(f);if(c.start(a),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=$.decryptPrivateKeyInfo(B.fromDer(r),e):r=B.fromDer(r),r!==null&&(r=$.privateKeyFromAsn1(r)),r};$.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');o=U.md.sha1.create()}var f=o.digestLength,c=o.blockLength,u=new U.util.ByteBuffer,l=new U.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)l.putInt16(t.charCodeAt(a));l.putInt16(0)}var h=l.length(),g=e.length(),d=new U.util.ByteBuffer;d.fillWithByte(r,c);var p=c*Math.ceil(g/c),y=new U.util.ByteBuffer;for(a=0;a<p;a++)y.putByte(e.at(a%g));var m=c*Math.ceil(h/c),E=new U.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(l.at(a%h));var b=y;b.putBuffer(E);for(var T=Math.ceil(i/f),w=1;w<=T;w++){var S=new U.util.ByteBuffer;S.putBytes(d.bytes()),S.putBytes(b.bytes());for(var L=0;L<n;L++)o.start(),o.update(S.getBytes()),S=o.digest();var N=new U.util.ByteBuffer;for(a=0;a<c;a++)N.putByte(S.at(a%f));var G=Math.ceil(g/c)+Math.ceil(h/c),Y=new U.util.ByteBuffer;for(s=0;s<G;s++){var q=new U.util.ByteBuffer(b.getBytes(c)),J=511;for(a=N.length()-1;a>=0;a--)J=J>>8,J+=N.at(a)+q.at(a),q.setAt(a,J&255);Y.putBuffer(q)}b=Y,u.putBuffer(S)}return u.truncate(u.length()-i),u};$.pbe.getCipher=function(t,e,r){switch(t){case $.oids.pkcs5PBES2:return $.pbe.getCipherForPBES2(t,e,r);case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case $.oids["pbewithSHAAnd40BitRC2-CBC"]:return $.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};$.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!B.validate(e,Id,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=B.derToOid(n.kdfOid),t!==$.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=B.derToOid(n.encOid),t!==$.oids["aes128-CBC"]&&t!==$.oids["aes192-CBC"]&&t!==$.oids["aes256-CBC"]&&t!==$.oids["des-EDE3-CBC"]&&t!==$.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=U.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,c;switch($.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=i0(n.prfOid),l=U.pkcs5.pbkdf2(r,s,a,f,u),h=n.encIv,g=c(l);return g.start(h),g};$.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!B.validate(e,Td,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=U.util.createBuffer(n.salt),a=U.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,c,u;switch(t){case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case $.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(p,y){var m=U.rc2.createDecryptionCipher(p,40);return m.start(y,null),m};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var l=i0(n.prfOid),h=$.pbe.generatePkcs12Key(r,s,1,a,f,l);l.start();var g=$.pbe.generatePkcs12Key(r,s,2,a,c,l);return u(h,g)};$.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[n0(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(n0(n,i[s-1]+t+e));return i.join("").substr(0,r)};function n0(t,e){return t.start().update(e).digest().getBytes()}function i0(t){var e;if(!t)e="hmacWithSHA1";else if(e=$.oids[B.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return o0(e)}function o0(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Rd(t,e,r,n){var i=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,t),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer($.oids[n]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),i}});var D0=z((Og,N0)=>{"use strict";N0.exports=Pp;function Pp(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,f){r[n]=function(u){if(o)if(o=!1,u)f(u);else{for(var l=new Array(arguments.length-1),h=0;h<l.length;)l[h++]=arguments[h];a.apply(null,l)}};try{t.apply(e||null,r)}catch(c){o&&(o=!1,f(c))}})}});var U0=z(K0=>{"use strict";var ci=K0;ci.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Or=new Array(64),P0=new Array(123);for(ie=0;ie<64;)P0[Or[ie]=ie<26?ie+65:ie<52?ie+71:ie<62?ie-4:ie-59|43]=ie++;var ie;ci.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,f;r<n;){var c=e[r++];switch(a){case 0:o[s++]=Or[c>>2],f=(c&3)<<4,a=1;break;case 1:o[s++]=Or[f|c>>4],f=(c&15)<<2,a=2;break;case 2:o[s++]=Or[f|c>>6],o[s++]=Or[c&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=Or[f],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var k0="invalid encoding";ci.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var f=e.charCodeAt(a++);if(f===61&&o>1)break;if((f=P0[f])===void 0)throw Error(k0);switch(o){case 0:s=f,o=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,o=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,o=3;break;case 3:r[n++]=(s&3)<<6|f,o=0;break}}if(o===1)throw Error(k0);return n-i};ci.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var M0=z((Fg,O0)=>{"use strict";O0.exports=ui;function ui(){this._listeners={}}ui.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};ui.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};ui.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Y0=z((Vg,G0)=>{"use strict";G0.exports=F0(F0);function F0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function o(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function a(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|c)>>>0,o,s)}}t.writeFloatLE=e.bind(null,V0),t.writeFloatBE=e.bind(null,q0);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:a*(1/0):f===0?a*1401298464324817e-60*c:a*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,H0),t.readFloatBE=r.bind(null,z0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function o(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function a(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,a,f+i),n(1/s>0?0:2147483648,a,f+o);else if(isNaN(s))n(0,a,f+i),n(2146959360,a,f+o);else if(s>17976931348623157e292)n(0,a,f+i),n((c<<31|2146435072)>>>0,a,f+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,f+i),n((c<<31|u/4294967296)>>>0,a,f+o);else{var l=Math.floor(Math.log(s)/Math.LN2);l===1024&&(l=1023),u=s*Math.pow(2,-l),n(u*4503599627370496>>>0,a,f+i),n((c<<31|l+1023<<20|u*1048576&1048575)>>>0,a,f+o)}}}t.writeDoubleLE=e.bind(null,V0,0,4),t.writeDoubleBE=e.bind(null,q0,4,0);function r(n,i,o,s,a){var f=n(s,a+i),c=n(s,a+o),u=(c>>31)*2+1,l=c>>>20&2047,h=4294967296*(c&1048575)+f;return l===2047?h?NaN:u*(1/0):l===0?u*5e-324*h:u*Math.pow(2,l-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,H0,0,4),t.readDoubleBE=r.bind(null,z0,4,0)}(),t}function V0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function q0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function H0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function z0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var W0=z((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Z0=z($0=>{"use strict";var Po=$0;Po.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Po.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,f;r<n;)f=e[r++],f<128?s[a++]=f:f>191&&f<224?s[a++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(f>>10),s[a++]=56320+(f&1023)):s[a++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Po.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var X0=z((Hg,Q0)=>{"use strict";Q0.exports=Kp;function Kp(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(o=t(n),s=0);var c=e.call(o,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var j0=z((zg,J0)=>{"use strict";J0.exports=kt;var hn=ur();function kt(t,e){this.lo=t>>>0,this.hi=e>>>0}var cr=kt.zero=new kt(0,0);cr.toNumber=function(){return 0};cr.zzEncode=cr.zzDecode=function(){return this};cr.length=function(){return 1};var Up=kt.zeroHash="\0\0\0\0\0\0\0\0";kt.fromNumber=function(e){if(e===0)return cr;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new kt(n,i)};kt.from=function(e){if(typeof e=="number")return kt.fromNumber(e);if(hn.isString(e))if(hn.Long)e=hn.Long.fromString(e);else return kt.fromNumber(parseInt(e,10));return e.low||e.high?new kt(e.low>>>0,e.high>>>0):cr};kt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};kt.prototype.toLong=function(e){return hn.Long?new hn.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ye=String.prototype.charCodeAt;kt.fromHash=function(e){return e===Up?cr:new kt((Ye.call(e,0)|Ye.call(e,1)<<8|Ye.call(e,2)<<16|Ye.call(e,3)<<24)>>>0,(Ye.call(e,4)|Ye.call(e,5)<<8|Ye.call(e,6)<<16|Ye.call(e,7)<<24)>>>0)};kt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};kt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};kt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};kt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var ur=z(Ko=>{"use strict";var F=Ko;F.asPromise=D0();F.base64=U0();F.EventEmitter=M0();F.float=Y0();F.inquire=W0();F.utf8=Z0();F.pool=X0();F.LongBits=j0();F.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);F.global=F.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Ko;F.emptyArray=Object.freeze?Object.freeze([]):[];F.emptyObject=Object.freeze?Object.freeze({}):{};F.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};F.isString=function(e){return typeof e=="string"||e instanceof String};F.isObject=function(e){return e&&typeof e=="object"};F.isset=F.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};F.Buffer=function(){try{var t=F.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();F._Buffer_from=null;F._Buffer_allocUnsafe=null;F.newBuffer=function(e){return typeof e=="number"?F.Buffer?F._Buffer_allocUnsafe(e):new F.Array(e):F.Buffer?F._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};F.Array=typeof Uint8Array<"u"?Uint8Array:Array;F.Long=F.global.dcodeIO&&F.global.dcodeIO.Long||F.global.Long||F.inquire("long");F.key2Re=/^true|false|0|1$/;F.key32Re=/^-?(?:0|[1-9][0-9]*)$/;F.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;F.longToHash=function(e){return e?F.LongBits.from(e).toHash():F.LongBits.zeroHash};F.longFromHash=function(e,r){var n=F.LongBits.fromHash(e);return F.Long?F.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function tf(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}F.merge=tf;F.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ef(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&tf(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}F.newError=ef;F.ProtocolError=ef("ProtocolError");F.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};F.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};F.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};F._configure=function(){var t=F.Buffer;if(!t){F._Buffer_from=F._Buffer_allocUnsafe=null;return}F._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},F._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Mo=z((Yg,sf)=>{"use strict";sf.exports=At;var oe=ur(),Oo,of=oe.LongBits,Op=oe.utf8;function ae(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function At(t){this.buf=t,this.pos=0,this.len=t.length}var rf=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new At(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new At(e);throw Error("illegal buffer")},af=function(){return oe.Buffer?function(r){return(At.create=function(i){return oe.Buffer.isBuffer(i)?new Oo(i):rf(i)})(r)}:rf};At.create=af();At.prototype._slice=oe.Array.prototype.subarray||oe.Array.prototype.slice;At.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ae(this,10);return e}}();At.prototype.int32=function(){return this.uint32()|0};At.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Uo(){var t=new of(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ae(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw ae(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}At.prototype.bool=function(){return this.uint32()!==0};function li(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}At.prototype.fixed32=function(){if(this.pos+4>this.len)throw ae(this,4);return li(this.buf,this.pos+=4)};At.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ae(this,4);return li(this.buf,this.pos+=4)|0};function nf(){if(this.pos+8>this.len)throw ae(this,8);return new of(li(this.buf,this.pos+=4),li(this.buf,this.pos+=4))}At.prototype.float=function(){if(this.pos+4>this.len)throw ae(this,4);var e=oe.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};At.prototype.double=function(){if(this.pos+8>this.len)throw ae(this,4);var e=oe.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};At.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ae(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var i=oe.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};At.prototype.string=function(){var e=this.bytes();return Op.read(e,0,e.length)};At.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ae(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ae(this);while(this.buf[this.pos++]&128);return this};At.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};At._configure=function(t){Oo=t,At.create=af(),Oo._configure();var e=oe.Long?"toLong":"toNumber";oe.merge(At.prototype,{int64:function(){return Uo.call(this)[e](!1)},uint64:function(){return Uo.call(this)[e](!0)},sint64:function(){return Uo.call(this).zzDecode()[e](!1)},fixed64:function(){return nf.call(this)[e](!0)},sfixed64:function(){return nf.call(this)[e](!1)}})}});var lf=z((Wg,uf)=>{"use strict";uf.exports=lr;var cf=Mo();(lr.prototype=Object.create(cf.prototype)).constructor=lr;var ff=ur();function lr(t){cf.call(this,t)}lr._configure=function(){ff.Buffer&&(lr.prototype._slice=ff.Buffer.prototype.slice)};lr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};lr._configure()});var Yo=z(($g,yf)=>{"use strict";yf.exports=it;var Jt=ur(),Fo,hi=Jt.LongBits,hf=Jt.base64,df=Jt.utf8;function dn(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function qo(){}function Mp(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function it(){this.len=0,this.head=new dn(qo,0,0),this.tail=this.head,this.states=null}var pf=function(){return Jt.Buffer?function(){return(it.create=function(){return new Fo})()}:function(){return new it}};it.create=pf();it.alloc=function(e){return new Jt.Array(e)};Jt.Array!==Array&&(it.alloc=Jt.pool(it.alloc,Jt.Array.prototype.subarray));it.prototype._push=function(e,r,n){return this.tail=this.tail.next=new dn(e,r,n),this.len+=r,this};function Ho(t,e,r){e[r]=t&255}function Fp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function zo(t,e){this.len=t,this.next=void 0,this.val=e}zo.prototype=Object.create(dn.prototype);zo.prototype.fn=Fp;it.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new zo((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};it.prototype.int32=function(e){return e<0?this._push(Go,10,hi.fromNumber(e)):this.uint32(e)};it.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Go(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}it.prototype.uint64=function(e){var r=hi.from(e);return this._push(Go,r.length(),r)};it.prototype.int64=it.prototype.uint64;it.prototype.sint64=function(e){var r=hi.from(e).zzEncode();return this._push(Go,r.length(),r)};it.prototype.bool=function(e){return this._push(Ho,1,e?1:0)};function Vo(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}it.prototype.fixed32=function(e){return this._push(Vo,4,e>>>0)};it.prototype.sfixed32=it.prototype.fixed32;it.prototype.fixed64=function(e){var r=hi.from(e);return this._push(Vo,4,r.lo)._push(Vo,4,r.hi)};it.prototype.sfixed64=it.prototype.fixed64;it.prototype.float=function(e){return this._push(Jt.float.writeFloatLE,4,e)};it.prototype.double=function(e){return this._push(Jt.float.writeDoubleLE,8,e)};var Vp=Jt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};it.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ho,1,0);if(Jt.isString(e)){var n=it.alloc(r=hf.length(e));hf.decode(e,n,0),e=n}return this.uint32(r)._push(Vp,r,e)};it.prototype.string=function(e){var r=df.length(e);return r?this.uint32(r)._push(df.write,r,e):this._push(Ho,1,0)};it.prototype.fork=function(){return this.states=new Mp(this),this.head=this.tail=new dn(qo,0,0),this.len=0,this};it.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new dn(qo,0,0),this.len=0),this};it.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};it.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};it._configure=function(t){Fo=t,it.create=pf(),Fo._configure()}});var mf=z((Zg,xf)=>{"use strict";xf.exports=ge;var gf=Yo();(ge.prototype=Object.create(gf.prototype)).constructor=ge;var We=ur();function ge(){gf.call(this)}ge._configure=function(){ge.alloc=We._Buffer_allocUnsafe,ge.writeBytesBuffer=We.Buffer&&We.Buffer.prototype instanceof Uint8Array&&We.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};ge.prototype.bytes=function(e){We.isString(e)&&(e=We._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(ge.writeBytesBuffer,r,e),this};function qp(t,e,r){t.length<40?We.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}ge.prototype.string=function(e){var r=We.Buffer.byteLength(e);return this.uint32(r),r&&this._push(qp,r,e),this};ge._configure()});var Lf=z((Hx,Rf)=>{var gt=ft();er();Bt();var yn=Rf.exports=gt.sha512=gt.sha512||{};gt.md.sha512=gt.md.algorithms.sha512=yn;var If=gt.sha384=gt.sha512.sha384=gt.sha512.sha384||{};If.create=function(){return yn.create("SHA-384")};gt.md.sha384=gt.md.algorithms.sha384=If;gt.sha512.sha256=gt.sha512.sha256||{create:function(){return yn.create("SHA-512/256")}};gt.md["sha512/256"]=gt.md.algorithms["sha512/256"]=gt.sha512.sha256;gt.sha512.sha224=gt.sha512.sha224||{create:function(){return yn.create("SHA-512/224")}};gt.md["sha512/224"]=gt.md.algorithms["sha512/224"]=gt.sha512.sha224;yn.create=function(t){if(Tf||Xp(),typeof t>"u"&&(t="SHA-512"),!(t in dr))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=dr[t],r=null,n=gt.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,c=0;c<f;++c)a.fullMessageLength.push(0);n=gt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return a},a.start(),a.update=function(f,c){c==="utf8"&&(f=gt.util.encodeUtf8(f));var u=f.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=u[1],u[1]=u[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),_f(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=gt.util.createBuffer();f.putBytes(n.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=c&a.blockLength-1;f.putBytes(ta.substr(0,a.blockLength-u));for(var l,h,g=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)l=a.fullMessageLength[d+1]*8,h=l/4294967296>>>0,g+=h,f.putInt32(g>>>0),g=l>>>0;f.putInt32(g);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);_f(p,i,f);var y=gt.util.createBuffer(),m;t==="SHA-512"?m=p.length:t==="SHA-384"?m=p.length-2:m=p.length-4;for(var d=0;d<m;++d)y.putInt32(p[d][0]),(d!==m-1||t!=="SHA-512/224")&&y.putInt32(p[d][1]);return y},a};var ta=null,Tf=!1,ea=null,dr=null;function Xp(){ta=String.fromCharCode(128),ta+=gt.util.fillString(String.fromCharCode(0),128),ea=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],dr={},dr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],dr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],dr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],dr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Tf=!0}function _f(t,e,r){for(var n,i,o,s,a,f,c,u,l,h,g,d,p,y,m,E,b,T,w,S,L,N,G,Y,q,J,ct,Pt,_,k,R,D,A,O,M,H=r.length();H>=128;){for(_=0;_<16;++_)e[_][0]=r.getInt32()>>>0,e[_][1]=r.getInt32()>>>0;for(;_<80;++_)D=e[_-2],k=D[0],R=D[1],n=((k>>>19|R<<13)^(R>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|R>>>19)^(R<<3|k>>>29)^(k<<26|R>>>6))>>>0,O=e[_-15],k=O[0],R=O[1],o=((k>>>1|R<<31)^(k>>>8|R<<24)^k>>>7)>>>0,s=((k<<31|R>>>1)^(k<<24|R>>>8)^(k<<25|R>>>7))>>>0,A=e[_-7],M=e[_-16],R=i+A[1]+s+M[1],e[_][0]=n+A[0]+o+M[0]+(R/4294967296>>>0)>>>0,e[_][1]=R>>>0;for(p=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],T=t[2][1],w=t[3][0],S=t[3][1],L=t[4][0],N=t[4][1],G=t[5][0],Y=t[5][1],q=t[6][0],J=t[6][1],ct=t[7][0],Pt=t[7][1],_=0;_<80;++_)c=((L>>>14|N<<18)^(L>>>18|N<<14)^(N>>>9|L<<23))>>>0,u=((L<<18|N>>>14)^(L<<14|N>>>18)^(N<<23|L>>>9))>>>0,l=(q^L&(G^q))>>>0,h=(J^N&(Y^J))>>>0,a=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,f=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,g=(p&m|b&(p^m))>>>0,d=(y&E|T&(y^E))>>>0,R=Pt+u+h+ea[_][1]+e[_][1],n=ct+c+l+ea[_][0]+e[_][0]+(R/4294967296>>>0)>>>0,i=R>>>0,R=f+d,o=a+g+(R/4294967296>>>0)>>>0,s=R>>>0,ct=q,Pt=J,q=G,J=Y,G=L,Y=N,R=S+i,L=w+n+(R/4294967296>>>0)>>>0,N=R>>>0,w=b,S=T,b=m,T=E,m=p,E=y,R=i+s,p=n+o+(R/4294967296>>>0)>>>0,y=R>>>0;R=t[0][1]+y,t[0][0]=t[0][0]+p+(R/4294967296>>>0)>>>0,t[0][1]=R>>>0,R=t[1][1]+E,t[1][0]=t[1][0]+m+(R/4294967296>>>0)>>>0,t[1][1]=R>>>0,R=t[2][1]+T,t[2][0]=t[2][0]+b+(R/4294967296>>>0)>>>0,t[2][1]=R>>>0,R=t[3][1]+S,t[3][0]=t[3][0]+w+(R/4294967296>>>0)>>>0,t[3][1]=R>>>0,R=t[4][1]+N,t[4][0]=t[4][0]+L+(R/4294967296>>>0)>>>0,t[4][1]=R>>>0,R=t[5][1]+Y,t[5][0]=t[5][0]+G+(R/4294967296>>>0)>>>0,t[5][1]=R>>>0,R=t[6][1]+J,t[6][0]=t[6][0]+q+(R/4294967296>>>0)>>>0,t[6][1]=R>>>0,R=t[7][1]+Pt,t[7][0]=t[7][0]+ct+(R/4294967296>>>0)>>>0,t[7][1]=R>>>0,H-=128}}});var sc=z((iv,ac)=>{var Hr=1e3,zr=Hr*60,Gr=zr*60,xr=Gr*24,Ay=xr*7,Cy=xr*365.25;ac.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return _y(t);if(r==="number"&&isFinite(t))return e.long?Ty(t):Iy(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function _y(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Cy;case"weeks":case"week":case"w":return r*Ay;case"days":case"day":case"d":return r*xr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Gr;case"minutes":case"minute":case"mins":case"min":case"m":return r*zr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Hr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Iy(t){var e=Math.abs(t);return e>=xr?Math.round(t/xr)+"d":e>=Gr?Math.round(t/Gr)+"h":e>=zr?Math.round(t/zr)+"m":e>=Hr?Math.round(t/Hr)+"s":t+"ms"}function Ty(t){var e=Math.abs(t);return e>=xr?Ei(t,e,xr,"day"):e>=Gr?Ei(t,e,Gr,"hour"):e>=zr?Ei(t,e,zr,"minute"):e>=Hr?Ei(t,e,Hr,"second"):t+" ms"}function Ei(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var cc=z((ov,fc)=>{function Ry(t){r.debug=r,r.default=r,r.coerce=f,r.disable=o,r.enable=i,r.enabled=s,r.humanize=sc(),r.destroy=c,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let l=0;for(let h=0;h<u.length;h++)l=(l<<5)-l+u.charCodeAt(h),l|=0;return r.colors[Math.abs(l)%r.colors.length]}r.selectColor=e;function r(u){let l,h=null,g,d;function p(...y){if(!p.enabled)return;let m=p,E=Number(new Date),b=E-(l||E);m.diff=b,m.prev=l,m.curr=E,l=E,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let T=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(S,L)=>{if(S==="%%")return"%";T++;let N=r.formatters[L];if(typeof N=="function"){let G=y[T];S=N.call(m,G),y.splice(T,1),T--}return S}),r.formatArgs.call(m,y),(m.log||r.log).apply(m,y)}return p.namespace=u,p.useColors=r.useColors(),p.color=r.selectColor(u),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(g!==r.namespaces&&(g=r.namespaces,d=r.enabled(u)),d),set:y=>{h=y}}),typeof r.init=="function"&&r.init(p),p}function n(u,l){let h=r(this.namespace+(typeof l>"u"?":":l)+u);return h.log=this.log,h}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let l,h=(typeof u=="string"?u:"").split(/[\s,]+/),g=h.length;for(l=0;l<g;l++)h[l]&&(u=h[l].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...r.names.map(a),...r.skips.map(a).map(l=>"-"+l)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let l,h;for(l=0,h=r.skips.length;l<h;l++)if(r.skips[l].test(u))return!1;for(l=0,h=r.names.length;l<h;l++)if(r.names[l].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function f(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}fc.exports=Ry});var uc=z(($t,wi)=>{$t.formatArgs=Ny;$t.save=Dy;$t.load=ky;$t.useColors=Ly;$t.storage=Py();$t.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();$t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Ly(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Ny(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+wi.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}$t.log=console.debug||console.log||(()=>{});function Dy(t){try{t?$t.storage.setItem("debug",t):$t.storage.removeItem("debug")}catch{}}function ky(){let t;try{t=$t.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Py(){try{return localStorage}catch{}}wi.exports=cc()($t);var{formatters:Ky}=wi.exports;Ky.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var vc=z((Av,mc)=>{"use strict";mc.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Ac=z((Sc,Bc)=>{"use strict";var Bi=vc(),{hasOwnProperty:Ec}=Object.prototype,{propertyIsEnumerable:Gy}=Object,Zr=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),Yy=Sc,bc={concatArrays:!1,ignoreUndefined:!1},Ai=t=>{let e=[];for(let r in t)Ec.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)Gy.call(t,n)&&e.push(n)}return e};function Qr(t){return Array.isArray(t)?Wy(t):Bi(t)?$y(t):t}function Wy(t){let e=t.slice(0,0);return Ai(t).forEach(r=>{Zr(e,r,Qr(t[r]))}),e}function $y(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Ai(t).forEach(r=>{Zr(e,r,Qr(t[r]))}),e}var wc=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]>"u"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?Zr(t,i,pa(t[i],e[i],n)):Zr(t,i,Qr(e[i])))}),t),Zy=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(o=>{let s=[];for(let a=0;a<o.length;a++)Ec.call(o,a)&&(s.push(String(a)),o===t?Zr(n,i++,o[a]):Zr(n,i++,Qr(o[a])));n=wc(n,o,Ai(o).filter(a=>!s.includes(a)),r)}),n};function pa(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?Zy(t,e,r):!Bi(e)||!Bi(t)?Qr(e):wc(t,e,Ai(e),r)}Bc.exports=function(...t){let e=pa(Qr(bc),this!==Yy&&this||{},bc),r={_:{}};for(let n of t)if(n!==void 0){if(!Bi(n))throw new TypeError("`"+n+"` is not an Option Object");r=pa(r,{_:n},e)}return r._}});var Tc=z((_v,Ic)=>{"use strict";function Qy(t){return t>=55296&&t<=56319}function Xy(t){return t>=56320&&t<=57343}Ic.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,o=0,s,a,f=0;f<i;f+=1){if(s=r.charCodeAt(f),a=r[f],Qy(s)&&Xy(r.charCodeAt(f+1))&&(f+=1,a+=r[f]),o+=e(a),o===n)return r.slice(0,f+1);if(o>n)return r.slice(0,f-a.length+1)}return r}});var Lc=z((Iv,Rc)=>{"use strict";function Jy(t){return t>=55296&&t<=56319}function jy(t){return t>=56320&&t<=57343}Rc.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,o=null,s=0;s<r;s++)i=e.charCodeAt(s),jy(i)?o!=null&&Jy(o)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),o=i;return n}});var Dc=z((Tv,Nc)=>{"use strict";var t1=Tc(),e1=Lc();Nc.exports=t1.bind(null,e1)});var Kc=z((Rv,Pc)=>{"use strict";var r1=Dc(),n1=/[\/\?<>\\:\*\|"]/g,i1=/[\x00-\x1f\x80-\x9f]/g,o1=/^\.+$/,a1=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,s1=/[\. ]+$/;function kc(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(n1,e).replace(i1,e).replace(o1,e).replace(a1,e).replace(s1,e);return r1(r,255)}Pc.exports=function(t,e){var r=e&&e.replacement||"",n=kc(t,r);return r===""?n:kc(n,"")}});var c1={};Rt(c1,{DefaultKeyChain:()=>ga});var K=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var h2=pt(Rn(),1),ll=pt(ft(),1);function wr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var Hi={};Rt(Hi,{base10:()=>lu});function au(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,f=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,y=0,m=0,E=d.length;m!==E&&d[m]===0;)m++,p++;for(var b=(E-m)*u+1>>>0,T=new Uint8Array(b);m!==E;){for(var w=d[m],S=0,L=b-1;(w!==0||S<y)&&L!==-1;L--,S++)w+=256*T[L]>>>0,T[L]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");y=S,m++}for(var N=b-y;N!==b&&T[N]===0;)N++;for(var G=f.repeat(p);N<b;++N)G+=t.charAt(T[N]);return G}function h(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var y=0,m=0;d[p]===f;)y++,p++;for(var E=(d.length-p)*c+1>>>0,b=new Uint8Array(E);d[p];){var T=r[d.charCodeAt(p)];if(T===255)return;for(var w=0,S=E-1;(T!==0||w<m)&&S!==-1;S--,w++)T+=a*b[S]>>>0,b[S]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");m=w,p++}if(d[p]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var N=new Uint8Array(y+(E-L)),G=y;L!==E;)N[G++]=b[L++];return N}}}function g(d){var p=h(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:h,decode:g}}var su=au,fu=su,Fa=fu;var w1=new Uint8Array(0);var Va=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},be=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var qa=t=>new TextEncoder().encode(t),Ha=t=>new TextDecoder().decode(t);var Mi=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Fi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ga(this,e)}},Vi=class{constructor(e){this.decoders=e}or(e){return Ga(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ga=(t,e)=>new Vi({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),qi=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Mi(e,r,n),this.decoder=new Fi(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Sr=({name:t,prefix:e,encode:r,decode:n})=>new qi(t,e,r,n),Ue=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Fa(r,e);return Sr({prefix:t,name:e,encode:n,decode:o=>be(i(o))})},cu=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,f=0,c=0;for(let u=0;u<o;++u){let l=i[t[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|l,a+=r,a>=8&&(a-=8,s[c++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return s},uu=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},wt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Sr({prefix:e,name:t,encode(i){return uu(i,n,r)},decode(i){return cu(i,n,r,t)}});var lu=Ue({prefix:"9",name:"base10",alphabet:"0123456789"});var zi={};Rt(zi,{base16:()=>hu,base16upper:()=>du});var hu=wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),du=wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Gi={};Rt(Gi,{base2:()=>pu});var pu=wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Yi={};Rt(Yi,{base256emoji:()=>vu});var Ya=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),yu=Ya.reduce((t,e,r)=>(t[r]=e,t),[]),gu=Ya.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function xu(t){return t.reduce((e,r)=>(e+=yu[r],e),"")}function mu(t){let e=[];for(let r of t){let n=gu[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var vu=Sr({prefix:"\u{1F680}",name:"base256emoji",encode:xu,decode:mu});var Wi={};Rt(Wi,{base32:()=>Oe,base32hex:()=>Su,base32hexpad:()=>Au,base32hexpadupper:()=>Cu,base32hexupper:()=>Bu,base32pad:()=>Eu,base32padupper:()=>wu,base32upper:()=>bu,base32z:()=>_u});var Oe=wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bu=wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Eu=wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wu=wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Su=wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Bu=wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Au=wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Cu=wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_u=wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $i={};Rt($i,{base36:()=>Iu,base36upper:()=>Tu});var Iu=Ue({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Tu=Ue({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Zi={};Rt(Zi,{base58btc:()=>Ot,base58flickr:()=>Ru});var Ot=Ue({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ru=Ue({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Qi={};Rt(Qi,{base64:()=>je,base64pad:()=>Lu,base64url:()=>Nu,base64urlpad:()=>Du});var je=wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Lu=wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Nu=wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Du=wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Xi={};Rt(Xi,{base8:()=>ku});var ku=wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ji={};Rt(Ji,{identity:()=>Pu});var Pu=Sr({prefix:"\0",name:"identity",encode:t=>Ha(t),decode:t=>qa(t)});var U1=new TextEncoder,O1=new TextDecoder;var to={};Rt(to,{identity:()=>Me});var Ou=Za,Wa=128,Mu=127,Fu=~Mu,Vu=Math.pow(2,31);function Za(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Vu;)e[r++]=t&255|Wa,t/=128;for(;t&Fu;)e[r++]=t&255|Wa,t>>>=7;return e[r]=t|0,Za.bytes=r-n+1,e}var qu=ji,Hu=128,$a=127;function ji(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw ji.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&$a)<<i:(s&$a)*Math.pow(2,i),i+=7}while(s>=Hu);return ji.bytes=o-n,r}var zu=Math.pow(2,7),Gu=Math.pow(2,14),Yu=Math.pow(2,21),Wu=Math.pow(2,28),$u=Math.pow(2,35),Zu=Math.pow(2,42),Qu=Math.pow(2,49),Xu=Math.pow(2,56),Ju=Math.pow(2,63),ju=function(t){return t<zu?1:t<Gu?2:t<Yu?3:t<Wu?4:t<$u?5:t<Zu?6:t<Qu?7:t<Xu?8:t<Ju?9:10},tl={encode:Ou,decode:qu,encodingLength:ju},el=tl,jr=el;var tn=(t,e=0)=>[jr.decode(t,e),jr.decode.bytes],Br=(t,e,r=0)=>(jr.encode(t,e,r),e),Ar=t=>jr.encodingLength(t);var fe=(t,e)=>{let r=e.byteLength,n=Ar(t),i=n+Ar(r),o=new Uint8Array(i+r);return Br(t,o,0),Br(r,o,n),o.set(e,i),new Cr(t,r,e,o)},en=t=>{let e=be(t),[r,n]=tn(e),[i,o]=tn(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Cr(r,i,s,e)},Qa=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Va(t.bytes,r.bytes)}},Cr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Xa=0,rl="identity",Ja=be,nl=t=>fe(Xa,Ja(t)),Me={code:Xa,name:rl,encode:Ja,digest:nl};var no={};Rt(no,{sha256:()=>Mt,sha512:()=>il});var ro=({name:t,code:e,encode:r})=>new eo(t,e,r),eo=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?fe(this.code,r):r.then(n=>fe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var ts=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Mt=ro({name:"sha2-256",code:18,encode:ts("SHA-256")}),il=ro({name:"sha2-512",code:19,encode:ts("SHA-512")});var es=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return al(r,io(t),e||Ot.encoder);default:return sl(r,io(t),e||Oe.encoder)}};var rs=new WeakMap,io=t=>{let e=rs.get(t);if(e==null){let r=new Map;return rs.set(t,r),r}return e},tr=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==rn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==fl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=fe(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Qa(e.multihash,n.multihash)}toString(e){return es(this,e)}toJSON(){return{"/":es(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||ns(n,i,o.bytes))}else if(r[cl]===!0){let{version:n,multihash:i,code:o}=r,s=en(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==rn)throw new Error(`Version 0 CID must use dag-pb (code: ${rn}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=ns(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,rn,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=be(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new Cr(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[l,h]=tn(e.subarray(r));return r+=h,l},i=n(),o=rn;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:o,multihashCode:a,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=ol(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return io(o).set(n,e),o}},ol=(t,e)=>{switch(t[0]){case"Q":{let r=e||Ot;return[Ot.prefix,r.decode(`${Ot.prefix}${t}`)]}case Ot.prefix:{let r=e||Ot;return[Ot.prefix,r.decode(t)]}case Oe.prefix:{let r=e||Oe;return[Oe.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},al=(t,e,r)=>{let{prefix:n}=r;if(n!==Ot.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},sl=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},rn=112,fl=18,ns=(t,e,r)=>{let n=Ar(t),i=n+Ar(e),o=new Uint8Array(i+r.byteLength);return Br(t,o,0),Br(e,o,n),o.set(r,i),o},cl=Symbol.for("@ipld/js-cid/CID");var Ir={...Ji,...Gi,...Xi,...Hi,...zi,...Wi,...$i,...Zi,...Qi,...Yi},t2={...no,...to};function Nn(t=0){return globalThis.Buffer?.allocUnsafe!=null?wr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function os(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var is=os("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),oo=os("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Nn(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),ul={utf8:is,"utf-8":is,hex:Ir.base16,latin1:oo,ascii:oo,binary:oo,...Ir},Dn=ul;function ht(t,e="utf8"){let r=Dn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?wr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function xt(t,e="utf8"){let r=Dn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Ht={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Ym=pt(an(),1),Wm=pt(s0(),1);var bi=pt(ft(),1);var jo={};Rt(jo,{Ed25519PrivateKey:()=>hr,Ed25519PublicKey:()=>pn,generateKeyPair:()=>$p,generateKeyPairFromSeed:()=>Sf,unmarshalEd25519PrivateKey:()=>Yp,unmarshalEd25519PublicKey:()=>Wp});function Gt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function f0(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function mo(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function c0(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");f0(t.outputLen),f0(t.blockLen)}function Lr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function u0(t,e){mo(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var $n=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var l0=t=>t instanceof Uint8Array;var Zn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),re=(t,e)=>t<<32-e|t>>>e,Ld=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ld)throw new Error("Non little-endian hardware is not supported");function vo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function cn(t){if(typeof t=="string"&&(t=vo(t)),!l0(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Qn(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!l0(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var Nr=class{clone(){return this._cloneInto()}},W2={}.toString;function Xn(t){let e=n=>t().update(cn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Dr(t=32){if($n&&typeof $n.getRandomValues=="function")return $n.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Nd(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,a,n)}var kr=class extends Nr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Zn(this.buffer)}update(e){Lr(this);let{view:r,buffer:n,blockLen:i}=this;e=cn(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let f=Zn(e);for(;i<=o-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Lr(this),u0(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let l=s;l<i;l++)r[l]=0;Nd(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Zn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<c;l++)a.setUint32(4*l,u[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var Jn=BigInt(4294967295),bo=BigInt(32);function h0(t,e=!1){return e?{h:Number(t&Jn),l:Number(t>>bo&Jn)}:{h:Number(t>>bo&Jn)|0,l:Number(t&Jn)|0}}function Dd(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=h0(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var kd=(t,e)=>BigInt(t>>>0)<<bo|BigInt(e>>>0),Pd=(t,e,r)=>t>>>r,Kd=(t,e,r)=>t<<32-r|e>>>r,Ud=(t,e,r)=>t>>>r|e<<32-r,Od=(t,e,r)=>t<<32-r|e>>>r,Md=(t,e,r)=>t<<64-r|e>>>r-32,Fd=(t,e,r)=>t>>>r-32|e<<64-r,Vd=(t,e)=>e,qd=(t,e)=>t,Hd=(t,e,r)=>t<<r|e>>>32-r,zd=(t,e,r)=>e<<r|t>>>32-r,Gd=(t,e,r)=>e<<r-32|t>>>64-r,Yd=(t,e,r)=>t<<r-32|e>>>64-r;function Wd(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var $d=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Zd=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Qd=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Xd=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,Jd=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),jd=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;var tp={fromBig:h0,split:Dd,toBig:kd,shrSH:Pd,shrSL:Kd,rotrSH:Ud,rotrSL:Od,rotrBH:Md,rotrBL:Fd,rotr32H:Vd,rotr32L:qd,rotlSH:Hd,rotlSL:zd,rotlBH:Gd,rotlBL:Yd,add:Wd,add3L:$d,add3H:Zd,add4L:Qd,add4H:Xd,add5H:jd,add5L:Jd},Z=tp;var[ep,rp]=(()=>Z.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),qe=new Uint32Array(80),He=new Uint32Array(80),Eo=class extends kr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:f,Eh:c,El:u,Fh:l,Fl:h,Gh:g,Gl:d,Hh:p,Hl:y}=this;return[e,r,n,i,o,s,a,f,c,u,l,h,g,d,p,y]}set(e,r,n,i,o,s,a,f,c,u,l,h,g,d,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=l|0,this.Fl=h|0,this.Gh=g|0,this.Gl=d|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)qe[b]=e.getUint32(r),He[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let T=qe[b-15]|0,w=He[b-15]|0,S=Z.rotrSH(T,w,1)^Z.rotrSH(T,w,8)^Z.shrSH(T,w,7),L=Z.rotrSL(T,w,1)^Z.rotrSL(T,w,8)^Z.shrSL(T,w,7),N=qe[b-2]|0,G=He[b-2]|0,Y=Z.rotrSH(N,G,19)^Z.rotrBH(N,G,61)^Z.shrSH(N,G,6),q=Z.rotrSL(N,G,19)^Z.rotrBL(N,G,61)^Z.shrSL(N,G,6),J=Z.add4L(L,q,He[b-7],He[b-16]),ct=Z.add4H(J,S,Y,qe[b-7],qe[b-16]);qe[b]=ct|0,He[b]=J|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:f,Dh:c,Dl:u,Eh:l,El:h,Fh:g,Fl:d,Gh:p,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let T=Z.rotrSH(l,h,14)^Z.rotrSH(l,h,18)^Z.rotrBH(l,h,41),w=Z.rotrSL(l,h,14)^Z.rotrSL(l,h,18)^Z.rotrBL(l,h,41),S=l&g^~l&p,L=h&d^~h&y,N=Z.add5L(E,w,L,rp[b],He[b]),G=Z.add5H(N,m,T,S,ep[b],qe[b]),Y=N|0,q=Z.rotrSH(n,i,28)^Z.rotrBH(n,i,34)^Z.rotrBH(n,i,39),J=Z.rotrSL(n,i,28)^Z.rotrBL(n,i,34)^Z.rotrBL(n,i,39),ct=n&o^n&a^o&a,Pt=i&s^i&f^s&f;m=p|0,E=y|0,p=g|0,y=d|0,g=l|0,d=h|0,{h:l,l:h}=Z.add(c|0,u|0,G|0,Y|0),c=a|0,u=f|0,a=o|0,f=s|0,o=n|0,s=i|0;let _=Z.add3L(Y,J,Pt);n=Z.add3H(_,G,q,ct),i=_|0}({h:n,l:i}=Z.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=Z.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:f}=Z.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=Z.add(this.Dh|0,this.Dl|0,c|0,u|0),{h:l,l:h}=Z.add(this.Eh|0,this.El|0,l|0,h|0),{h:g,l:d}=Z.add(this.Fh|0,this.Fl|0,g|0,d|0),{h:p,l:y}=Z.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:m,l:E}=Z.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,o,s,a,f,c,u,l,h,g,d,p,y,m,E)}roundClean(){qe.fill(0),He.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var wo=Xn(()=>new Eo);var ei={};Rt(ei,{bitGet:()=>cp,bitLen:()=>fp,bitMask:()=>un,bitSet:()=>up,bytesToHex:()=>Be,bytesToNumberBE:()=>Ae,bytesToNumberLE:()=>ze,concatBytes:()=>Ce,createHmacDrbg:()=>Ao,ensureBytes:()=>St,equalBytes:()=>ap,hexToBytes:()=>or,hexToNumber:()=>Bo,numberToBytesBE:()=>Ge,numberToBytesLE:()=>ar,numberToHexUnpadded:()=>y0,numberToVarBytesBE:()=>op,utf8ToBytes:()=>sp,validateObject:()=>ye});var p0=BigInt(0),jn=BigInt(1),np=BigInt(2),ti=t=>t instanceof Uint8Array,ip=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Be(t){if(!ti(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=ip[t[r]];return e}function y0(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Bo(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function or(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function Ae(t){return Bo(Be(t))}function ze(t){if(!ti(t))throw new Error("Uint8Array expected");return Bo(Be(Uint8Array.from(t).reverse()))}function Ge(t,e){return or(t.toString(16).padStart(e*2,"0"))}function ar(t,e){return Ge(t,e).reverse()}function op(t){return or(y0(t))}function St(t,e,r){let n;if(typeof e=="string")try{n=or(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(ti(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Ce(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!ti(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function ap(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function sp(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function fp(t){let e;for(e=0;t>p0;t>>=jn,e+=1);return e}function cp(t,e){return t>>BigInt(e)&jn}var up=(t,e,r)=>t|(r?jn:p0)<<BigInt(e),un=t=>(np<<BigInt(t-1))-jn,So=t=>new Uint8Array(t),d0=t=>Uint8Array.from(t);function Ao(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=So(t),i=So(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...l)=>r(i,n,...l),f=(l=So())=>{i=a(d0([0]),l),n=a(),l.length!==0&&(i=a(d0([1]),l),n=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,h=[];for(;l<e;){n=a();let g=n.slice();h.push(g),l+=n.length}return Ce(...h)};return(l,h)=>{s(),f(l);let g;for(;!(g=h(c()));)f();return s(),g}}var lp={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ye(t,e,r={}){let n=(i,o,s)=>{let a=lp[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!a(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var Tt=BigInt(0),vt=BigInt(1),sr=BigInt(2),hp=BigInt(3),Co=BigInt(4),g0=BigInt(5),x0=BigInt(8),dp=BigInt(9),pp=BigInt(16);function ut(t,e){let r=t%e;return r>=Tt?r:e+r}function yp(t,e,r){if(r<=Tt||e<Tt)throw new Error("Expected power/modulo > 0");if(r===vt)return Tt;let n=vt;for(;e>Tt;)e&vt&&(n=n*t%r),t=t*t%r,e>>=vt;return n}function bt(t,e,r){let n=t;for(;e-- >Tt;)n*=n,n%=r;return n}function ri(t,e){if(t===Tt||e<=Tt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ut(t,e),n=e,i=Tt,o=vt,s=vt,a=Tt;for(;r!==Tt;){let c=n/r,u=n%r,l=i-s*c,h=o-a*c;n=r,r=u,i=s,o=a,s=l,a=h}if(n!==vt)throw new Error("invert: does not exist");return ut(i,e)}function gp(t){let e=(t-vt)/sr,r,n,i;for(r=t-vt,n=0;r%sr===Tt;r/=sr,n++);for(i=sr;i<t&&yp(i,e,t)!==t-vt;i++);if(n===1){let s=(t+vt)/Co;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let o=(r+vt)/sr;return function(a,f){if(a.pow(f,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=n,u=a.pow(a.mul(a.ONE,i),r),l=a.pow(f,o),h=a.pow(f,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let g=1;for(let p=a.sqr(h);g<c&&!a.eql(p,a.ONE);g++)p=a.sqr(p);let d=a.pow(u,vt<<BigInt(c-g-1));u=a.sqr(d),l=a.mul(l,d),h=a.mul(h,u),c=g}return l}}function xp(t){if(t%Co===hp){let e=(t+vt)/Co;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%x0===g0){let e=(t-g0)/x0;return function(n,i){let o=n.mul(i,sr),s=n.pow(o,e),a=n.mul(i,s),f=n.mul(n.mul(a,sr),s),c=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%pp,gp(t)}var m0=(t,e)=>(ut(t,e)&vt)===vt,mp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function _o(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=mp.reduce((n,i)=>(n[i]="function",n),e);return ye(t,r)}function vp(t,e,r){if(r<Tt)throw new Error("Expected power > 0");if(r===Tt)return t.ONE;if(r===vt)return e;let n=t.ONE,i=e;for(;r>Tt;)r&vt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=vt;return n}function bp(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function Io(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ni(t,e,r=!1,n={}){if(t<=Tt)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=Io(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=xp(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:un(i),ZERO:Tt,ONE:vt,create:f=>ut(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return Tt<=f&&f<t},is0:f=>f===Tt,isOdd:f=>(f&vt)===vt,neg:f=>ut(-f,t),eql:(f,c)=>f===c,sqr:f=>ut(f*f,t),add:(f,c)=>ut(f+c,t),sub:(f,c)=>ut(f-c,t),mul:(f,c)=>ut(f*c,t),pow:(f,c)=>vp(a,f,c),div:(f,c)=>ut(f*ri(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>ri(f,t),sqrt:n.sqrt||(f=>s(a,f)),invertBatch:f=>bp(a,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?ar(f,o):Ge(f,o),fromBytes:f=>{if(f.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${f.length}`);return r?ze(f):Ae(f)}});return Object.freeze(a)}function v0(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function b0(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function To(t){let e=b0(t);return e+Math.ceil(e/2)}function E0(t,e,r=!1){let n=t.length,i=b0(e),o=To(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?Ae(t):ze(t),a=ut(s,e-vt)+vt;return r?ar(a,i):Ge(a,i)}var wp=BigInt(0),Ro=BigInt(1);function ii(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>wp;)o&Ro&&(s=s.add(a)),a=a.double(),o>>=Ro;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),f=[],c=i,u=c;for(let l=0;l<s;l++){u=c,f.push(u);for(let h=1;h<a;h++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,o,s){let{windows:a,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,l=BigInt(2**i-1),h=2**i,g=BigInt(i);for(let d=0;d<a;d++){let p=d*f,y=Number(s&l);s>>=g,y>f&&(y-=h,s+=Ro);let m=p,E=p+Math.abs(y)-1,b=d%2!==0,T=y<0;y===0?u=u.add(r(b,o[m])):c=c.add(r(T,o[E]))}return{p:c,f:u}},wNAFCached(i,o,s,a){let f=i._WINDOW_SIZE||1,c=o.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&o.set(i,a(c))),this.wNAF(f,c,s)}}}function ln(t){return _o(t.Fp),ye(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Io(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var ne=BigInt(0),Yt=BigInt(1),oi=BigInt(2),Sp=BigInt(8),Bp={zip215:!0};function Ap(t){let e=ln(t);return ye(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function ai(t){let e=Ap(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:f}=e,c=oi<<BigInt(a*8)-Yt,u=r.create,l=e.uvRatio||((D,A)=>{try{return{isValid:!0,value:r.sqrt(D*r.inv(A))}}catch{return{isValid:!1,value:ne}}}),h=e.adjustScalarBytes||(D=>D),g=e.domain||((D,A,O)=>{if(A.length||O)throw new Error("Contexts/pre-hash are not supported");return D}),d=D=>typeof D=="bigint"&&ne<D,p=(D,A)=>d(D)&&d(A)&&D<A,y=D=>D===ne||p(D,c);function m(D,A){if(p(D,A))return D;throw new Error(`Expected valid scalar < ${A}, got ${typeof D} ${D}`)}function E(D){return D===ne?D:m(D,n)}let b=new Map;function T(D){if(!(D instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,O,M,H){if(this.ex=A,this.ey=O,this.ez=M,this.et=H,!y(A))throw new Error("x required");if(!y(O))throw new Error("y required");if(!y(M))throw new Error("z required");if(!y(H))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:O,y:M}=A||{};if(!y(O)||!y(M))throw new Error("invalid affine point");return new w(O,M,Yt,u(O*M))}static normalizeZ(A){let O=r.invertBatch(A.map(M=>M.ez));return A.map((M,H)=>M.toAffine(O[H])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:O}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:M,ey:H,ez:Q,et:j}=this,st=u(M*M),tt=u(H*H),ot=u(Q*Q),_t=u(ot*ot),Et=u(st*A),Kt=u(ot*u(Et+tt)),Ut=u(_t+u(O*u(st*tt)));if(Kt!==Ut)throw new Error("bad point: equation left != right (1)");let It=u(M*H),Ft=u(Q*j);if(It!==Ft)throw new Error("bad point: equation left != right (2)")}equals(A){T(A);let{ex:O,ey:M,ez:H}=this,{ex:Q,ey:j,ez:st}=A,tt=u(O*st),ot=u(Q*H),_t=u(M*st),Et=u(j*H);return tt===ot&&_t===Et}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:O,ey:M,ez:H}=this,Q=u(O*O),j=u(M*M),st=u(oi*u(H*H)),tt=u(A*Q),ot=O+M,_t=u(u(ot*ot)-Q-j),Et=tt+j,Kt=Et-st,Ut=tt-j,It=u(_t*Kt),Ft=u(Et*Ut),ve=u(_t*Ut),Xe=u(Kt*Et);return new w(It,Ft,Xe,ve)}add(A){T(A);let{a:O,d:M}=e,{ex:H,ey:Q,ez:j,et:st}=this,{ex:tt,ey:ot,ez:_t,et:Et}=A;if(O===BigInt(-1)){let ma=u((Q-H)*(ot+tt)),va=u((Q+H)*(ot-tt)),_i=u(va-ma);if(_i===ne)return this.double();let ba=u(j*oi*Et),Ea=u(st*oi*_t),wa=Ea+ba,Sa=va+ma,Ba=Ea-ba,Hc=u(wa*_i),zc=u(Sa*Ba),Gc=u(wa*Ba),Yc=u(_i*Sa);return new w(Hc,zc,Yc,Gc)}let Kt=u(H*tt),Ut=u(Q*ot),It=u(st*M*Et),Ft=u(j*_t),ve=u((H+Q)*(tt+ot)-Kt-Ut),Xe=Ft-It,Xr=Ft+It,xa=u(Ut-O*Kt),Mc=u(ve*Xe),Fc=u(Xr*xa),Vc=u(ve*xa),qc=u(Xe*Xr);return new w(Mc,Fc,qc,Vc)}subtract(A){return this.add(A.negate())}wNAF(A){return N.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:O,f:M}=this.wNAF(m(A,n));return w.normalizeZ([O,M])[0]}multiplyUnsafe(A){let O=E(A);return O===ne?L:this.equals(L)||O===Yt?this:this.equals(S)?this.wNAF(O).p:N.unsafeLadder(this,O)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return N.unsafeLadder(this,n).is0()}toAffine(A){let{ex:O,ey:M,ez:H}=this,Q=this.is0();A==null&&(A=Q?Sp:r.inv(H));let j=u(O*A),st=u(M*A),tt=u(H*A);if(Q)return{x:ne,y:Yt};if(tt!==Yt)throw new Error("invZ was invalid");return{x:j,y:st}}clearCofactor(){let{h:A}=e;return A===Yt?this:this.multiplyUnsafe(A)}static fromHex(A,O=!1){let{d:M,a:H}=e,Q=r.BYTES;A=St("pointHex",A,Q);let j=A.slice(),st=A[Q-1];j[Q-1]=st&-129;let tt=ze(j);tt===ne||(O?m(tt,c):m(tt,r.ORDER));let ot=u(tt*tt),_t=u(ot-Yt),Et=u(M*ot-H),{isValid:Kt,value:Ut}=l(_t,Et);if(!Kt)throw new Error("Point.fromHex: invalid y coordinate");let It=(Ut&Yt)===Yt,Ft=(st&128)!==0;if(!O&&Ut===ne&&Ft)throw new Error("Point.fromHex: x=0 and x_0=1");return Ft!==It&&(Ut=u(-Ut)),w.fromAffine({x:Ut,y:tt})}static fromPrivateKey(A){return q(A).point}toRawBytes(){let{x:A,y:O}=this.toAffine(),M=ar(O,r.BYTES);return M[M.length-1]|=A&Yt?128:0,M}toHex(){return Be(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Yt,u(e.Gx*e.Gy)),w.ZERO=new w(ne,Yt,Yt,ne);let{BASE:S,ZERO:L}=w,N=ii(w,a*8);function G(D){return ut(D,n)}function Y(D){return G(ze(D))}function q(D){let A=a;D=St("private key",D,A);let O=St("hashed private key",o(D),2*A),M=h(O.slice(0,A)),H=O.slice(A,2*A),Q=Y(M),j=S.multiply(Q),st=j.toRawBytes();return{head:M,prefix:H,scalar:Q,point:j,pointBytes:st}}function J(D){return q(D).pointBytes}function ct(D=new Uint8Array,...A){let O=Ce(...A);return Y(o(g(O,St("context",D),!!i)))}function Pt(D,A,O={}){D=St("message",D),i&&(D=i(D));let{prefix:M,scalar:H,pointBytes:Q}=q(A),j=ct(O.context,M,D),st=S.multiply(j).toRawBytes(),tt=ct(O.context,st,Q,D),ot=G(j+tt*H);E(ot);let _t=Ce(st,ar(ot,r.BYTES));return St("result",_t,a*2)}let _=Bp;function k(D,A,O,M=_){let{context:H,zip215:Q}=M,j=r.BYTES;D=St("signature",D,2*j),A=St("message",A),i&&(A=i(A));let st=ze(D.slice(j,2*j)),tt,ot,_t;try{tt=w.fromHex(O,Q),ot=w.fromHex(D.slice(0,j),Q),_t=S.multiplyUnsafe(st)}catch{return!1}if(!Q&&tt.isSmallOrder())return!1;let Et=ct(H,ot.toRawBytes(),tt.toRawBytes(),A);return ot.add(tt.multiplyUnsafe(Et)).subtract(_t).clearCofactor().equals(w.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:J,sign:Pt,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:q,randomPrivateKey:()=>s(r.BYTES),precompute(D=8,A=w.BASE){return A._setWindowSize(D),A.multiply(BigInt(3)),A}}}}var No=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),w0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),yg=BigInt(0),Cp=BigInt(1),Lo=BigInt(2),_p=BigInt(5),S0=BigInt(10),Ip=BigInt(20),Tp=BigInt(40),B0=BigInt(80);function Rp(t){let e=No,n=t*t%e*t%e,i=bt(n,Lo,e)*n%e,o=bt(i,Cp,e)*t%e,s=bt(o,_p,e)*o%e,a=bt(s,S0,e)*s%e,f=bt(a,Ip,e)*a%e,c=bt(f,Tp,e)*f%e,u=bt(c,B0,e)*c%e,l=bt(u,B0,e)*c%e,h=bt(l,S0,e)*s%e;return{pow_p_5_8:bt(h,Lo,e)*t%e,b2:n}}function Lp(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Np(t,e){let r=No,n=ut(e*e*e,r),i=ut(n*n*e,r),o=Rp(t*i).pow_p_5_8,s=ut(t*n*o,r),a=ut(e*s*s,r),f=s,c=ut(s*w0,r),u=a===t,l=a===ut(-t,r),h=a===ut(-t*w0,r);return u&&(s=f),(l||h)&&(s=c),m0(s,r)&&(s=ut(-s,r)),{isValid:u||l,value:s}}var _e=ni(No,void 0,!0),Do={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:_e,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:wo,randomBytes:Dr,adjustScalarBytes:Lp,uvRatio:Np},Pr=ai(Do);function A0(t,e,r){if(e.length>255)throw new Error("Context is too big");return Qn(vo("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var gg=ai({...Do,domain:A0}),xg=ai({...Do,domain:A0,prehash:wo});var Dp=(_e.ORDER+BigInt(3))/BigInt(8),mg=_e.pow(Lo,Dp),vg=_e.sqrt(_e.neg(_e.ONE)),bg=(_e.ORDER-BigInt(5))/BigInt(8),Eg=BigInt(486662);var wg=v0(_e,_e.neg(BigInt(486664)));var Sg=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Bg=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Ag=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Cg=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var _g=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Kr=32,Ie=64,si=32;async function C0(){let t=Pr.utils.randomPrivateKey(),e=Pr.getPublicKey(t);return{privateKey:R0(t,e),publicKey:e}}async function _0(t){if(t.length!==si)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Pr.getPublicKey(e);return{privateKey:R0(e,r),publicKey:r}}async function I0(t,e){let r=t.subarray(0,si);return Pr.sign(e,r)}async function T0(t,e,r){return Pr.verify(e,r,t)}function R0(t,e){let r=new Uint8Array(Ie);for(let n=0;n<si;n++)r[n]=t[n],r[si+n]=e[n];return r}function fr(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=Nn(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return wr(r)}var ko={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function fi(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=Ht.get();r*=8;async function f(l,h){let g=a.getRandomValues(new Uint8Array(o)),d=a.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof h=="string"&&(h=ht(h));let y;if(h.length===0){y=await a.subtle.importKey("jwk",ko,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",ko,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(p,y,l);return fr([g,p.iv,new Uint8Array(m)])}async function c(l,h){let g=l.subarray(0,o),d=l.subarray(o,o+n),p=l.subarray(o+n),y={name:e,iv:d};typeof h=="string"&&(h=ht(h));let m;if(h.length===0)try{let b={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},T=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,T,{name:e,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",ko,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},T=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,T,{name:e,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(y,m,p);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function Ur(t,e){let n=await fi().encrypt(t,e);return je.encode(n)}var Wo=pt(Mo(),1),vf=pt(lf(),1),bf=pt(ur(),1),$o=pt(Yo(),1),Ef=pt(mf(),1);function Hp(){bf.default._configure(),Wo.default._configure(vf.default),$o.default._configure(Ef.default)}Hp();var wf=["uint64","int64","sint64","fixed64","sfixed64"];function zp(t){for(let e of wf){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Zo(t){return zp(new Wo.default(t))}function Gp(t){for(let e of wf){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Qo(){return Gp($o.default.create())}function di(t,e){let r=Zo(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function pi(t,e){let r=Qo();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Mr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Mr||(Mr={}));function yi(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Xo(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return yi("enum",Mr.VARINT,r,n)}function gi(t,e){return yi("message",Mr.LENGTH_DELIMITED,t,e)}var Ct;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(Ct||(Ct={}));var Jo;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Jo||(Jo={}));(function(t){t.codec=()=>Xo(Jo)})(Ct||(Ct={}));var Te;(function(t){let e;t.codec=()=>(e==null&&(e=gi((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=Ct.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>pi(r,t.codec()),t.decode=r=>di(r,t.codec())})(Te||(Te={}));var xe;(function(t){let e;t.codec=()=>(e==null&&(e=gi((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=Ct.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>pi(r,t.codec()),t.decode=r=>di(r,t.codec())})(xe||(xe={}));var pn=class{_key;constructor(e){this._key=Fr(e,Kr)}async verify(e,r){return T0(this._key,r,e)}marshal(){return this._key}get bytes(){return Te.encode({Type:Ct.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}},hr=class{_key;_publicKey;constructor(e,r){this._key=Fr(e,Ie),this._publicKey=Fr(r,Kr)}async sign(e){return I0(this._key,e)}get public(){return new pn(this._publicKey)}marshal(){return this._key}get bytes(){return xe.encode({Type:Ct.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}async id(){let e=Me.digest(this.public.bytes);return Ot.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Ur(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Yp(t){if(t.length>Ie){t=Fr(t,Ie+Kr);let n=t.subarray(0,Ie),i=t.subarray(Ie,t.length);return new hr(n,i)}t=Fr(t,Ie);let e=t.subarray(0,Ie),r=t.subarray(Kr);return new hr(e,r)}function Wp(t){return t=Fr(t,Kr),new pn(t)}async function $p(){let{privateKey:t,publicKey:e}=await C0();return new hr(t,e)}async function Sf(t){let{privateKey:e,publicKey:r}=await _0(t);return new hr(e,r)}function Fr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new K(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var vx=pt(Bt(),1),bx=pt(zn(),1),Bf=pt(ft(),1);function se(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=fr([new Uint8Array(e-r.length),r])}return xt(r,"base64url")}function Wt(t){let e=Af(t);return new Bf.default.jsbn.BigInteger(xt(e,"base16"),16)}function Af(t,e){let r=ht(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=fr([new Uint8Array(e-r.length),r])}return r}var Zp={"P-256":256,"P-384":384,"P-521":521},Qp=Object.keys(Zp),Lx=Qp.join(" / ");async function Cf(t,e){let r=je.decode(t);return fi().decrypt(r,e)}var ia={};Rt(ia,{MAX_KEY_SIZE:()=>mn,RsaPrivateKey:()=>Vr,RsaPublicKey:()=>xn,fromJwk:()=>ay,generateKeyPair:()=>sy,unmarshalRsaPrivateKey:()=>iy,unmarshalRsaPublicKey:()=>oy});var gn=pt(ft(),1);var lm=pt(Lf(),1);function pr(t){if(isNaN(t)||t<=0)throw new K("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Dr(t)}var Wx=pt(Wn(),1),ra=pt(ft(),1);function Nf(t,e){return e.map(r=>Wt(t[r]))}function Df(t){return ra.default.pki.setRsaPrivateKey(...Nf(t,["n","e","d","p","q","dp","dq","qi"]))}function kf(t){return ra.default.pki.setRsaPublicKey(...Nf(t,["n","e"]))}var yr={};Rt(yr,{jwkToPkcs1:()=>jp,jwkToPkix:()=>ey,pkcs1ToJwk:()=>Jp,pkixToJwk:()=>ty});var Qx=pt(an(),1),Xx=pt(Wn(),1);var Re=pt(ft(),1);function Jp(t){let e=Re.default.asn1.fromDer(xt(t,"ascii")),r=Re.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:se(r.n),e:se(r.e),d:se(r.d),p:se(r.p),q:se(r.q),dp:se(r.dP),dq:se(r.dQ),qi:se(r.qInv),alg:"RS256"}}function jp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Re.default.pki.privateKeyToAsn1({n:Wt(t.n),e:Wt(t.e),d:Wt(t.d),p:Wt(t.p),q:Wt(t.q),dP:Wt(t.dp),dQ:Wt(t.dq),qInv:Wt(t.qi)});return ht(Re.default.asn1.toDer(e).getBytes(),"ascii")}function ty(t){let e=Re.default.asn1.fromDer(xt(t,"ascii")),r=Re.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:se(r.n),e:se(r.e)}}function ey(t){if(t.n==null||t.e==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Re.default.pki.publicKeyToAsn1({n:Wt(t.n),e:Wt(t.e)});return ht(Re.default.asn1.toDer(e).getBytes(),"ascii")}async function Pf(t){let e=await Ht.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Of(e);return{privateKey:r[0],publicKey:r[1]}}async function na(t){let r=[await Ht.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await ry(t)],n=await Of({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Kf(t,e){let r=await Ht.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Ht.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Uf(t,e,r){let n=await Ht.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Ht.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Of(t){if(t.privateKey==null||t.publicKey==null)throw new K("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Ht.get().subtle.exportKey("jwk",t.privateKey),Ht.get().subtle.exportKey("jwk",t.publicKey)])}async function ry(t){return Ht.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Mf(t,e,r,n){let i=e?kf(t):Df(t),o=xt(Uint8Array.from(r),"ascii"),s=n(o,i);return ht(s,"ascii")}function Ff(t,e){return Mf(t,!0,e,(r,n)=>n.encrypt(r))}function Vf(t,e){return Mf(t,!1,e,(r,n)=>n.decrypt(r))}function mi(t){if(t.kty!=="RSA")throw new K("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new K("invalid key modulus","ERR_INVALID_KEY_MODULUS");return ht(t.n,"base64url").length*8}var mn=8192,xn=class{_key;constructor(e){this._key=e}async verify(e,r){return Uf(this._key,r,e)}marshal(){return yr.jwkToPkix(this._key)}get bytes(){return Te.encode({Type:Ct.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Ff(this._key,e)}equals(e){return Gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}},Vr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return pr(16)}async sign(e){return Kf(this._key,e)}get public(){if(this._publicKey==null)throw new K("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new xn(this._publicKey)}decrypt(e){return Vf(this._key,e)}marshal(){return yr.jwkToPkcs1(this._key)}get bytes(){return xe.encode({Type:Ct.RSA,Data:this.marshal()}).subarray()}equals(e){return Gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return xt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new gn.default.util.ByteBuffer(this.marshal()),i=gn.default.asn1.fromDer(n),o=gn.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return gn.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return Ur(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function iy(t){let e=yr.pkcs1ToJwk(t);if(mi(e)>mn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await na(e);return new Vr(r.privateKey,r.publicKey)}function oy(t){let e=yr.pkixToJwk(t);if(mi(e)>mn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new xn(e)}async function ay(t){if(mi(t)>mn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await na(t);return new Vr(e.privateKey,e.publicKey)}async function sy(t){if(t>mn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Pf(t);return new Vr(e.privateKey,e.publicKey)}var ua={};Rt(ua,{Secp256k1PrivateKey:()=>bn,Secp256k1PublicKey:()=>vn,generateKeyPair:()=>wy,unmarshalSecp256k1PrivateKey:()=>by,unmarshalSecp256k1PublicKey:()=>Ey});var fy=(t,e,r)=>t&e^~t&r,cy=(t,e,r)=>t&e^t&r^e&r,uy=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$e=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ze=new Uint32Array(64),oa=class extends kr{constructor(){super(64,32,8,!1),this.A=$e[0]|0,this.B=$e[1]|0,this.C=$e[2]|0,this.D=$e[3]|0,this.E=$e[4]|0,this.F=$e[5]|0,this.G=$e[6]|0,this.H=$e[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:f}=this;return[e,r,n,i,o,s,a,f]}set(e,r,n,i,o,s,a,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=f|0}process(e,r){for(let l=0;l<16;l++,r+=4)Ze[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){let h=Ze[l-15],g=Ze[l-2],d=re(h,7)^re(h,18)^h>>>3,p=re(g,17)^re(g,19)^g>>>10;Ze[l]=p+Ze[l-7]+d+Ze[l-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:f,G:c,H:u}=this;for(let l=0;l<64;l++){let h=re(a,6)^re(a,11)^re(a,25),g=u+h+fy(a,f,c)+uy[l]+Ze[l]|0,p=(re(n,2)^re(n,13)^re(n,22))+cy(n,i,o)|0;u=c,c=f,f=a,a=s+g|0,s=o,o=i,i=n,n=g+p|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,f,c,u)}roundClean(){Ze.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var qf=Xn(()=>new oa);function ly(t){let e=ln(t);ye(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:hy,hexToBytes:dy}=ei,gr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=gr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:hy(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=gr,r=typeof t=="string"?dy(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=gr._parseInt(r.subarray(2)),{d:s,l:a}=gr._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),f=r(s);return`30${r(s+o+4)}02${f}${i}02${a}${n}`}},Le=BigInt(0),jt=BigInt(1),bm=BigInt(2),Hf=BigInt(3),Em=BigInt(4);function py(t){let e=ly(t),{Fp:r}=e,n=e.toBytes||((d,p,y)=>{let m=p.toAffine();return Ce(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),m=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function o(d){let{a:p,b:y}=e,m=r.sqr(d),E=r.mul(m,d);return r.add(r.add(E,r.mul(d,p)),y)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(d){return typeof d=="bigint"&&Le<d&&d<e.n}function a(d){if(!s(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(d){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=Be(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(y*2,"0")}let b;try{b=typeof d=="bigint"?d:Ae(St("private key",d,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof d}`)}return m&&(b=ut(b,E)),a(b),b}let c=new Map;function u(d){if(!(d instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(p,y,m){if(this.px=p,this.py=y,this.pz=m,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(p){let{x:y,y:m}=p||{};if(!p||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(p instanceof l)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?l.ZERO:new l(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(m=>m.pz));return p.map((m,E)=>m.toAffine(y[E])).map(l.fromAffine)}static fromHex(p){let y=l.fromAffine(i(St("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return l.BASE.multiply(f(p))}_setWindowSize(p){this._WINDOW_SIZE=p,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=o(p);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:T,pz:w}=p,S=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(T,E));return S&&L}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,m=r.mul(y,Hf),{px:E,py:b,pz:T}=this,w=r.ZERO,S=r.ZERO,L=r.ZERO,N=r.mul(E,E),G=r.mul(b,b),Y=r.mul(T,T),q=r.mul(E,b);return q=r.add(q,q),L=r.mul(E,T),L=r.add(L,L),w=r.mul(p,L),S=r.mul(m,Y),S=r.add(w,S),w=r.sub(G,S),S=r.add(G,S),S=r.mul(w,S),w=r.mul(q,w),L=r.mul(m,L),Y=r.mul(p,Y),q=r.sub(N,Y),q=r.mul(p,q),q=r.add(q,L),L=r.add(N,N),N=r.add(L,N),N=r.add(N,Y),N=r.mul(N,q),S=r.add(S,N),Y=r.mul(b,T),Y=r.add(Y,Y),N=r.mul(Y,q),w=r.sub(w,N),L=r.mul(Y,G),L=r.add(L,L),L=r.add(L,L),new l(w,S,L)}add(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:T,pz:w}=p,S=r.ZERO,L=r.ZERO,N=r.ZERO,G=e.a,Y=r.mul(e.b,Hf),q=r.mul(y,b),J=r.mul(m,T),ct=r.mul(E,w),Pt=r.add(y,m),_=r.add(b,T);Pt=r.mul(Pt,_),_=r.add(q,J),Pt=r.sub(Pt,_),_=r.add(y,E);let k=r.add(b,w);return _=r.mul(_,k),k=r.add(q,ct),_=r.sub(_,k),k=r.add(m,E),S=r.add(T,w),k=r.mul(k,S),S=r.add(J,ct),k=r.sub(k,S),N=r.mul(G,_),S=r.mul(Y,ct),N=r.add(S,N),S=r.sub(J,N),N=r.add(J,N),L=r.mul(S,N),J=r.add(q,q),J=r.add(J,q),ct=r.mul(G,ct),_=r.mul(Y,_),J=r.add(J,ct),ct=r.sub(q,ct),ct=r.mul(G,ct),_=r.add(_,ct),q=r.mul(J,_),L=r.add(L,q),q=r.mul(k,_),S=r.mul(Pt,S),S=r.sub(S,q),q=r.mul(Pt,J),N=r.mul(k,N),N=r.add(N,q),new l(S,L,N)}subtract(p){return this.add(p.negate())}is0(){return this.equals(l.ZERO)}wNAF(p){return g.wNAFCached(this,c,p,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(l.fromAffine)})}multiplyUnsafe(p){let y=l.ZERO;if(p===Le)return y;if(a(p),p===jt)return this;let{endo:m}=e;if(!m)return g.unsafeLadder(this,p);let{k1neg:E,k1:b,k2neg:T,k2:w}=m.splitScalar(p),S=y,L=y,N=this;for(;b>Le||w>Le;)b&jt&&(S=S.add(N)),w&jt&&(L=L.add(N)),N=N.double(),b>>=jt,w>>=jt;return E&&(S=S.negate()),T&&(L=L.negate()),L=new l(r.mul(L.px,m.beta),L.py,L.pz),S.add(L)}multiply(p){a(p);let y=p,m,E,{endo:b}=e;if(b){let{k1neg:T,k1:w,k2neg:S,k2:L}=b.splitScalar(y),{p:N,f:G}=this.wNAF(w),{p:Y,f:q}=this.wNAF(L);N=g.constTimeNegate(T,N),Y=g.constTimeNegate(S,Y),Y=new l(r.mul(Y.px,b.beta),Y.py,Y.pz),m=N.add(Y),E=G.add(q)}else{let{p:T,f:w}=this.wNAF(y);m=T,E=w}return l.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(p,y,m){let E=l.BASE,b=(w,S)=>S===Le||S===jt||!w.equals(E)?w.multiplyUnsafe(S):w.multiply(S),T=b(this,y).add(b(p,m));return T.is0()?void 0:T}toAffine(p){let{px:y,py:m,pz:E}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(E));let T=r.mul(y,p),w=r.mul(m,p),S=r.mul(E,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(S,r.ONE))throw new Error("invZ was invalid");return{x:T,y:w}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===jt)return!0;if(y)return y(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===jt?this:y?y(l,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(l,this,p)}toHex(p=!0){return Be(this.toRawBytes(p))}}l.BASE=new l(e.Gx,e.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);let h=e.nBitLength,g=ii(l,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:f,weierstrassEquation:o,isWithinCurveOrder:s}}function yy(t){let e=ln(t);return ye(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function zf(t){let e=yy(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(_){return Le<_&&_<r.ORDER}function a(_){return ut(_,n)}function f(_){return ri(_,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=py({...e,toBytes(_,k,R){let D=k.toAffine(),A=r.toBytes(D.x),O=Ce;return R?O(Uint8Array.from([k.hasEvenY()?2:3]),A):O(Uint8Array.from([4]),A,r.toBytes(D.y))},fromBytes(_){let k=_.length,R=_[0],D=_.subarray(1);if(k===i&&(R===2||R===3)){let A=Ae(D);if(!s(A))throw new Error("Point is not on curve");let O=l(A),M=r.sqrt(O),H=(M&jt)===jt;return(R&1)===1!==H&&(M=r.neg(M)),{x:A,y:M}}else if(k===o&&R===4){let A=r.fromBytes(D.subarray(0,r.BYTES)),O=r.fromBytes(D.subarray(r.BYTES,2*r.BYTES));return{x:A,y:O}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),g=_=>Be(Ge(_,e.nByteLength));function d(_){let k=n>>jt;return _>k}function p(_){return d(_)?a(-_):_}let y=(_,k,R)=>Ae(_.slice(k,R));class m{constructor(k,R,D){this.r=k,this.s=R,this.recovery=D,this.assertValidity()}static fromCompact(k){let R=e.nByteLength;return k=St("compactSignature",k,R*2),new m(y(k,0,R),y(k,R,2*R))}static fromDER(k){let{r:R,s:D}=gr.toSig(St("DER",k));return new m(R,D)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:R,s:D,recovery:A}=this,O=L(St("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let M=A===2||A===3?R+e.n:R;if(M>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let H=A&1?"03":"02",Q=c.fromHex(H+g(M)),j=f(M),st=a(-O*j),tt=a(D*j),ot=c.BASE.multiplyAndAddUnsafe(Q,st,tt);if(!ot)throw new Error("point at infinify");return ot.assertValidity(),ot}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return or(this.toDERHex())}toDERHex(){return gr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return or(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}let E={isValidPrivateKey(_){try{return u(_),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let _=To(e.n);return E0(e.randomBytes(_),e.n)},precompute(_=8,k=c.BASE){return k._setWindowSize(_),k.multiply(BigInt(3)),k}};function b(_,k=!0){return c.fromPrivateKey(_).toRawBytes(k)}function T(_){let k=_ instanceof Uint8Array,R=typeof _=="string",D=(k||R)&&_.length;return k?D===i||D===o:R?D===2*i||D===2*o:_ instanceof c}function w(_,k,R=!0){if(T(_))throw new Error("first arg must be private key");if(!T(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(_)).toRawBytes(R)}let S=e.bits2int||function(_){let k=Ae(_),R=_.length*8-e.nBitLength;return R>0?k>>BigInt(R):k},L=e.bits2int_modN||function(_){return a(S(_))},N=un(e.nBitLength);function G(_){if(typeof _!="bigint")throw new Error("bigint expected");if(!(Le<=_&&_<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ge(_,e.nByteLength)}function Y(_,k,R=q){if(["recovered","canonical"].some(Et=>Et in R))throw new Error("sign() legacy options not supported");let{hash:D,randomBytes:A}=e,{lowS:O,prehash:M,extraEntropy:H}=R;O==null&&(O=!0),_=St("msgHash",_),M&&(_=St("prehashed msgHash",D(_)));let Q=L(_),j=u(k),st=[G(j),G(Q)];if(H!=null){let Et=H===!0?A(r.BYTES):H;st.push(St("extraEntropy",Et))}let tt=Ce(...st),ot=Q;function _t(Et){let Kt=S(Et);if(!h(Kt))return;let Ut=f(Kt),It=c.BASE.multiply(Kt).toAffine(),Ft=a(It.x);if(Ft===Le)return;let ve=a(Ut*a(ot+Ft*j));if(ve===Le)return;let Xe=(It.x===Ft?0:2)|Number(It.y&jt),Xr=ve;return O&&d(ve)&&(Xr=p(ve),Xe^=1),new m(Ft,Xr,Xe)}return{seed:tt,k2sig:_t}}let q={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function ct(_,k,R=q){let{seed:D,k2sig:A}=Y(_,k,R),O=e;return Ao(O.hash.outputLen,O.nByteLength,O.hmac)(D,A)}c.BASE._setWindowSize(8);function Pt(_,k,R,D=J){let A=_;if(k=St("msgHash",k),R=St("publicKey",R),"strict"in D)throw new Error("options.strict was renamed to lowS");let{lowS:O,prehash:M}=D,H,Q;try{if(typeof A=="string"||A instanceof Uint8Array)try{H=m.fromDER(A)}catch(It){if(!(It instanceof gr.Err))throw It;H=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:It,s:Ft}=A;H=new m(It,Ft)}else throw new Error("PARSE");Q=c.fromHex(R)}catch(It){if(It.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(O&&H.hasHighS())return!1;M&&(k=e.hash(k));let{r:j,s:st}=H,tt=L(k),ot=f(st),_t=a(tt*ot),Et=a(j*ot),Kt=c.BASE.multiplyAndAddUnsafe(Q,_t,Et)?.toAffine();return Kt?a(Kt.x)===j:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:ct,verify:Pt,ProjectivePoint:c,Signature:m,utils:E}}var vi=class extends Nr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,c0(e);let n=cn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Lr(this),this.iHash.update(e),this}digestInto(e){Lr(this),mo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},aa=(t,e,r)=>new vi(t,e).update(r).digest();aa.create=(t,e)=>new vi(t,e);function gy(t){return{hash:t,hmac:(e,...r)=>aa(t,e,Qn(...r)),randomBytes:Dr}}function Gf(t,e){let r=n=>zf({...t,...gy(n)});return Object.freeze({...r(e),create:r})}var $f=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Yf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),xy=BigInt(1),sa=BigInt(2),Wf=(t,e)=>(t+e/sa)/e;function my(t){let e=$f,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,l=bt(u,r,e)*u%e,h=bt(l,r,e)*u%e,g=bt(h,sa,e)*c%e,d=bt(g,i,e)*g%e,p=bt(d,o,e)*d%e,y=bt(p,a,e)*p%e,m=bt(y,f,e)*y%e,E=bt(m,a,e)*p%e,b=bt(E,r,e)*u%e,T=bt(b,s,e)*d%e,w=bt(T,n,e)*c%e,S=bt(w,sa,e);if(!fa.eql(fa.sqr(S),t))throw new Error("Cannot find square root");return S}var fa=ni($f,void 0,void 0,{sqrt:my}),Ne=Gf({a:BigInt(0),b:BigInt(7),Fp:fa,n:Yf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Yf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-xy*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Wf(o*t,e),f=Wf(-n*t,e),c=ut(t-a*r-f*i,e),u=ut(-a*n-f*o,e),l=c>s,h=u>s;if(l&&(c=e-c),h&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:c,k2neg:h,k2:u}}}},qf),Dm=BigInt(0);var km=Ne.ProjectivePoint;function Zf(){return Ne.utils.randomPrivateKey()}async function Qf(t,e){let{digest:r}=await Mt.digest(e);try{return Ne.sign(r,t).toDERRawBytes()}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}async function Xf(t,e,r){try{let{digest:n}=await Mt.digest(r);return Ne.verify(e,n,t)}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}function Jf(t){return Ne.ProjectivePoint.fromHex(t).toRawBytes(!0)}function jf(t){try{Ne.getPublicKey(t,!0)}catch(e){throw new K(String(e),"ERR_INVALID_PRIVATE_KEY")}}function ca(t){try{Ne.ProjectivePoint.fromHex(t)}catch(e){throw new K(String(e),"ERR_INVALID_PUBLIC_KEY")}}function tc(t){try{return Ne.getPublicKey(t,!0)}catch(e){throw new K(String(e),"ERR_INVALID_PRIVATE_KEY")}}var vn=class{_key;constructor(e){ca(e),this._key=e}async verify(e,r){return Xf(this._key,r,e)}marshal(){return Jf(this._key)}get bytes(){return Te.encode({Type:Ct.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}},bn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??tc(e),jf(this._key),ca(this._publicKey)}async sign(e){return Qf(this._key,e)}get public(){return new vn(this._publicKey)}marshal(){return this._key}get bytes(){return xe.encode({Type:Ct.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Gt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return xt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Ur(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function by(t){return new bn(t)}function Ey(t){return new vn(t)}async function wy(){let t=Zf();return new bn(t)}var qr={rsa:ia,ed25519:jo,secp256k1:ua};function ec(t){let e=Object.keys(qr).join(" / ");return new K(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Sy(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return qr[t];throw ec(t)}async function rc(t,e){return Sy(t).generateKeyPair(e??2048)}async function la(t){let e=xe.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case Ct.RSA:return qr.rsa.unmarshalRsaPrivateKey(r);case Ct.Ed25519:return qr.ed25519.unmarshalEd25519PrivateKey(r);case Ct.Secp256k1:return qr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw ec(e.Type??"RSA")}}async function En(t,e){try{let i=await Cf(t,e);return await la(i)}catch{}let r=bi.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new K("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=bi.default.asn1.toDer(bi.default.pki.privateKeyToAsn1(r));return n=ht(n.getBytes(),"ascii"),qr.rsa.unmarshalRsaPrivateKey(n)}var ic=pt(so(),1),oc=pt(Bt(),1),nc={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function wn(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let a=Object.keys(nc).join(" / ");throw new K(`Hash '${i}' is unknown or not supported. Must be ${a}`,"ERR_UNSUPPORTED_HASH_TYPE")}let o=nc[i],s=(0,ic.default)(t,e,r,n,o);return oc.default.encode64(s,null)}var Zt=pt(uc(),1);Zt.default.formatters.b=t=>t==null?"undefined":Ot.baseEncode(t);Zt.default.formatters.t=t=>t==null?"undefined":Oe.baseEncode(t);Zt.default.formatters.m=t=>t==null?"undefined":je.baseEncode(t);Zt.default.formatters.p=t=>t==null?"undefined":t.toString();Zt.default.formatters.c=t=>t==null?"undefined":t.toString();Zt.default.formatters.k=t=>t==null?"undefined":t.toString();Zt.default.formatters.a=t=>t==null?"undefined":t.toString();function Uy(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function lc(t){let e=Uy(`${t}:trace`);return Zt.default.enabled(`${t}:trace`)&&Zt.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,Zt.default)(`${t}:trace`)),Object.assign((0,Zt.default)(t),{error:(0,Zt.default)(`${t}:error`),trace:e})}var hc=Symbol.for("@libp2p/peer-id");var Oy=Symbol.for("nodejs.util.inspect.custom"),dc=Object.values(Ir).map(t=>t.decoder).reduce((t,e)=>t.or(e),Ir.identity.decoder),pc=114,ha=36,da=37,Sn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[hc]=!0;toString(){return this.string==null&&(this.string=Ot.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return tr.createV1(pc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Gt(this.multihash.bytes,e);if(typeof e=="string")return My(e).equals(this);if(e?.multihash?.bytes!=null)return Gt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Oy](){return`PeerId(${this.toString()})`}},Yr=class extends Sn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Wr=class extends Sn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},$r=class extends Sn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function My(t,e){if(e=e??dc,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=en(Ot.decode(`z${t}`));return t.startsWith("12D")?new Wr({multihash:r}):t.startsWith("16U")?new $r({multihash:r}):new Yr({multihash:r})}return Fy(dc.decode(t))}function Fy(t){try{let e=en(t);if(e.code===Me.code){if(e.digest.length===ha)return new Wr({multihash:e});if(e.digest.length===da)return new $r({multihash:e})}if(e.code===Mt.code)return new Yr({multihash:e})}catch{return Vy(tr.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Vy(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==pc)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Mt.code)return new Yr({multihash:t.multihash});if(e.code===Me.code){if(e.digest.length===ha)return new Wr({multihash:t.multihash});if(e.digest.length===da)return new $r({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function yc(t,e){return t.length===ha?new Wr({multihash:fe(Me.code,t),privateKey:e}):t.length===da?new $r({multihash:fe(Me.code,t),privateKey:e}):new Yr({multihash:await Mt.digest(t),publicKey:t,privateKey:e})}var gc=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");var De="/",xc=new TextEncoder().encode(De),Si=xc[0],Bn=class t{_buf;constructor(e,r){if(typeof e=="string")this._buf=ht(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Si)throw new Error("Invalid key")}toString(e="utf8"){return xt(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new t(e.join(De))}static random(){return new t(gc().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new t(e):typeof e.uint8Array=="function"?new t(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=xc),this._buf[0]!==Si){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Si,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Si;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let o=r[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return r.length<n.length}reverse(){return t.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(De).slice(1)}type(){return qy(this.baseNamespace())}name(){return Hy(this.baseNamespace())}instance(e){return new t(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(De)||(e+=De),e+=this.type(),new t(e)}parent(){let e=this.list();return e.length===1?new t(De):new t(e.slice(0,-1).join(De))}child(e){return this.toString()===De?e:e.toString()===De?this:new t(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return t.withNamespaces([...this.namespaces(),...zy(e.map(r=>r.namespaces()))])}};function qy(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Hy(t){let e=t.split(":");return e[e.length-1]}function zy(t){return[].concat(...t)}var Cc=pt(Ac(),1),_c=Cc.default;var Uc=pt(Kc(),1);var rt;(function(t){t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",t.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",t.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",t.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",t.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",t.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",t.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",t.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",t.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",t.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",t.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",t.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",t.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",t.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"})(rt||(rt={}));var Ci=lc("libp2p:keychain"),f1="/pkcs8/",Oc="/info/",mr=new WeakMap,vr={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},ya={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function ke(t){return t==null||typeof t!="string"?!1:t===(0,Uc.default)(t.trim())&&t.length>0}async function lt(){let r=Math.random()*800+200;await new Promise(n=>setTimeout(n,r))}function me(t){return new Bn(f1+t)}function Qe(t){return new Bn(Oc+t)}var ga=class{components;init;constructor(e,r){if(this.components=e,this.init=_c(ya,r),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<vr.minKeyLength)throw new Error(`dek.keyLength must be least ${vr.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<vr.minSaltLength)throw new Error(`dek.saltLength must be least ${vr.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<vr.minIterationCount)throw new Error(`dek.iterationCount must be least ${vr.minIterationCount}`);let n=this.init.pass!=null&&this.init.dek?.salt!=null?wn(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";mr.set(this,{dek:n})}static generateOptions(){let e=Object.assign({},ya),r=Math.ceil(vr.minSaltLength/3)*3;return e.dek.salt=xt(pr(r),"base64"),e}static get options(){return ya}async createKey(e,r,n=2048){if(!ke(e)||e==="self")throw await lt(),new K("Invalid key name",rt.ERR_INVALID_KEY_NAME);if(typeof r!="string")throw await lt(),new K("Invalid key type",rt.ERR_INVALID_KEY_TYPE);let i=me(e);if(await this.components.datastore.has(i))throw await lt(),new K("Key name already exists",rt.ERR_KEY_ALREADY_EXISTS);switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)throw await lt(),new K("Invalid RSA key size",rt.ERR_INVALID_KEY_SIZE);break;default:break}let s;try{let a=await rc(r,n),f=await a.id(),c=mr.get(this);if(c==null)throw new K("dek missing",rt.ERR_INVALID_PARAMETERS);let u=c.dek,l=await a.export(u);s={name:e,id:f};let h=this.components.datastore.batch();h.put(i,ht(l)),h.put(Qe(e),ht(JSON.stringify(s))),await h.commit()}catch(a){throw await lt(),a}return s}async listKeys(){let e={prefix:Oc},r=[];for await(let n of this.components.datastore.query(e))r.push(JSON.parse(xt(n.value)));return r}async findKeyById(e){try{let n=(await this.listKeys()).find(i=>i.id===e);if(n==null)throw new K(`Key with id '${e}' does not exist.`,rt.ERR_KEY_NOT_FOUND);return n}catch(r){throw await lt(),r}}async findKeyByName(e){if(!ke(e))throw await lt(),new K(`Invalid key name '${e}'`,rt.ERR_INVALID_KEY_NAME);let r=Qe(e);try{let n=await this.components.datastore.get(r);return JSON.parse(xt(n))}catch(n){throw await lt(),Ci.error(n),new K(`Key '${e}' does not exist.`,rt.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!ke(e)||e==="self")throw await lt(),new K(`Invalid key name '${e}'`,rt.ERR_INVALID_KEY_NAME);let r=me(e),n=await this.findKeyByName(e),i=this.components.datastore.batch();return i.delete(r),i.delete(Qe(e)),await i.commit(),n}async renameKey(e,r){if(!ke(e)||e==="self")throw await lt(),new K(`Invalid old key name '${e}'`,rt.ERR_OLD_KEY_NAME_INVALID);if(!ke(r)||r==="self")throw await lt(),new K(`Invalid new key name '${r}'`,rt.ERR_NEW_KEY_NAME_INVALID);let n=me(e),i=me(r),o=Qe(e),s=Qe(r);if(await this.components.datastore.has(i))throw await lt(),new K(`Key '${r}' already exists`,rt.ERR_KEY_ALREADY_EXISTS);try{let f=await this.components.datastore.get(n),c=await this.components.datastore.get(o),u=JSON.parse(xt(c));u.name=r;let l=this.components.datastore.batch();return l.put(i,f),l.put(s,ht(JSON.stringify(u))),l.delete(n),l.delete(o),await l.commit(),u}catch(f){throw await lt(),f}}async exportKey(e,r){if(!ke(e))throw await lt(),new K(`Invalid key name '${e}'`,rt.ERR_INVALID_KEY_NAME);if(r==null)throw await lt(),new K("Password is required",rt.ERR_PASSWORD_REQUIRED);let n=me(e);try{let i=await this.components.datastore.get(n),o=xt(i),s=mr.get(this);if(s==null)throw new K("dek missing",rt.ERR_INVALID_PARAMETERS);let a=s.dek;return await(await En(o,a)).export(r)}catch(i){throw await lt(),i}}async exportPeerId(e){let r="temporary-password",n=await this.exportKey(e,r),i=await En(n,r);return yc(i.public.bytes,i.bytes)}async importKey(e,r,n){if(!ke(e)||e==="self")throw await lt(),new K(`Invalid key name '${e}'`,rt.ERR_INVALID_KEY_NAME);if(r==null)throw await lt(),new K("PEM encoded key is required",rt.ERR_PEM_REQUIRED);let i=me(e);if(await this.components.datastore.has(i))throw await lt(),new K(`Key '${e}' already exists`,rt.ERR_KEY_ALREADY_EXISTS);let s;try{s=await En(r,n)}catch{throw await lt(),new K("Cannot read the key, most likely the password is wrong",rt.ERR_CANNOT_READ_KEY)}let a;try{a=await s.id();let u=mr.get(this);if(u==null)throw new K("dek missing",rt.ERR_INVALID_PARAMETERS);let l=u.dek;r=await s.export(l)}catch(u){throw await lt(),u}let f={name:e,id:a},c=this.components.datastore.batch();return c.put(i,ht(r)),c.put(Qe(e),ht(JSON.stringify(f))),await c.commit(),f}async importPeer(e,r){try{if(!ke(e))throw new K(`Invalid key name '${e}'`,rt.ERR_INVALID_KEY_NAME);if(r==null)throw new K("PeerId is required",rt.ERR_MISSING_PRIVATE_KEY);if(r.privateKey==null)throw new K("PeerId.privKey is required",rt.ERR_MISSING_PRIVATE_KEY);let n=await la(r.privateKey),i=me(e);if(await this.components.datastore.has(i))throw await lt(),new K(`Key '${e}' already exists`,rt.ERR_KEY_ALREADY_EXISTS);let s=mr.get(this);if(s==null)throw new K("dek missing",rt.ERR_INVALID_PARAMETERS);let a=s.dek,f=await n.export(a),c={name:e,id:r.toString()},u=this.components.datastore.batch();return u.put(i,ht(f)),u.put(Qe(e),ht(JSON.stringify(c))),await u.commit(),c}catch(n){throw await lt(),n}}async getPrivateKey(e){if(!ke(e))throw await lt(),new K(`Invalid key name '${e}'`,rt.ERR_INVALID_KEY_NAME);try{let r=me(e),n=await this.components.datastore.get(r);return xt(n)}catch(r){throw await lt(),Ci.error(r),new K(`Key '${e}' does not exist.`,rt.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,r){if(typeof e!="string")throw await lt(),new K(`Invalid old pass type '${typeof e}'`,rt.ERR_INVALID_OLD_PASS_TYPE);if(typeof r!="string")throw await lt(),new K(`Invalid new pass type '${typeof r}'`,rt.ERR_INVALID_NEW_PASS_TYPE);if(r.length<20)throw await lt(),new K(`Invalid pass length ${r.length}`,rt.ERR_INVALID_PASS_LENGTH);Ci("recreating keychain");let n=mr.get(this);if(n==null)throw new K("dek missing",rt.ERR_INVALID_PARAMETERS);let i=n.dek;this.init.pass=r;let o=r!=null&&this.init.dek?.salt!=null?wn(r,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";mr.set(this,{dek:o});let s=await this.listKeys();for(let a of s){let f=await this.components.datastore.get(me(a.name)),c=xt(f),u=await En(c,i),l=o.toString(),h=await u.export(l),g=this.components.datastore.batch(),d={name:a.name,id:a.id};g.put(me(a.name),ht(h)),g.put(Qe(a.name),ht(JSON.stringify(d))),await g.commit()}Ci("keychain reconstructed")}};return Jc(c1);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PKeychain}));
