(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerStore = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerStore=(()=>{var Xl=Object.create;var ci=Object.defineProperty;var Jl=Object.getOwnPropertyDescriptor;var jl=Object.getOwnPropertyNames;var th=Object.getPrototypeOf,eh=Object.prototype.hasOwnProperty;var Q=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ot=(e,t)=>{for(var r in t)ci(e,r,{get:t[r],enumerable:!0})},u0=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of jl(t))!eh.call(e,i)&&i!==r&&ci(e,i,{get:()=>t[i],enumerable:!(n=Jl(t,i))||n.enumerable});return e};var Lt=(e,t,r)=>(r=e!=null?Xl(th(e)):{},u0(t||!e||!e.__esModule?ci(r,"default",{value:e,enumerable:!0}):r,e)),rh=e=>u0(ci({},"__esModule",{value:!0}),e);var l0=Q((_m,f0)=>{var Xr=1e3,Jr=Xr*60,jr=Jr*60,Sr=jr*24,nh=Sr*7,ih=Sr*365.25;f0.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return sh(e);if(r==="number"&&isFinite(e))return t.long?ah(e):oh(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function sh(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*ih;case"weeks":case"week":case"w":return r*nh;case"days":case"day":case"d":return r*Sr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*jr;case"minutes":case"minute":case"mins":case"min":case"m":return r*Jr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Xr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function oh(e){var t=Math.abs(e);return t>=Sr?Math.round(e/Sr)+"d":t>=jr?Math.round(e/jr)+"h":t>=Jr?Math.round(e/Jr)+"m":t>=Xr?Math.round(e/Xr)+"s":e+"ms"}function ah(e){var t=Math.abs(e);return t>=Sr?ui(e,t,Sr,"day"):t>=jr?ui(e,t,jr,"hour"):t>=Jr?ui(e,t,Jr,"minute"):t>=Xr?ui(e,t,Xr,"second"):e+" ms"}function ui(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var d0=Q((Tm,h0)=>{function ch(e){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=l0(),r.destroy=u,Object.keys(e).forEach(f=>{r[f]=e[f]}),r.names=[],r.skips=[],r.formatters={};function t(f){let l=0;for(let h=0;h<f.length;h++)l=(l<<5)-l+f.charCodeAt(h),l|=0;return r.colors[Math.abs(l)%r.colors.length]}r.selectColor=t;function r(f){let l,h=null,y,d;function p(...g){if(!p.enabled)return;let x=p,w=Number(new Date),b=w-(l||w);x.diff=b,x.prev=l,x.curr=w,l=w,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let T=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(S,L)=>{if(S==="%%")return"%";T++;let k=r.formatters[L];if(typeof k=="function"){let G=g[T];S=k.call(x,G),g.splice(T,1),T--}return S}),r.formatArgs.call(x,g),(x.log||r.log).apply(x,g)}return p.namespace=f,p.useColors=r.useColors(),p.color=r.selectColor(f),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(y!==r.namespaces&&(y=r.namespaces,d=r.enabled(f)),d),set:g=>{h=g}}),typeof r.init=="function"&&r.init(p),p}function n(f,l){let h=r(this.namespace+(typeof l>"u"?":":l)+f);return h.log=this.log,h}function i(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let l,h=(typeof f=="string"?f:"").split(/[\s,]+/),y=h.length;for(l=0;l<y;l++)h[l]&&(f=h[l].replace(/\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...r.names.map(a),...r.skips.map(a).map(l=>"-"+l)].join(",");return r.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let l,h;for(l=0,h=r.skips.length;l<h;l++)if(r.skips[l].test(f))return!1;for(l=0,h=r.names.length;l<h;l++)if(r.names[l].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}h0.exports=ch});var p0=Q((se,fi)=>{se.formatArgs=fh;se.save=lh;se.load=hh;se.useColors=uh;se.storage=dh();se.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();se.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function uh(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function fh(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+fi.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}se.log=console.debug||console.log||(()=>{});function lh(e){try{e?se.storage.setItem("debug",e):se.storage.removeItem("debug")}catch{}}function hh(){let e;try{e=se.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function dh(){try{return localStorage}catch{}}fi.exports=d0()(se);var{formatters:ph}=fi.exports;ph.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var lt=Q((Vm,E0)=>{E0.exports={options:{usePureJavaScript:!1}}});var A0=Q((Hm,B0)=>{var Ls={};B0.exports=Ls;var S0={};Ls.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=Ph(e,t);else{var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};Ls.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=S0[t];if(!r){r=S0[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),o=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*i,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var f=0;e[f]===s&&f<e.length-1;++f)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function Ph(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}});var kt=Q((zm,T0)=>{var C0=lt(),I0=A0(),m=T0.exports=C0.util=C0.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){m.nextTick=process.nextTick,typeof setImmediate=="function"?m.setImmediate=setImmediate:m.setImmediate=m.nextTick;return}if(typeof setImmediate=="function"){m.setImmediate=function(){return setImmediate.apply(void 0,arguments)},m.nextTick=function(a){return setImmediate(a)};return}if(m.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===e){c.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(f){f()})}};var o=a,e="forge.setImmediate",t=[];m.setImmediate=function(c){t.push(c),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var c=t.slice();t.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=m.setImmediate;m.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(t.push(c),t.length===1&&i.setAttribute("a",n=!n))}}m.nextTick=m.setImmediate})();m.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;m.globalScope=function(){return m.isNodejs?globalThis:typeof self>"u"?window:self}();m.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};m.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};m.isArrayBufferView=function(e){return e&&m.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Tn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}m.ByteBuffer=ks;function ks(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(m.isArrayBuffer(e)||m.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof ks||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}m.ByteStringBuffer=ks;var Dh=4096;m.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>Dh&&(this.data.substr(0,1),this._constructedStringLength=0)};m.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};m.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};m.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};m.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};m.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};m.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(m.encodeUtf8(e))};m.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};m.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};m.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};m.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};m.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};m.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};m.ByteStringBuffer.prototype.putInt=function(e,t){Tn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};m.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};m.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};m.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};m.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};m.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};m.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};m.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};m.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};m.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};m.ByteStringBuffer.prototype.getInt=function(e){Tn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};m.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};m.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};m.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};m.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};m.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};m.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};m.ByteStringBuffer.prototype.copy=function(){var e=m.createBuffer(this.data);return e.read=this.read,e};m.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};m.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};m.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};m.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};m.ByteStringBuffer.prototype.toString=function(){return m.decodeUtf8(this.bytes())};function Nh(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=m.isArrayBuffer(e),n=m.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}m.DataBuffer=Nh;m.DataBuffer.prototype.length=function(){return this.write-this.read};m.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};m.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};m.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};m.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};m.DataBuffer.prototype.putBytes=function(e,t){if(m.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(m.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof m.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&m.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof m.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=m.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=m.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};m.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};m.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};m.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};m.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};m.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};m.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};m.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};m.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};m.DataBuffer.prototype.putInt=function(e,t){Tn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};m.DataBuffer.prototype.putSignedInt=function(e,t){return Tn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};m.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};m.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};m.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};m.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};m.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};m.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};m.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};m.DataBuffer.prototype.getInt=function(e){Tn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};m.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};m.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};m.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};m.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};m.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};m.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};m.DataBuffer.prototype.copy=function(){return new m.DataBuffer(this)};m.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};m.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};m.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};m.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};m.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return m.binary.raw.encode(t);if(e==="hex")return m.binary.hex.encode(t);if(e==="base64")return m.binary.base64.encode(t);if(e==="utf8")return m.text.utf8.decode(t);if(e==="utf16")return m.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};m.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=m.encodeUtf8(e)),new m.ByteBuffer(e)};m.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};m.xorBytes=function(e,t,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};m.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};m.bytesToHex=function(e){return m.createBuffer(e).toHex()};m.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var ir="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";m.encode64=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.length;)i=e.charCodeAt(a++),s=e.charCodeAt(a++),o=e.charCodeAt(a++),r+=ir.charAt(i>>2),r+=ir.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ir.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ir.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};m.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,o=0;o<e.length;)r=sr[e.charCodeAt(o++)-43],n=sr[e.charCodeAt(o++)-43],i=sr[e.charCodeAt(o++)-43],s=sr[e.charCodeAt(o++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};m.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};m.decodeUtf8=function(e){return decodeURIComponent(escape(e))};m.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:I0.encode,decode:I0.decode}};m.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};m.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};m.binary.hex.encode=m.bytesToHex;m.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};m.binary.base64.encode=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.byteLength;)i=e[a++],s=e[a++],o=e[a++],r+=ir.charAt(i>>2),r+=ir.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ir.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":ir.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};m.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,u=r;c<e.length;)i=sr[e.charCodeAt(c++)-43],s=sr[e.charCodeAt(c++)-43],o=sr[e.charCodeAt(c++)-43],a=sr[e.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return t?u-r:n.subarray(0,u)};m.binary.base58.encode=function(e,t){return m.binary.baseN.encode(e,_0,t)};m.binary.base58.decode=function(e,t){return m.binary.baseN.decode(e,_0,t)};m.text={utf8:{},utf16:{}};m.text.utf8.encode=function(e,t,r){e=m.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};m.text.utf8.decode=function(e){return m.decodeUtf8(String.fromCharCode.apply(null,e))};m.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a),s+=2;return t?s-r:n};m.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};m.deflate=function(e,t,r){if(t=m.decode64(e.deflate(m.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};m.inflate=function(e,t,r){var n=e.inflate(m.encode64(t)).rval;return n===null?null:m.decode64(n)};var Ps=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=m.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Ds=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(m.decode64(r))),r},Uh=function(e,t,r,n){var i=Ds(e,t);i===null&&(i={}),i[r]=n,Ps(e,t,i)},Kh=function(e,t,r){var n=Ds(e,t);return n!==null&&(n=r in n?n[r]:null),n},Oh=function(e,t,r){var n=Ds(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Ps(e,t,n)}},Mh=function(e,t){Ps(e,t,null)},li=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};m.setItem=function(e,t,r,n,i){li(Uh,arguments,i)};m.getItem=function(e,t,r,n){return li(Kh,arguments,n)};m.removeItem=function(e,t,r,n){li(Oh,arguments,n)};m.clearItems=function(e,t,r){li(Mh,arguments,r)};m.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};m.format=function(e){for(var t=/%./g,r,n,i=0,s=[],o=0;r=t.exec(e);){n=e.substring(o,t.lastIndex-2),n.length>0&&s.push(n),o=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(e.substring(o)),s.join("")};m.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",f=u.length>3?u.length%3:0;return c+(f?u.substr(0,f)+a:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};m.formatSize=function(e){return e>=1073741824?e=m.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=m.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=m.formatNumber(e/1024,0)+" KiB":e=m.formatNumber(e,0)+" bytes",e};m.bytesFromIP=function(e){return e.indexOf(".")!==-1?m.bytesFromIPv4(e):e.indexOf(":")!==-1?m.bytesFromIPv6(e):null};m.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=m.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};m.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(o){return o.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=m.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=m.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};m.bytesToIP=function(e){return e.length===4?m.bytesToIPv4(e):e.length===16?m.bytesToIPv6(e):null};m.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};m.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=m.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=t.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),c.start===0&&t.unshift(""),c.end===7&&t.push(""))}return t.join(":")};m.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in m&&!e.update)return t(null,m.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return m.cores=navigator.hardwareConcurrency,t(null,m.cores);if(typeof Worker>"u")return m.cores=1,t(null,m.cores);if(typeof Blob>"u")return m.cores=2,t(null,m.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(f,l){return f+l},0)/o.length);return m.cores=Math.max(1,u),URL.revokeObjectURL(r),t(null,m.cores)}i(c,function(f,l){o.push(s(c,l)),n(o,a-1,c)})}function i(o,a){for(var c=[],u=[],f=0;f<o;++f){var l=new Worker(r);l.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var y=0;y<o;++y)c[y].terminate();a(null,u)}}),c.push(l)}for(var f=0;f<o;++f)c[f].postMessage(f)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var f=a[u],l=c[u]=[],h=0;h<o;++h)if(u!==h){var y=a[h];(f.st>y.st&&f.st<y.et||y.st>f.st&&y.st<f.et)&&l.push(h)}return c.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var hi=Q((Gm,R0)=>{var Rn=lt();Rn.pki=Rn.pki||{};var Ns=R0.exports=Rn.pki.oids=Rn.oids=Rn.oids||{};function _(e,t){Ns[e]=t,Ns[t]=e}function ot(e,t){Ns[e]=t}_("1.2.840.113549.1.1.1","rsaEncryption");_("1.2.840.113549.1.1.4","md5WithRSAEncryption");_("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_("1.2.840.113549.1.1.7","RSAES-OAEP");_("1.2.840.113549.1.1.8","mgf1");_("1.2.840.113549.1.1.9","pSpecified");_("1.2.840.113549.1.1.10","RSASSA-PSS");_("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_("1.3.101.112","EdDSA25519");_("1.2.840.10040.4.3","dsa-with-sha1");_("1.3.14.3.2.7","desCBC");_("1.3.14.3.2.26","sha1");_("1.3.14.3.2.29","sha1WithRSASignature");_("2.16.840.1.101.3.4.2.1","sha256");_("2.16.840.1.101.3.4.2.2","sha384");_("2.16.840.1.101.3.4.2.3","sha512");_("2.16.840.1.101.3.4.2.4","sha224");_("2.16.840.1.101.3.4.2.5","sha512-224");_("2.16.840.1.101.3.4.2.6","sha512-256");_("1.2.840.113549.2.2","md2");_("1.2.840.113549.2.5","md5");_("1.2.840.113549.1.7.1","data");_("1.2.840.113549.1.7.2","signedData");_("1.2.840.113549.1.7.3","envelopedData");_("1.2.840.113549.1.7.4","signedAndEnvelopedData");_("1.2.840.113549.1.7.5","digestedData");_("1.2.840.113549.1.7.6","encryptedData");_("1.2.840.113549.1.9.1","emailAddress");_("1.2.840.113549.1.9.2","unstructuredName");_("1.2.840.113549.1.9.3","contentType");_("1.2.840.113549.1.9.4","messageDigest");_("1.2.840.113549.1.9.5","signingTime");_("1.2.840.113549.1.9.6","counterSignature");_("1.2.840.113549.1.9.7","challengePassword");_("1.2.840.113549.1.9.8","unstructuredAddress");_("1.2.840.113549.1.9.14","extensionRequest");_("1.2.840.113549.1.9.20","friendlyName");_("1.2.840.113549.1.9.21","localKeyId");_("1.2.840.113549.1.9.22.1","x509Certificate");_("1.2.840.113549.1.12.10.1.1","keyBag");_("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_("1.2.840.113549.1.12.10.1.3","certBag");_("1.2.840.113549.1.12.10.1.4","crlBag");_("1.2.840.113549.1.12.10.1.5","secretBag");_("1.2.840.113549.1.12.10.1.6","safeContentsBag");_("1.2.840.113549.1.5.13","pkcs5PBES2");_("1.2.840.113549.1.5.12","pkcs5PBKDF2");_("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_("1.2.840.113549.2.7","hmacWithSHA1");_("1.2.840.113549.2.8","hmacWithSHA224");_("1.2.840.113549.2.9","hmacWithSHA256");_("1.2.840.113549.2.10","hmacWithSHA384");_("1.2.840.113549.2.11","hmacWithSHA512");_("1.2.840.113549.3.7","des-EDE3-CBC");_("2.16.840.1.101.3.4.1.2","aes128-CBC");_("2.16.840.1.101.3.4.1.22","aes192-CBC");_("2.16.840.1.101.3.4.1.42","aes256-CBC");_("2.5.4.3","commonName");_("2.5.4.4","surname");_("2.5.4.5","serialNumber");_("2.5.4.6","countryName");_("2.5.4.7","localityName");_("2.5.4.8","stateOrProvinceName");_("2.5.4.9","streetAddress");_("2.5.4.10","organizationName");_("2.5.4.11","organizationalUnitName");_("2.5.4.12","title");_("2.5.4.13","description");_("2.5.4.15","businessCategory");_("2.5.4.17","postalCode");_("2.5.4.42","givenName");_("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_("2.16.840.1.113730.1.1","nsCertType");_("2.16.840.1.113730.1.13","nsComment");ot("2.5.29.1","authorityKeyIdentifier");ot("2.5.29.2","keyAttributes");ot("2.5.29.3","certificatePolicies");ot("2.5.29.4","keyUsageRestriction");ot("2.5.29.5","policyMapping");ot("2.5.29.6","subtreesConstraint");ot("2.5.29.7","subjectAltName");ot("2.5.29.8","issuerAltName");ot("2.5.29.9","subjectDirectoryAttributes");ot("2.5.29.10","basicConstraints");ot("2.5.29.11","nameConstraints");ot("2.5.29.12","policyConstraints");ot("2.5.29.13","basicConstraints");_("2.5.29.14","subjectKeyIdentifier");_("2.5.29.15","keyUsage");ot("2.5.29.16","privateKeyUsagePeriod");_("2.5.29.17","subjectAltName");_("2.5.29.18","issuerAltName");_("2.5.29.19","basicConstraints");ot("2.5.29.20","cRLNumber");ot("2.5.29.21","cRLReason");ot("2.5.29.22","expirationDate");ot("2.5.29.23","instructionCode");ot("2.5.29.24","invalidityDate");ot("2.5.29.25","cRLDistributionPoints");ot("2.5.29.26","issuingDistributionPoint");ot("2.5.29.27","deltaCRLIndicator");ot("2.5.29.28","issuingDistributionPoint");ot("2.5.29.29","certificateIssuer");ot("2.5.29.30","nameConstraints");_("2.5.29.31","cRLDistributionPoints");_("2.5.29.32","certificatePolicies");ot("2.5.29.33","policyMappings");ot("2.5.29.34","policyConstraints");_("2.5.29.35","authorityKeyIdentifier");ot("2.5.29.36","policyConstraints");_("2.5.29.37","extKeyUsage");ot("2.5.29.46","freshestCRL");ot("2.5.29.54","inhibitAnyPolicy");_("1.3.6.1.4.1.11129.2.4.2","timestampList");_("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_("1.3.6.1.5.5.7.3.1","serverAuth");_("1.3.6.1.5.5.7.3.2","clientAuth");_("1.3.6.1.5.5.7.3.3","codeSigning");_("1.3.6.1.5.5.7.3.4","emailProtection");_("1.3.6.1.5.5.7.3.8","timeStamping")});var kn=Q((Wm,k0)=>{var gt=lt();kt();hi();var N=k0.exports=gt.asn1=gt.asn1||{};N.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};N.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};N.create=function(e,t,r,n,i){if(gt.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:e,type:t,constructed:r,composed:r||gt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=N.copy(a)),a};N.copy=function(e,t){var r;if(gt.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(N.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:N.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};N.equals=function(e,t,r){if(gt.util.isArray(e)){if(!gt.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!N.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&N.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};N.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Ln(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var Fh=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Ln(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};N.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=gt.util.createBuffer(e));var r=e.length(),n=di(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function di(e,t,r,n){var i;Ln(e,t,2);var s=e.getByte();t--;var o=s&192,a=s&31;i=e.length();var c=Fh(e,t);if(t-=i-e.length(),c!==void 0&&c>t){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=e.length(),u.remaining=t,u.requested=c,u}c=t}var f,l,h=(s&32)===32;if(h)if(f=[],c===void 0)for(;;){if(Ln(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),f.push(di(e,t,r+1,n)),t-=i-e.length()}else for(;c>0;)i=e.length(),f.push(di(e,c,r+1,n)),t-=i-e.length(),c-=i-e.length();if(f===void 0&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&(l=e.bytes(c)),f===void 0&&n.decodeBitStrings&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&c>1){var y=e.read,d=t,p=0;if(a===N.Type.BITSTRING&&(Ln(e,t,1),p=e.getByte(),t--),p===0)try{i=e.length();var g={strict:!0,decodeBitStrings:!0},x=di(e,t,r+1,g),w=i-e.length();t-=w,a==N.Type.BITSTRING&&w++;var b=x.tagClass;w===c&&(b===N.Class.UNIVERSAL||b===N.Class.CONTEXT_SPECIFIC)&&(f=[x])}catch{}f===void 0&&(e.read=y,t=d)}if(f===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=t}if(a===N.Type.BMPSTRING)for(f="";c>0;c-=2)Ln(e,t,2),f+=String.fromCharCode(e.getInt16()),t-=2;else f=e.getBytes(c),t-=c}var T=l===void 0?null:{bitStringContents:l};return N.create(o,a,h,f,T)}N.toDer=function(e){var t=gt.util.createBuffer(),r=e.tagClass|e.type,n=gt.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=N.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(N.toDer(e.value[s]))}else if(e.type===N.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===N.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);t.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)t.putByte(a.charCodeAt(s))}return t.putBuffer(n),t};N.oidToDer=function(e){var t=e.split("."),r=gt.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,a=2;a<t.length;++a){n=!0,i=[],s=parseInt(t[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};N.derToOid=function(e){var t;typeof e=="string"&&(e=gt.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};N.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),u&&(c=e.charAt(u),c==="+"||c==="-")){var f=parseInt(e.substr(u+1,2),10),l=parseInt(e.substr(u+4,2),10),h=f*60+l;h*=6e4,c==="+"?t.setTime(+t-h):t.setTime(+t+h)}return t};N.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,u=0,f=!1;e.charAt(e.length-1)==="Z"&&(f=!0);var l=e.length-5,h=e.charAt(l);if(h==="+"||h==="-"){var y=parseInt(e.substr(l+1,2),10),d=parseInt(e.substr(l+4,2),10);u=y*60+d,u*=6e4,h==="+"&&(u*=-1),f=!0}return e.charAt(14)==="."&&(c=parseFloat(e.substr(14),10)*1e3),f?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(s,o,a,c)),t};N.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};N.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};N.integerToDer=function(e){var t=gt.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};N.derToInteger=function(e){typeof e=="string"&&(e=gt.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};N.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&gt.util.isArray(t.value))for(var s=0,o=0;i&&o<t.value.length;++o)i=t.value[o].optional||!1,e.value[s]&&(i=N.validate(e.value[s],t.value[o],r,n),i?++s:t.value[o].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var c=e.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var L0=/[^\\u0000-\\u00ff]/;N.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case N.Class.UNIVERSAL:n+="Universal:";break;case N.Class.APPLICATION:n+="Application:";break;case N.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case N.Class.PRIVATE:n+="Private:";break}if(e.tagClass===N.Class.UNIVERSAL)switch(n+=e.type,e.type){case N.Type.NONE:n+=" (None)";break;case N.Type.BOOLEAN:n+=" (Boolean)";break;case N.Type.INTEGER:n+=" (Integer)";break;case N.Type.BITSTRING:n+=" (Bit string)";break;case N.Type.OCTETSTRING:n+=" (Octet string)";break;case N.Type.NULL:n+=" (Null)";break;case N.Type.OID:n+=" (Object Identifier)";break;case N.Type.ODESC:n+=" (Object Descriptor)";break;case N.Type.EXTERNAL:n+=" (External or Instance of)";break;case N.Type.REAL:n+=" (Real)";break;case N.Type.ENUMERATED:n+=" (Enumerated)";break;case N.Type.EMBEDDED:n+=" (Embedded PDV)";break;case N.Type.UTF8:n+=" (UTF8)";break;case N.Type.ROID:n+=" (Relative Object Identifier)";break;case N.Type.SEQUENCE:n+=" (Sequence)";break;case N.Type.SET:n+=" (Set)";break;case N.Type.PRINTABLESTRING:n+=" (Printable String)";break;case N.Type.IA5String:n+=" (IA5String (ASCII))";break;case N.Type.UTCTIME:n+=" (UTC time)";break;case N.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case N.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var o=0,a="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(o+=1,a+=N.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",e.type===N.Type.OID){var c=N.derToOid(e.value);n+=c,gt.pki&&gt.pki.oids&&c in gt.pki.oids&&(n+=" ("+gt.pki.oids[c]+") ")}if(e.type===N.Type.INTEGER)try{n+=N.derToInteger(e.value)}catch{n+="0x"+gt.util.bytesToHex(e.value)}else if(e.type===N.Type.BITSTRING){if(e.value.length>1?n+="0x"+gt.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var u=e.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(e.type===N.Type.OCTETSTRING)L0.test(e.value)||(n+="("+e.value+") "),n+="0x"+gt.util.bytesToHex(e.value);else if(e.type===N.Type.UTF8)try{n+=gt.util.decodeUtf8(e.value)}catch(f){if(f.message==="URI malformed")n+="0x"+gt.util.bytesToHex(e.value)+" (malformed UTF8)";else throw f}else e.type===N.Type.PRINTABLESTRING||e.type===N.Type.IA5String?n+=e.value:L0.test(e.value)?n+="0x"+gt.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var Ks=Q(($m,P0)=>{var Mt=lt();kt();P0.exports=Mt.cipher=Mt.cipher||{};Mt.cipher.algorithms=Mt.cipher.algorithms||{};Mt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Mt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Mt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Mt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Mt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Mt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Mt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Mt.cipher.algorithms[e]=t};Mt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Mt.cipher.algorithms?Mt.cipher.algorithms[e]:null};var Us=Mt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Us.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Mt.util.createBuffer(),this.output=e.output||Mt.util.createBuffer(),this.mode.start(t)};Us.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Us.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var Ms=Q((Qm,D0)=>{var Ft=lt();kt();Ft.cipher=Ft.cipher||{};var J=D0.exports=Ft.cipher.modes=Ft.cipher.modes||{};J.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};J.ecb.prototype.start=function(e){};J.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};J.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};J.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};J.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};J.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};J.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=pi(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};J.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};J.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};J.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};J.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};J.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ft.util.createBuffer(),this._partialBytes=0};J.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=pi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};J.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};J.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};J.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ft.util.createBuffer(),this._partialBytes=0};J.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=pi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};J.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};J.ofb.prototype.decrypt=J.ofb.prototype.encrypt;J.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ft.util.createBuffer(),this._partialBytes=0};J.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=pi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};J.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}yi(this._inBlock)};J.ctr.prototype.decrypt=J.ctr.prototype.encrypt;J.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ft.util.createBuffer(),this._partialBytes=0,this._R=3774873600};J.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Ft.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Ft.util.createBuffer(e.additionalData):r=Ft.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Ft.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Os(n*8)))}this._inBlock=this._j0.slice(0),yi(this._inBlock),this._partialBytes=0,r=Ft.util.createBuffer(r),this._aDataLength=Os(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};J.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),yi(this._inBlock)};J.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),yi(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};J.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Ft.util.createBuffer();var n=this._aDataLength.concat(Os(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};J.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};J.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};J.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};J.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};J.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,u=(n-1-o%n)*t;a[c]=1<<t-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s};J.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i};function pi(e,t){if(typeof e=="string"&&(e=Ft.util.createBuffer(e)),Ft.util.isArray(e)&&e.length>4){var r=e;e=Ft.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Ft.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function yi(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Os(e){return[e/4294967296|0,e&4294967295]}});var Hs=Q((Ym,O0)=>{var dt=lt();Ks();Ms();kt();O0.exports=dt.aes=dt.aes||{};dt.aes.startEncrypting=function(e,t,r,n){var i=gi({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};dt.aes.createEncryptionCipher=function(e,t){return gi({key:e,output:null,decrypt:!1,mode:t})};dt.aes.startDecrypting=function(e,t,r,n){var i=gi({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};dt.aes.createDecryptionCipher=function(e,t){return gi({key:e,output:null,decrypt:!0,mode:t})};dt.aes.Algorithm=function(e,t){Vs||U0();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return qs(r._w,n,i,!1)},decrypt:function(n,i){return qs(r._w,n,i,!0)}}}),r._init=!1};dt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=dt.util.createBuffer(t);else if(dt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=dt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!dt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!dt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=K0(t,e.decrypt&&!o),this._init=!0}};dt.aes._expandKey=function(e,t){return Vs||U0(),K0(e,t)};dt.aes._updateBlock=qs;nn("AES-ECB",dt.cipher.modes.ecb);nn("AES-CBC",dt.cipher.modes.cbc);nn("AES-CFB",dt.cipher.modes.cfb);nn("AES-OFB",dt.cipher.modes.ofb);nn("AES-CTR",dt.cipher.modes.ctr);nn("AES-GCM",dt.cipher.modes.gcm);function nn(e,t){var r=function(){return new dt.aes.Algorithm(e,t)};dt.cipher.registerAlgorithm(e,r)}var Vs=!1,rn=4,Xt,Fs,N0,Br,ge;function U0(){Vs=!0,N0=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Xt=new Array(256),Fs=new Array(256),Br=new Array(4),ge=new Array(4);for(var t=0;t<4;++t)Br[t]=new Array(256),ge[t]=new Array(256);for(var r=0,n=0,i,s,o,a,c,u,f,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Xt[r]=a,Fs[a]=r,c=e[a],i=e[r],s=e[i],o=e[s],u=c<<24^a<<16^a<<8^(a^c),f=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var l=0;l<4;++l)Br[l][r]=u,ge[l][a]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^e[e[e[i^o]]],n^=e[e[n]])}}function K0(e,t){for(var r=e.slice(0),n,i=1,s=r.length,o=s+6+1,a=rn*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=Xt[n>>>16&255]<<24^Xt[n>>>8&255]<<16^Xt[n&255]<<8^Xt[n>>>24]^N0[i]<<24,i++):s>6&&c%s===4&&(n=Xt[n>>>24]<<24^Xt[n>>>16&255]<<16^Xt[n>>>8&255]<<8^Xt[n&255]),r[c]=r[c-s]^n;if(t){var u,f=ge[0],l=ge[1],h=ge[2],y=ge[3],d=r.slice(0);a=r.length;for(var c=0,p=a-rn;c<a;c+=rn,p-=rn)if(c===0||c===a-rn)d[c]=r[p],d[c+1]=r[p+3],d[c+2]=r[p+2],d[c+3]=r[p+1];else for(var g=0;g<rn;++g)u=r[p+g],d[c+(3&-g)]=f[Xt[u>>>24]]^l[Xt[u>>>16&255]]^h[Xt[u>>>8&255]]^y[Xt[u&255]];r=d}return r}function qs(e,t,r,n){var i=e.length/4-1,s,o,a,c,u;n?(s=ge[0],o=ge[1],a=ge[2],c=ge[3],u=Fs):(s=Br[0],o=Br[1],a=Br[2],c=Br[3],u=Xt);var f,l,h,y,d,p,g;f=t[0]^e[0],l=t[n?3:1]^e[1],h=t[2]^e[2],y=t[n?1:3]^e[3];for(var x=3,w=1;w<i;++w)d=s[f>>>24]^o[l>>>16&255]^a[h>>>8&255]^c[y&255]^e[++x],p=s[l>>>24]^o[h>>>16&255]^a[y>>>8&255]^c[f&255]^e[++x],g=s[h>>>24]^o[y>>>16&255]^a[f>>>8&255]^c[l&255]^e[++x],y=s[y>>>24]^o[f>>>16&255]^a[l>>>8&255]^c[h&255]^e[++x],f=d,l=p,h=g;r[0]=u[f>>>24]<<24^u[l>>>16&255]<<16^u[h>>>8&255]<<8^u[y&255]^e[++x],r[n?3:1]=u[l>>>24]<<24^u[h>>>16&255]<<16^u[y>>>8&255]<<8^u[f&255]^e[++x],r[2]=u[h>>>24]<<24^u[y>>>16&255]<<16^u[f>>>8&255]<<8^u[l&255]^e[++x],r[n?1:3]=u[y>>>24]<<24^u[f>>>16&255]<<16^u[l>>>8&255]<<8^u[h&255]^e[++x]}function gi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=dt.cipher.createDecipher(r,e.key):n=dt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof dt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var q0=Q((Zm,F0)=>{var xt=lt();Ks();Ms();kt();F0.exports=xt.des=xt.des||{};xt.des.startEncrypting=function(e,t,r,n){var i=mi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};xt.des.createEncryptionCipher=function(e,t){return mi({key:e,output:null,decrypt:!1,mode:t})};xt.des.startDecrypting=function(e,t,r,n){var i=mi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};xt.des.createDecryptionCipher=function(e,t){return mi({key:e,output:null,decrypt:!0,mode:t})};xt.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return M0(r._keys,n,i,!1)},decrypt:function(n,i){return M0(r._keys,n,i,!0)}}}),r._init=!1};xt.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=xt.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Yh(t),this._init=!0}};Ce("DES-ECB",xt.cipher.modes.ecb);Ce("DES-CBC",xt.cipher.modes.cbc);Ce("DES-CFB",xt.cipher.modes.cfb);Ce("DES-OFB",xt.cipher.modes.ofb);Ce("DES-CTR",xt.cipher.modes.ctr);Ce("3DES-ECB",xt.cipher.modes.ecb);Ce("3DES-CBC",xt.cipher.modes.cbc);Ce("3DES-CFB",xt.cipher.modes.cfb);Ce("3DES-OFB",xt.cipher.modes.ofb);Ce("3DES-CTR",xt.cipher.modes.ctr);function Ce(e,t){var r=function(){return new xt.des.Algorithm(e,t)};xt.cipher.registerAlgorithm(e,r)}var qh=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Vh=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Hh=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],zh=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Gh=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Wh=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],$h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Qh=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Yh(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=e.length()>8?3:1,g=[],x=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,b,T=0;T<p;T++){var E=e.getInt32(),S=e.getInt32();b=(E>>>4^S)&252645135,S^=b,E^=b<<4,b=(S>>>-16^E)&65535,E^=b,S^=b<<-16,b=(E>>>2^S)&858993459,S^=b,E^=b<<2,b=(S>>>-16^E)&65535,E^=b,S^=b<<-16,b=(E>>>1^S)&1431655765,S^=b,E^=b<<1,b=(S>>>8^E)&16711935,E^=b,S^=b<<8,b=(E>>>1^S)&1431655765,S^=b,E^=b<<1,b=E<<8|S>>>20&240,E=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=b;for(var L=0;L<x.length;++L){x[L]?(E=E<<2|E>>>26,S=S<<2|S>>>26):(E=E<<1|E>>>27,S=S<<1|S>>>27),E&=-15,S&=-15;var k=t[E>>>28]|r[E>>>24&15]|n[E>>>20&15]|i[E>>>16&15]|s[E>>>12&15]|o[E>>>8&15]|a[E>>>4&15],G=c[S>>>28]|u[S>>>24&15]|f[S>>>20&15]|l[S>>>16&15]|h[S>>>12&15]|y[S>>>8&15]|d[S>>>4&15];b=(G>>>16^k)&65535,g[w++]=k^b,g[w++]=G^b<<16}}return g}function M0(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=t[0],c=t[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var f=s[u+1],l=s[u+2],h=s[u];h!=f;h+=l){var y=c^e[h],d=(c>>>4|c<<28)^e[h+1];o=a,a=c,c=o^(Vh[y>>>24&63]|zh[y>>>16&63]|Wh[y>>>8&63]|Qh[y&63]|qh[d>>>24&63]|Hh[d>>>16&63]|Gh[d>>>8&63]|$h[d&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function mi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=xt.cipher.createDecipher(r,e.key):n=xt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof xt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Ar=Q((Xm,V0)=>{var xi=lt();V0.exports=xi.md=xi.md||{};xi.md.algorithms=xi.md.algorithms||{}});var z0=Q((Jm,H0)=>{var qe=lt();Ar();kt();var Zh=H0.exports=qe.hmac=qe.hmac||{};Zh.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in qe.md.algorithms)t=qe.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(o===null)o=e;else{if(typeof o=="string")o=qe.util.createBuffer(o);else if(qe.util.isArray(o)){var a=o;o=qe.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=qe.util.createBuffer(),n=qe.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<t.blockLength)for(var a=t.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var vi=Q(()=>{});var W0=Q((e2,G0)=>{var Jt=lt();z0();Ar();kt();var Xh=Jt.pkcs5=Jt.pkcs5||{},Ve;Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&(Ve=vi());G0.exports=Jt.pbkdf2=Xh.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&Ve.pbkdf2&&(i===null||typeof i!="object")&&(Ve.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?Ve.pbkdf2Sync.length===4?Ve.pbkdf2(e,t,r,n,function(b,T){if(b)return s(b);s(null,T.toString("binary"))}):Ve.pbkdf2(e,t,r,n,i,function(b,T){if(b)return s(b);s(null,T.toString("binary"))}):Ve.pbkdf2Sync.length===4?Ve.pbkdf2Sync(e,t,r,n).toString("binary"):Ve.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Jt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Jt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),u=n-(c-1)*o,f=Jt.hmac.create();f.start(i,e);var l="",h,y,d;if(!s){for(var p=1;p<=c;++p){f.start(null,null),f.update(t),f.update(Jt.util.int32ToBytes(p)),h=d=f.digest().getBytes();for(var g=2;g<=r;++g)f.start(null,null),f.update(d),y=f.digest().getBytes(),h=Jt.util.xorBytes(h,y,o),d=y;l+=p<c?h:h.substr(0,u)}return l}var p=1,g;function x(){if(p>c)return s(null,l);f.start(null,null),f.update(t),f.update(Jt.util.int32ToBytes(p)),h=d=f.digest().getBytes(),g=2,w()}function w(){if(g<=r)return f.start(null,null),f.update(d),y=f.digest().getBytes(),h=Jt.util.xorBytes(h,y,o),d=y,++g,Jt.util.setImmediate(w);l+=p<c?h:h.substr(0,u),++p,x()}x()}});var Y0=Q((r2,Q0)=>{var wi=lt();kt();var $0=Q0.exports=wi.pem=wi.pem||{};$0.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=bi(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=bi(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=bi(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=bi(e.headers[i]);return e.procType&&(r+=`\r
`),r+=wi.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};$0.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:wi.util.decode64(s[3])};if(t.push(a),!!s[2]){for(var c=s[2].split(i),u=0;s&&u<c.length;){for(var f=c[u].replace(/\s+$/,""),l=u+1;l<c.length;++l){var h=c[l];if(!/\s/.test(h[0]))break;f+=h,u=l}if(s=f.match(n),s){for(var y={name:s[1],values:[]},d=s[2].split(","),p=0;p<d.length;++p)y.values.push(Jh(d[p]));if(a.procType)if(!a.contentDomain&&y.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&y.name==="DEK-Info"){if(y.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(y);else{if(y.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(y.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function bi(e){for(var t=e.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<t.length;++i,++s)if(s>65&&o!==-1){var a=t[o];a===","?(++o,t=t.substr(0,o)+`\r
 `+t.substr(o)):t=t.substr(0,o)+`\r
`+a+t.substr(o+1),s=i-o-1,o=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(o=i);return t}function Jh(e){return e.replace(/^\s+/,"")}});var ec=Q((n2,tc)=>{var Ie=lt();Ar();kt();var X0=tc.exports=Ie.sha256=Ie.sha256||{};Ie.md.sha256=Ie.md.algorithms.sha256=X0;X0.create=function(){J0||jh();var e=null,t=Ie.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Ie.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Ie.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),Z0(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Ie.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(zs.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Z0(l,r,i);var h=Ie.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h.putInt32(l.h5),h.putInt32(l.h6),h.putInt32(l.h7),h},n};var zs=null,J0=!1,j0=null;function jh(){zs=String.fromCharCode(128),zs+=Ie.util.fillString(String.fromCharCode(0),64),j0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],J0=!0}function Z0(e,t,r){for(var n,i,s,o,a,c,u,f,l,h,y,d,p,g,x,w=r.length();w>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=t[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(f=e.h0,l=e.h1,h=e.h2,y=e.h3,d=e.h4,p=e.h5,g=e.h6,x=e.h7,u=0;u<64;++u)o=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=g^d&(p^g),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&l|h&(f^l),n=x+o+a+j0[u]+t[u],i=s+c,x=g,g=p,p=d,d=y+n>>>0,y=h,h=l,l=f,f=n+i>>>0;e.h0=e.h0+f|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+y|0,e.h4=e.h4+d|0,e.h5=e.h5+p|0,e.h6=e.h6+g|0,e.h7=e.h7+x|0,w-=64}}});var nc=Q((i2,rc)=>{var _e=lt();kt();var Ei=null;_e.util.isNodejs&&!_e.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ei=vi());var td=rc.exports=_e.prng=_e.prng||{};td.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(u,f){if(!f)return t.generateSync(u);var l=t.plugin.cipher,h=t.plugin.increment,y=t.plugin.formatKey,d=t.plugin.formatSeed,p=_e.util.createBuffer();t.key=null,g();function g(x){if(x)return f(x);if(p.length()>=u)return f(null,p.getBytes(u));if(t.generated>1048575&&(t.key=null),t.key===null)return _e.util.nextTick(function(){s(g)});var w=l(t.key,t.seed);t.generated+=w.length,p.putBytes(w),t.key=y(l(t.key,h(t.seed))),t.seed=d(l(t.key,t.seed)),_e.util.setImmediate(g)}},t.generateSync=function(u){var f=t.plugin.cipher,l=t.plugin.increment,h=t.plugin.formatKey,y=t.plugin.formatSeed;t.key=null;for(var d=_e.util.createBuffer();d.length()<u;){t.generated>1048575&&(t.key=null),t.key===null&&o();var p=f(t.key,t.seed);t.generated+=p.length,d.putBytes(p),t.key=h(f(t.key,l(t.seed))),t.seed=y(f(t.key,t.seed))}return d.getBytes(u)};function s(u){if(t.pools[0].messageLength>=32)return a(),u();var f=32-t.pools[0].messageLength<<5;t.seedFile(f,function(l,h){if(l)return u(l);t.collect(h),a(),u()})}function o(){if(t.pools[0].messageLength>=32)return a();var u=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(u)),a()}function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var u=t.plugin.md.create();u.update(t.keyBytes);for(var f=1,l=0;l<32;++l)t.reseeds%f===0&&(u.update(t.pools[l].digest().getBytes()),t.pools[l].start()),f=f<<1;t.keyBytes=u.digest().getBytes(),u.start(),u.update(t.keyBytes);var h=u.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(h),t.generated=0}function c(u){var f=null,l=_e.util.globalScope,h=l.crypto||l.msCrypto;h&&h.getRandomValues&&(f=function(E){return h.getRandomValues(E)});var y=_e.util.createBuffer();if(f)for(;y.length()<u;){var d=Math.max(1,Math.min(u-y.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{f(p);for(var g=0;g<p.length;++g)y.putInt32(p[g])}catch(E){if(!(typeof QuotaExceededError<"u"&&E instanceof QuotaExceededError))throw E}}if(y.length()<u)for(var x,w,b,T=Math.floor(Math.random()*65536);y.length()<u;){w=16807*(T&65535),x=16807*(T>>16),w+=(x&32767)<<16,w+=x>>15,w=(w&2147483647)+(w>>31),T=w&4294967295;for(var g=0;g<3;++g)b=T>>>(g<<3),b^=Math.floor(Math.random()*256),y.putByte(b&255)}return y.getBytes(u)}return Ei?(t.seedFile=function(u,f){Ei.randomBytes(u,function(l,h){if(l)return f(l);f(null,h.toString())})},t.seedFileSync=function(u){return Ei.randomBytes(u).toString()}):(t.seedFile=function(u,f){try{f(null,c(u))}catch(l){f(l)}},t.seedFileSync=c),t.collect=function(u){for(var f=u.length,l=0;l<f;++l)t.pools[t.pool].update(u.substr(l,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(u,f){for(var l="",h=0;h<f;h+=8)l+=String.fromCharCode(u>>h&255);t.collect(l)},t.registerWorker=function(u){if(u===self)t.seedFile=function(l,h){function y(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",y),h(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:l}}})};else{var f=function(l){var h=l.data;h.forge&&h.forge.prng&&t.seedFile(h.forge.prng.needed,function(y,d){u.postMessage({forge:{prng:{err:y,bytes:d}}})})};u.addEventListener("message",f)}},t}});var Pn=Q((s2,Gs)=>{var qt=lt();Hs();ec();nc();kt();(function(){if(qt.random&&qt.random.getBytes){Gs.exports=qt.random;return}(function(e){var t={},r=new Array(4),n=qt.util.createBuffer();t.formatKey=function(l){var h=qt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),qt.aes._expandKey(l,!1)},t.formatSeed=function(l){var h=qt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),l},t.cipher=function(l,h){return qt.aes._updateBlock(l,h,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(l){return++l[3],l},t.md=qt.md.sha256;function i(){var l=qt.prng.create(t);return l.getBytes=function(h,y){return l.generate(h,y)},l.getBytesSync=function(h){return l.generate(h)},l}var s=i(),o=null,a=qt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(l){return c.getRandomValues(l)}),qt.options.usePureJavaScript||!qt.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch{}s.collect(u),u=null}e&&(e().mousemove(function(l){s.collectInt(l.clientX,16),s.collectInt(l.clientY,16)}),e().keypress(function(l){s.collectInt(l.charCode,8)}))}if(!qt.random)qt.random=s;else for(var f in s)qt.random[f]=s[f];qt.random.createInstance=i,Gs.exports=qt.random})(typeof jQuery<"u"?jQuery:null)})()});var ac=Q((o2,oc)=>{var ne=lt();kt();var Ws=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],ic=[1,2,3,5],ed=function(e,t){return e<<t&65535|(e&65535)>>16-t},rd=function(e,t){return(e&65535)>>t|e<<16-t&65535};oc.exports=ne.rc2=ne.rc2||{};ne.rc2.expandKey=function(e,t){typeof e=="string"&&(e=ne.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Ws[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Ws[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Ws[r.at(a+1)^r.at(a+s)]);return r};var sc=function(e,t,r){var n=!1,i=null,s=null,o=null,a,c,u,f,l=[];for(e=ne.rc2.expandKey(e,t),u=0;u<64;u++)l.push(e.getInt16Le());r?(a=function(d){for(u=0;u<4;u++)d[u]+=l[f]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),d[u]=ed(d[u],ic[u]),f++},c=function(d){for(u=0;u<4;u++)d[u]+=l[d[(u+3)%4]&63]}):(a=function(d){for(u=3;u>=0;u--)d[u]=rd(d[u],ic[u]),d[u]-=l[f]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),f--},c=function(d){for(u=3;u>=0;u--)d[u]-=l[d[(u+3)%4]&63]});var h=function(d){var p=[];for(u=0;u<4;u++){var g=i.getInt16Le();o!==null&&(r?g^=o.getInt16Le():o.putInt16Le(g)),p.push(g&65535)}f=r?0:63;for(var x=0;x<d.length;x++)for(var w=0;w<d[x][0];w++)d[x][1](p);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(p[u]):p[u]^=o.getInt16Le()),s.putInt16Le(p[u])},y=null;return y={start:function(d,p){d&&typeof d=="string"&&(d=ne.util.createBuffer(d)),n=!1,i=ne.util.createBuffer(),s=p||new ne.util.createBuffer,o=d,y.output=s},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var g=i.length()===8?8:8-i.length();i.fillWithByte(g,g)}if(p&&(n=!0,y.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,s,!r);else{var x=s.length(),w=s.at(x-1);w>x?p=!1:s.truncate(w)}return p}},y};ne.rc2.startEncrypting=function(e,t,r){var n=ne.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};ne.rc2.createEncryptionCipher=function(e,t){return sc(e,t,!0)};ne.rc2.startDecrypting=function(e,t,r){var n=ne.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};ne.rc2.createDecryptionCipher=function(e,t){return sc(e,t,!1)}});var Ai=Q((a2,yc)=>{var $s=lt();yc.exports=$s.jsbn=$s.jsbn||{};var He,nd=0xdeadbeefcafe,cc=(nd&16777215)==15715070;function C(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}$s.jsbn.BigInteger=C;function nt(){return new C(null)}function id(e,t,r,n,i,s){for(;--s>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function sd(e,t,r,n,i,s){for(var o=t&32767,a=t>>15;--s>=0;){var c=this.data[e]&32767,u=this.data[e++]>>15,f=a*c+u*o;c=o*c+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(f>>>15)+a*u+(i>>>30),r.data[n++]=c&1073741823}return i}function uc(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var c=this.data[e]&16383,u=this.data[e++]>>14,f=a*c+u*o;c=o*c+((f&16383)<<14)+r.data[n]+i,i=(c>>28)+(f>>14)+a*u,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(C.prototype.am=uc,He=28):cc&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=sd,He=30):cc&&navigator.appName!="Netscape"?(C.prototype.am=id,He=26):(C.prototype.am=uc,He=28);C.prototype.DB=He;C.prototype.DM=(1<<He)-1;C.prototype.DV=1<<He;var Qs=52;C.prototype.FV=Math.pow(2,Qs);C.prototype.F1=Qs-He;C.prototype.F2=2*He-Qs;var od="0123456789abcdefghijklmnopqrstuvwxyz",Si=new Array,sn,he;sn="0".charCodeAt(0);for(he=0;he<=9;++he)Si[sn++]=he;sn="a".charCodeAt(0);for(he=10;he<36;++he)Si[sn++]=he;sn="A".charCodeAt(0);for(he=10;he<36;++he)Si[sn++]=he;function fc(e){return od.charAt(e)}function lc(e,t){var r=Si[e.charCodeAt(t)];return r??-1}function ad(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function cd(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function or(e){var t=nt();return t.fromInt(e),t}function ud(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=r==8?e[n]&255:lc(e,n);if(o<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&C.ZERO.subTo(this,this)}function fd(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function ld(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=fc(n));o>=0;)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=fc(n));return i?s:"0"}function hd(){var e=nt();return C.ZERO.subTo(this,e),e}function dd(){return this.s<0?this.negate():this}function pd(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Bi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function yd(){return this.t<=0?0:this.DB*(this.t-1)+Bi(this.data[this.t-1]^this.s&this.DM)}function gd(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function md(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function xd(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)t.data[a]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function vd(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function bd(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function wd(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&C.ZERO.subTo(t,t)}function Ed(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function Sd(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=nt());var s=nt(),o=this.s,a=e.s,c=this.DB-Bi(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,f=s.data[u-1];if(f!=0){var l=f*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/l,y=(1<<this.F1)/l,d=1<<this.F2,p=r.t,g=p-u,x=t??nt();for(s.dlShiftTo(g,x),r.compareTo(x)>=0&&(r.data[r.t++]=1,r.subTo(x,r)),C.ONE.dlShiftTo(u,x),x.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--g>=0;){var w=r.data[--p]==f?this.DM:Math.floor(r.data[p]*h+(r.data[p-1]+d)*y);if((r.data[p]+=s.am(0,w,r,g,0,u))<w)for(s.dlShiftTo(g,x),r.subTo(x,r);r.data[p]<--w;)r.subTo(x,r)}t!=null&&(r.drShiftTo(u,t),o!=a&&C.ZERO.subTo(t,t)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&C.ZERO.subTo(r,r)}}}function Bd(e){var t=nt();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(C.ZERO)>0&&e.subTo(t,t),t}function Cr(e){this.m=e}function Ad(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function Cd(e){return e}function Id(e){e.divRemTo(this.m,null,e)}function _d(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Td(e,t){e.squareTo(t),this.reduce(t)}Cr.prototype.convert=Ad;Cr.prototype.revert=Cd;Cr.prototype.reduce=Id;Cr.prototype.mulTo=_d;Cr.prototype.sqrTo=Td;function Rd(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Ir(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Ld(e){var t=nt();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(C.ZERO)>0&&this.m.subTo(t,t),t}function kd(e){var t=nt();return e.copyTo(t),this.reduce(t),t}function Pd(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Dd(e,t){e.squareTo(t),this.reduce(t)}function Nd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Ir.prototype.convert=Ld;Ir.prototype.revert=kd;Ir.prototype.reduce=Pd;Ir.prototype.mulTo=Nd;Ir.prototype.sqrTo=Dd;function Ud(){return(this.t>0?this.data[0]&1:this.s)==0}function Kd(e,t){if(e>4294967295||e<1)return C.ONE;var r=nt(),n=nt(),i=t.convert(this),s=Bi(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}function Od(e,t){var r;return e<256||t.isEven()?r=new Cr(t):r=new Ir(t),this.exp(e,r)}C.prototype.copyTo=ad;C.prototype.fromInt=cd;C.prototype.fromString=ud;C.prototype.clamp=fd;C.prototype.dlShiftTo=gd;C.prototype.drShiftTo=md;C.prototype.lShiftTo=xd;C.prototype.rShiftTo=vd;C.prototype.subTo=bd;C.prototype.multiplyTo=wd;C.prototype.squareTo=Ed;C.prototype.divRemTo=Sd;C.prototype.invDigit=Rd;C.prototype.isEven=Ud;C.prototype.exp=Kd;C.prototype.toString=ld;C.prototype.negate=hd;C.prototype.abs=dd;C.prototype.compareTo=pd;C.prototype.bitLength=yd;C.prototype.mod=Bd;C.prototype.modPowInt=Od;C.ZERO=or(0);C.ONE=or(1);function Md(){var e=nt();return this.copyTo(e),e}function Fd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function qd(){return this.t==0?this.s:this.data[0]<<24>>24}function Vd(){return this.t==0?this.s:this.data[0]<<16>>16}function Hd(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function zd(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Gd(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=or(r),i=nt(),s=nt(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}function Wd(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var c=lc(e,a);if(c<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&C.ZERO.subTo(this,this)}function $d(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(C.ONE.shiftLeft(e-1),Ys,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(C.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Qd(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Yd(e){return this.compareTo(e)==0}function Zd(e){return this.compareTo(e)<0?this:e}function Xd(e){return this.compareTo(e)>0?this:e}function Jd(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function jd(e,t){return e&t}function tp(e){var t=nt();return this.bitwiseTo(e,jd,t),t}function Ys(e,t){return e|t}function ep(e){var t=nt();return this.bitwiseTo(e,Ys,t),t}function hc(e,t){return e^t}function rp(e){var t=nt();return this.bitwiseTo(e,hc,t),t}function dc(e,t){return e&~t}function np(e){var t=nt();return this.bitwiseTo(e,dc,t),t}function ip(){for(var e=nt(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function sp(e){var t=nt();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function op(e){var t=nt();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ap(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function cp(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+ap(this.data[e]);return this.s<0?this.t*this.DB:-1}function up(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function fp(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=up(this.data[r]^t);return e}function lp(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function hp(e,t){var r=C.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function dp(e){return this.changeBit(e,Ys)}function pp(e){return this.changeBit(e,dc)}function yp(e){return this.changeBit(e,hc)}function gp(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function mp(e){var t=nt();return this.addTo(e,t),t}function xp(e){var t=nt();return this.subTo(e,t),t}function vp(e){var t=nt();return this.multiplyTo(e,t),t}function bp(e){var t=nt();return this.divRemTo(e,t,null),t}function wp(e){var t=nt();return this.divRemTo(e,null,t),t}function Ep(e){var t=nt(),r=nt();return this.divRemTo(e,t,r),new Array(t,r)}function Sp(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Bp(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Dn(){}function pc(e){return e}function Ap(e,t,r){e.multiplyTo(t,r)}function Cp(e,t){e.squareTo(t)}Dn.prototype.convert=pc;Dn.prototype.revert=pc;Dn.prototype.mulTo=Ap;Dn.prototype.sqrTo=Cp;function Ip(e){return this.exp(e,new Dn)}function _p(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function Tp(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function on(e){this.r2=nt(),this.q3=nt(),C.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Rp(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=nt();return e.copyTo(t),this.reduce(t),t}function Lp(e){return e}function kp(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Pp(e,t){e.squareTo(t),this.reduce(t)}function Dp(e,t,r){e.multiplyTo(t,r),this.reduce(r)}on.prototype.convert=Rp;on.prototype.revert=Lp;on.prototype.reduce=kp;on.prototype.mulTo=Dp;on.prototype.sqrTo=Pp;function Np(e,t){var r=e.bitLength(),n,i=or(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Cr(t):t.isEven()?s=new on(t):s=new Ir(t);var o=new Array,a=3,c=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var f=nt();for(s.sqrTo(o[1],f);a<=u;)o[a]=nt(),s.mulTo(f,o[a-2],o[a]),a+=2}var l=e.t-1,h,y=!0,d=nt(),p;for(r=Bi(e.data[l])-1;l>=0;){for(r>=c?h=e.data[l]>>r-c&u:(h=(e.data[l]&(1<<r+1)-1)<<c-r,l>0&&(h|=e.data[l-1]>>this.DB+r-c)),a=n;!(h&1);)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--l),y)o[h].copyTo(i),y=!1;else{for(;a>1;)s.sqrTo(i,d),s.sqrTo(d,i),a-=2;a>0?s.sqrTo(i,d):(p=i,i=d,d=p),s.mulTo(d,o[h],i)}for(;l>=0&&!(e.data[l]&1<<r);)s.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--l)}return s.revert(i)}function Up(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Kp(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function Op(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return C.ZERO;for(var r=e.clone(),n=this.clone(),i=or(1),s=or(0),o=or(0),a=or(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var me=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Mp=(1<<26)/me[me.length-1];function Fp(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=me[me.length-1]){for(t=0;t<me.length;++t)if(r.data[0]==me[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<me.length;){for(var n=me[t],i=t+1;i<me.length&&n<Mp;)n*=me[i++];for(n=r.modInt(n);t<i;)if(n%me[t++]==0)return!1}return r.millerRabin(e)}function qp(e){var t=this.subtract(C.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=Vp(),s,o=0;o<e;++o){do s=new C(this.bitLength(),i);while(s.compareTo(C.ONE)<=0||s.compareTo(t)>=0);var a=s.modPow(n,this);if(a.compareTo(C.ONE)!=0&&a.compareTo(t)!=0){for(var c=1;c++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(C.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}function Vp(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=Hd;C.prototype.toRadix=Gd;C.prototype.fromRadix=Wd;C.prototype.fromNumber=$d;C.prototype.bitwiseTo=Jd;C.prototype.changeBit=hp;C.prototype.addTo=gp;C.prototype.dMultiply=Sp;C.prototype.dAddOffset=Bp;C.prototype.multiplyLowerTo=_p;C.prototype.multiplyUpperTo=Tp;C.prototype.modInt=Kp;C.prototype.millerRabin=qp;C.prototype.clone=Md;C.prototype.intValue=Fd;C.prototype.byteValue=qd;C.prototype.shortValue=Vd;C.prototype.signum=zd;C.prototype.toByteArray=Qd;C.prototype.equals=Yd;C.prototype.min=Zd;C.prototype.max=Xd;C.prototype.and=tp;C.prototype.or=ep;C.prototype.xor=rp;C.prototype.andNot=np;C.prototype.not=ip;C.prototype.shiftLeft=sp;C.prototype.shiftRight=op;C.prototype.getLowestSetBit=cp;C.prototype.bitCount=fp;C.prototype.testBit=lp;C.prototype.setBit=dp;C.prototype.clearBit=pp;C.prototype.flipBit=yp;C.prototype.add=mp;C.prototype.subtract=xp;C.prototype.multiply=vp;C.prototype.divide=bp;C.prototype.remainder=wp;C.prototype.divideAndRemainder=Ep;C.prototype.modPow=Np;C.prototype.modInverse=Op;C.prototype.pow=Ip;C.prototype.gcd=Up;C.prototype.isProbablePrime=Fp});var bc=Q((c2,vc)=>{var Te=lt();Ar();kt();var mc=vc.exports=Te.sha1=Te.sha1||{};Te.md.sha1=Te.md.algorithms.sha1=mc;mc.create=function(){xc||Hp();var e=null,t=Te.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Te.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Te.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),gc(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Te.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Zs.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};gc(l,r,i);var h=Te.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h},n};var Zs=null,xc=!1;function Hp(){Zs=String.fromCharCode(128),Zs+=Te.util.fillString(String.fromCharCode(0),64),xc=!0}function gc(e,t,r){for(var n,i,s,o,a,c,u,f,l=r.length();l>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,c=e.h4,f=0;f<16;++f)n=r.getInt32(),t[f]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<20;++f)n=t[f-3]^t[f-8]^t[f-14]^t[f-16],n=n<<1|n>>>31,t[f]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<32;++f)n=t[f-3]^t[f-8]^t[f-14]^t[f-16],n=n<<1|n>>>31,t[f]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<40;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<60;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<80;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,l-=64}}});var Sc=Q((u2,Ec)=>{var Re=lt();kt();Pn();bc();var wc=Ec.exports=Re.pkcs1=Re.pkcs1||{};wc.encode_rsa_oaep=function(e,t,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Re.md.sha1.create(),o||(o=s);var a=Math.ceil(e.n.bitLength()/8),c=a-2*s.digestLength-2;if(t.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=t.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var f=s.digest(),l="",h=c-t.length,y=0;y<h;y++)l+="\0";var d=f.getBytes()+l+""+t;if(!i)i=Re.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var p=Ci(i,a-s.digestLength-1,o),g=Re.util.xorBytes(d,p,d.length),x=Ci(g,s.digestLength,o),w=Re.util.xorBytes(i,x,i.length);return"\0"+w+g};wc.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=t.length,g.expectedLength=o,g}if(i===void 0?i=Re.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=t.charAt(0),u=t.substring(1,i.digestLength+1),f=t.substring(1+i.digestLength),l=Ci(f,i.digestLength,s),h=Re.util.xorBytes(u,l,u.length),y=Ci(h,o-i.digestLength-1,s),d=Re.util.xorBytes(f,y,f.length),p=d.substring(0,i.digestLength),g=c!=="\0",x=0;x<i.digestLength;++x)g|=a.charAt(x)!==p.charAt(x);for(var w=1,b=i.digestLength,T=i.digestLength;T<d.length;T++){var E=d.charCodeAt(T),S=E&1^1,L=w?65534:0;g|=E&L,w=w&S,b+=w}if(g||d.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)};function Ci(e,t,r){r||(r=Re.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+o),n+=r.digest().getBytes()}return n.substring(0,t)}});var Bc=Q((f2,Xs)=>{var ar=lt();kt();Ai();Pn();(function(){if(ar.prime){Xs.exports=ar.prime;return}var e=Xs.exports=ar.prime=ar.prime||{},t=ar.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(l,h){return l|h};e.generateProbablePrime=function(l,h,y){typeof h=="function"&&(y=h,h={}),h=h||{};var d=h.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=h.prng||ar.random,g={nextBytes:function(x){for(var w=p.getBytesSync(x.length),b=0;b<x.length;++b)x[b]=w.charCodeAt(b)}};if(d.name==="PRIMEINC")return s(l,g,d.options,y);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(l,h,y,d){return"workers"in y?c(l,h,y,d):o(l,h,y,d)}function o(l,h,y,d){var p=u(l,h),g=0,x=f(p.bitLength());"millerRabinTests"in y&&(x=y.millerRabinTests);var w=10;"maxBlockTime"in y&&(w=y.maxBlockTime),a(p,l,h,g,x,w,d)}function a(l,h,y,d,p,g,x){var w=+new Date;do{if(l.bitLength()>h&&(l=u(h,y)),l.isProbablePrime(p))return x(null,l);l.dAddOffset(r[d++%8],0)}while(g<0||+new Date-w<g);ar.util.setImmediate(function(){a(l,h,y,d,p,g,x)})}function c(l,h,y,d){if(typeof Worker>"u")return o(l,h,y,d);var p=u(l,h),g=y.workers,x=y.workLoad||100,w=x*30/8,b=y.workerScript||"forge/prime.worker.js";if(g===-1)return ar.util.estimateCores(function(E,S){E&&(S=2),g=S-1,T()});T();function T(){g=Math.max(1,g);for(var E=[],S=0;S<g;++S)E[S]=new Worker(b);for(var L=g,S=0;S<g;++S)E[S].addEventListener("message",G);var k=!1;function G(W){if(!k){--L;var H=W.data;if(H.found){for(var j=0;j<E.length;++j)E[j].terminate();return k=!0,d(null,new t(H.prime,16))}p.bitLength()>l&&(p=u(l,h));var ft=p.toString(16);W.target.postMessage({hex:ft,workLoad:x}),p.dAddOffset(w,0)}}}}function u(l,h){var y=new t(l,h),d=l-1;return y.testBit(d)||y.bitwiseTo(t.ONE.shiftLeft(d),i,y),y.dAddOffset(31-y.mod(n).byteValue(),0),y}function f(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}})()});var _i=Q((l2,Lc)=>{var V=lt();kn();Ai();hi();Sc();Bc();Pn();kt();typeof rt>"u"&&(rt=V.jsbn.BigInteger);var rt,Js=V.util.isNodejs?vi():null,v=V.asn1,de=V.util;V.pki=V.pki||{};Lc.exports=V.pki.rsa=V.rsa=V.rsa||{};var $=V.pki,zp=[6,4,2,4,2,4,6,2],Gp={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Wp={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},$p={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Qp=V.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Yp={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Zp=function(e){var t;if(e.algorithm in $.oids)t=$.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=v.oidToDer(t).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),s=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);s.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),s.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var o=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(o),v.toDer(i).getBytes()},Tc=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(rt.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(rt.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new rt(V.util.bytesToHex(V.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(rt.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var o=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return o=o.multiply(n.modInverse(t.n)).mod(t.n),o};$.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Rc(e,t,r)):(i=V.util.createBuffer(),i.putBytes(e));for(var o=new rt(i.toHex(),16),a=Tc(o,t,n),c=a.toString(16),u=V.util.createBuffer(),f=s-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(V.util.hexToBytes(c)),u.getBytes()};$.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var o=new rt(V.util.createBuffer(e).toHex(),16);if(o.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Tc(o,t,r),c=a.toString(16),u=V.util.createBuffer(),f=i-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(V.util.hexToBytes(c)),n!==!1?Ii(u.getBytes(),t,r):u.getBytes()};$.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||V.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new rt(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};$.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new rt(null);r.fromInt(30);for(var n=0,i=function(l,h){return l|h},s=+new Date,o,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var c=e.p===null?e.pBits:e.qBits,u=c-1;e.pqState===0?(e.num=new rt(c,e.rng),e.num.testBit(u)||e.num.bitwiseTo(rt.ONE.shiftLeft(u),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(Jp(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(zp[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(rt.ONE).gcd(e.e).compareTo(rt.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(rt.ONE),e.q1=e.q.subtract(rt.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(rt.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var f=e.e.modInverse(e.phi);e.keys={privateKey:$.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:$.rsa.setPublicKey(e.n,e.e)}}o=+new Date,a+=o-s,s=o}return e.keys!==null};$.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!V.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(Ac("generateKeyPair"))return Js.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:$.privateKeyFromPem(u),publicKey:$.publicKeyFromPem(c)})});if(Cc("generateKey")&&Cc("exportKey"))return de.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_c(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return de.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=$.privateKeyFromAsn1(v.fromDer(V.util.createBuffer(a)));n(null,{privateKey:c,publicKey:$.setRsaPublicKey(c.n,c.e)})}});if(Ic("generateKey")&&Ic("exportKey")){var i=de.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:_c(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,u=de.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(f){var l=f.target.result,h=$.privateKeyFromAsn1(v.fromDer(V.util.createBuffer(l)));n(null,{privateKey:h,publicKey:$.setRsaPublicKey(h.n,h.e)})},u.onerror=function(f){n(f)}},i.onerror=function(a){n(a)};return}}else if(Ac("generateKeyPairSync")){var s=Js.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:$.privateKeyFromPem(s.privateKey),publicKey:$.publicKeyFromPem(s.publicKey)}}}var o=$.rsa.createKeyPairGenerationState(e,t,r);if(!n)return $.rsa.stepKeyPairGenerationState(o,0),o.keys;Xp(o,r,n)};$.setRsaPublicKey=$.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,u){return Rc(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return V.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return $.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=Ii(u,r,!0);var f=v.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),l={},h=[];if(!v.validate(f,Yp,l,h)){var y=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw y.errors=h,y}var d=v.derToOid(l.algorithmIdentifier);if(!(d===V.oids.md2||d===V.oids.md5||d===V.oids.sha1||d===V.oids.sha224||d===V.oids.sha256||d===V.oids.sha384||d===V.oids.sha512||d===V.oids["sha512-224"]||d===V.oids["sha512-256"])){var y=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw y.oid=d,y}if((d===V.oids.md2||d===V.oids.md5)&&!("parameters"in l))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===l.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=Ii(u,r,!0),c===u}});var a=$.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};$.setRsaPrivateKey=$.rsa.setPrivateKey=function(e,t,r,n,i,s,o,a){var c={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,f,l){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var h=$.rsa.decrypt(u,c,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:Ii};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(y,d){return V.pkcs1.decode_rsa_oaep(d,y,l)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(h,c,!1)},c.sign=function(u,f){var l=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:Zp},l=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return u}},l=1);var h=f.encode(u,c.n.bitLength());return $.rsa.encrypt(h,c,l)},c};$.wrapRsaPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer($.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(e).getBytes())])};$.privateKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,Gp,t,r)&&(e=v.fromDer(V.util.createBuffer(t.privateKey))),t={},r=[],!v.validate(e,Wp,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,u,f,l;return i=V.util.createBuffer(t.privateKeyModulus).toHex(),s=V.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=V.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=V.util.createBuffer(t.privateKeyPrime1).toHex(),c=V.util.createBuffer(t.privateKeyPrime2).toHex(),u=V.util.createBuffer(t.privateKeyExponent1).toHex(),f=V.util.createBuffer(t.privateKeyExponent2).toHex(),l=V.util.createBuffer(t.privateKeyCoefficient).toHex(),$.setRsaPrivateKey(new rt(i,16),new rt(s,16),new rt(o,16),new rt(a,16),new rt(c,16),new rt(u,16),new rt(f,16),new rt(l,16))};$.privateKeyToAsn1=$.privateKeyToRSAPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.qInv))])};$.publicKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,Qp,t,r)){var n=v.derToOid(t.publicKeyOid);if(n!==$.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!v.validate(e,$p,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=V.util.createBuffer(t.publicKeyModulus).toHex(),o=V.util.createBuffer(t.publicKeyExponent).toHex();return $.setRsaPublicKey(new rt(s,16),new rt(o,16))};$.publicKeyToAsn1=$.publicKeyToSubjectPublicKeyInfo=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer($.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[$.publicKeyToRSAPublicKey(e)])])};$.publicKeyToRSAPublicKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Le(e.e))])};function Rc(e,t,r){var n=V.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var u=0,f=V.random.getBytes(o),c=0;c<o;++c)a=f.charCodeAt(c),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(e),n}function Ii(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=V.util.createBuffer(e),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var f=s.getByte();if(f!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Xp(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(a,c){if(a)return r(a);if(e.p=c,e.q!==null)return o(a,e.q);s(e.qBits,o)})}function s(a,c){V.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(e.q=c,e.p.compareTo(e.q)<0){var u=e.p;e.p=e.q,e.q=u}if(e.p.subtract(rt.ONE).gcd(e.e).compareTo(rt.ONE)!==0){e.p=null,i();return}if(e.q.subtract(rt.ONE).gcd(e.e).compareTo(rt.ONE)!==0){e.q=null,s(e.qBits,o);return}if(e.p1=e.p.subtract(rt.ONE),e.q1=e.q.subtract(rt.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(rt.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,o);return}var f=e.e.modInverse(e.phi);e.keys={privateKey:$.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:$.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function Le(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=V.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Jp(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function Ac(e){return V.util.isNodejs&&typeof Js[e]=="function"}function Cc(e){return typeof de.globalScope<"u"&&typeof de.globalScope.crypto=="object"&&typeof de.globalScope.crypto.subtle=="object"&&typeof de.globalScope.crypto.subtle[e]=="function"}function Ic(e){return typeof de.globalScope<"u"&&typeof de.globalScope.msCrypto=="object"&&typeof de.globalScope.msCrypto.subtle=="object"&&typeof de.globalScope.msCrypto.subtle[e]=="function"}function _c(e){for(var t=V.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Kc=Q((h2,Uc)=>{var U=lt();Hs();kn();q0();Ar();hi();W0();Y0();Pn();ac();_i();kt();typeof kc>"u"&&(kc=U.jsbn.BigInteger);var kc,B=U.asn1,Y=U.pki=U.pki||{};Uc.exports=Y.pbe=U.pbe=U.pbe||{};var _r=Y.oids,jp={name:"EncryptedPrivateKeyInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},ty={name:"PBES2Algorithms",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},ey={name:"pkcs-12PbeParams",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"iterations"}]};Y.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,s=B.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,f,l;switch(r.algorithm){case"aes128":o=16,u=16,f=_r["aes128-CBC"],l=U.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,f=_r["aes192-CBC"],l=U.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,f=_r["aes256-CBC"],l=U.aes.createEncryptionCipher;break;case"des":o=8,u=8,f=_r.desCBC,l=U.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Nc(y),p=U.pkcs5.pbkdf2(t,n,i,o,d),g=U.random.getBytesSync(u),x=l(p);x.start(g),x.update(B.toDer(e)),x.finish(),c=x.output.getBytes();var w=ry(n,s,o,y);a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(_r.pkcs5PBES2).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(_r.pkcs5PBKDF2).getBytes()),w]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(f).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){o=24;var b=new U.util.ByteBuffer(n),p=Y.pbe.generatePkcs12Key(t,b,1,i,o),g=Y.pbe.generatePkcs12Key(t,b,2,i,o),x=U.des.createEncryptionCipher(p);x.start(g),x.update(B.toDer(e)),x.finish(),c=x.output.getBytes(),a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(_r["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,n),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var T=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[a,B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,c)]);return T};Y.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!B.validate(e,jp,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=B.derToOid(n.encryptionOid),a=Y.pbe.getCipher(o,n.encryptionParams,t),c=U.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=B.fromDer(a.output)),r};Y.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:B.toDer(e).getBytes()};return U.pem.encode(r,{maxline:t})};Y.encryptedPrivateKeyFromPem=function(e){var t=U.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return B.fromDer(t.body)};Y.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=Y.wrapRsaPrivateKey(Y.privateKeyToAsn1(e));return n=Y.encryptPrivateKeyInfo(n,t,r),Y.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=U.pbe.opensslDeriveBytes(t,s.substr(0,8),o),f=a(u);f.start(s),f.update(B.toDer(Y.privateKeyToAsn1(e))),f.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return U.pem.encode(l)};Y.decryptRsaPrivateKey=function(e,t){var r=null,n=U.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=U.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=U.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=U.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(l){return U.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":s=8,o=function(l){return U.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":s=16,o=function(l){return U.rc2.createDecryptionCipher(l,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=U.util.hexToBytes(n.dekInfo.parameters),c=U.pbe.opensslDeriveBytes(t,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(U.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Y.decryptPrivateKeyInfo(B.fromDer(r),t):r=B.fromDer(r),r!==null&&(r=Y.privateKeyFromAsn1(r)),r};Y.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');s=U.md.sha1.create()}var c=s.digestLength,u=s.blockLength,f=new U.util.ByteBuffer,l=new U.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)l.putInt16(e.charCodeAt(a));l.putInt16(0)}var h=l.length(),y=t.length(),d=new U.util.ByteBuffer;d.fillWithByte(r,u);var p=u*Math.ceil(y/u),g=new U.util.ByteBuffer;for(a=0;a<p;a++)g.putByte(t.at(a%y));var x=u*Math.ceil(h/u),w=new U.util.ByteBuffer;for(a=0;a<x;a++)w.putByte(l.at(a%h));var b=g;b.putBuffer(w);for(var T=Math.ceil(i/c),E=1;E<=T;E++){var S=new U.util.ByteBuffer;S.putBytes(d.bytes()),S.putBytes(b.bytes());for(var L=0;L<n;L++)s.start(),s.update(S.getBytes()),S=s.digest();var k=new U.util.ByteBuffer;for(a=0;a<u;a++)k.putByte(S.at(a%c));var G=Math.ceil(y/u)+Math.ceil(h/u),W=new U.util.ByteBuffer;for(o=0;o<G;o++){var H=new U.util.ByteBuffer(b.getBytes(u)),j=511;for(a=k.length()-1;a>=0;a--)j=j>>8,j+=k.at(a)+H.at(a),H.setAt(a,j&255);W.putBuffer(H)}b=W,f.putBuffer(S)}return f.truncate(f.length()-i),f};Y.pbe.getCipher=function(e,t,r){switch(e){case Y.oids.pkcs5PBES2:return Y.pbe.getCipherForPBES2(e,t,r);case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:return Y.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Y.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!B.validate(t,ty,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=B.derToOid(n.kdfOid),e!==Y.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=B.derToOid(n.encOid),e!==Y.oids["aes128-CBC"]&&e!==Y.oids["aes192-CBC"]&&e!==Y.oids["aes256-CBC"]&&e!==Y.oids["des-EDE3-CBC"]&&e!==Y.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=U.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(Y.oids[e]){case"aes128-CBC":c=16,u=U.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=U.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=U.des.createDecryptionCipher;break;case"desCBC":c=8,u=U.des.createDecryptionCipher;break}var f=Dc(n.prfOid),l=U.pkcs5.pbkdf2(r,o,a,c,f),h=n.encIv,y=u(l);return y.start(h),y};Y.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!B.validate(t,ey,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=U.util.createBuffer(n.salt),a=U.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,f;switch(e){case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,f=U.des.startDecrypting;break;case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,f=function(p,g){var x=U.rc2.createDecryptionCipher(p,40);return x.start(g,null),x};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var l=Dc(n.prfOid),h=Y.pbe.generatePkcs12Key(r,o,1,a,c,l);l.start();var y=Y.pbe.generatePkcs12Key(r,o,2,a,u,l);return f(h,y)};Y.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}t===null&&(t="");for(var i=[Pc(n,e+t)],s=16,o=1;s<r;++o,s+=16)i.push(Pc(n,i[o-1]+e+t));return i.join("").substr(0,r)};function Pc(e,t){return e.start().update(t).digest().getBytes()}function Dc(e){var t;if(!e)t="hmacWithSHA1";else if(t=Y.oids[B.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Nc(t)}function Nc(e){var t=U.md;switch(e){case"hmacWithSHA224":t=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function ry(e,t,r,n){var i=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,e),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Y.oids[n]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),i}});var Su=Q((Wx,Eu)=>{"use strict";Eu.exports=Y1;function Y1(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(f){if(s)if(s=!1,f)c(f);else{for(var l=new Array(arguments.length-1),h=0;h<l.length;)l[h++]=arguments[h];a.apply(null,l)}};try{e.apply(t||null,r)}catch(u){s&&(s=!1,c(u))}})}});var Iu=Q(Cu=>{"use strict";var Gi=Cu;Gi.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var mn=new Array(64),Au=new Array(123);for(we=0;we<64;)Au[mn[we]=we<26?we+65:we<52?we+71:we<62?we-4:we-59|43]=we++;var we;Gi.encode=function(t,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var u=t[r++];switch(a){case 0:s[o++]=mn[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=mn[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=mn[c|u>>6],s[o++]=mn[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=mn[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Bu="invalid encoding";Gi.decode=function(t,r,n){for(var i=n,s=0,o,a=0;a<t.length;){var c=t.charCodeAt(a++);if(c===61&&s>1)break;if((c=Au[c])===void 0)throw Error(Bu);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Bu);return n-i};Gi.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var Tu=Q((Qx,_u)=>{"use strict";_u.exports=Wi;function Wi(){this._listeners={}}Wi.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};Wi.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Wi.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Uu=Q((Yx,Nu)=>{"use strict";Nu.exports=Ru(Ru);function Ru(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(c,u,f){t[0]=c,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3]}function s(c,u,f){t[0]=c,u[f]=r[3],u[f+1]=r[2],u[f+2]=r[1],u[f+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],t[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],t[0]}e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,o)}}e.writeFloatLE=t.bind(null,Lu),e.writeFloatBE=t.bind(null,ku);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}e.readFloatLE=r.bind(null,Pu),e.readFloatBE=r.bind(null,Du)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(c,u,f){t[0]=c,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3],u[f+4]=r[4],u[f+5]=r[5],u[f+6]=r[6],u[f+7]=r[7]}function s(c,u,f){t[0]=c,u[f]=r[7],u[f+1]=r[6],u[f+2]=r[5],u[f+3]=r[4],u[f+4]=r[3],u[f+5]=r[2],u[f+6]=r[1],u[f+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],t[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],t[0]}e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(n,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+s);else{var f;if(o<22250738585072014e-324)f=o/5e-324,n(f>>>0,a,c+i),n((u<<31|f/4294967296)>>>0,a,c+s);else{var l=Math.floor(Math.log(o)/Math.LN2);l===1024&&(l=1023),f=o*Math.pow(2,-l),n(f*4503599627370496>>>0,a,c+i),n((u<<31|l+1023<<20|f*1048576&1048575)>>>0,a,c+s)}}}e.writeDoubleLE=t.bind(null,Lu,0,4),e.writeDoubleBE=t.bind(null,ku,4,0);function r(n,i,s,o,a){var c=n(o,a+i),u=n(o,a+s),f=(u>>31)*2+1,l=u>>>20&2047,h=4294967296*(u&1048575)+c;return l===2047?h?NaN:f*(1/0):l===0?f*5e-324*h:f*Math.pow(2,l-1075)*(h+4503599627370496)}e.readDoubleLE=r.bind(null,Pu,0,4),e.readDoubleBE=r.bind(null,Du,4,0)}(),e}function Lu(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function ku(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function Pu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Du(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var Ku=Q((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Mu=Q(Ou=>{"use strict";var ko=Ou;ko.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};ko.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=t[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|t[r++]&63:c>239&&c<365?(c=((c&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(t[r++]&63)<<6|t[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};ko.write=function(t,r,n){for(var i=n,s,o,a=0;a<t.length;++a)s=t.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var qu=Q((Xx,Fu)=>{"use strict";Fu.exports=Z1;function Z1(e,t,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return e(c);o+c>n&&(s=e(n),o=0);var u=t.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var Hu=Q((Jx,Vu)=>{"use strict";Vu.exports=Vt;var qn=Ur();function Vt(e,t){this.lo=e>>>0,this.hi=t>>>0}var Nr=Vt.zero=new Vt(0,0);Nr.toNumber=function(){return 0};Nr.zzEncode=Nr.zzDecode=function(){return this};Nr.length=function(){return 1};var X1=Vt.zeroHash="\0\0\0\0\0\0\0\0";Vt.fromNumber=function(t){if(t===0)return Nr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Vt(n,i)};Vt.from=function(t){if(typeof t=="number")return Vt.fromNumber(t);if(qn.isString(t))if(qn.Long)t=qn.Long.fromString(t);else return Vt.fromNumber(parseInt(t,10));return t.low||t.high?new Vt(t.low>>>0,t.high>>>0):Nr};Vt.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Vt.prototype.toLong=function(t){return qn.Long?new qn.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var pr=String.prototype.charCodeAt;Vt.fromHash=function(t){return t===X1?Nr:new Vt((pr.call(t,0)|pr.call(t,1)<<8|pr.call(t,2)<<16|pr.call(t,3)<<24)>>>0,(pr.call(t,4)|pr.call(t,5)<<8|pr.call(t,6)<<16|pr.call(t,7)<<24)>>>0)};Vt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Vt.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};Vt.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};Vt.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Ur=Q(Po=>{"use strict";var F=Po;F.asPromise=Su();F.base64=Iu();F.EventEmitter=Tu();F.float=Uu();F.inquire=Ku();F.utf8=Mu();F.pool=qu();F.LongBits=Hu();F.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);F.global=F.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Po;F.emptyArray=Object.freeze?Object.freeze([]):[];F.emptyObject=Object.freeze?Object.freeze({}):{};F.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};F.isString=function(t){return typeof t=="string"||t instanceof String};F.isObject=function(t){return t&&typeof t=="object"};F.isset=F.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};F.Buffer=function(){try{var e=F.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();F._Buffer_from=null;F._Buffer_allocUnsafe=null;F.newBuffer=function(t){return typeof t=="number"?F.Buffer?F._Buffer_allocUnsafe(t):new F.Array(t):F.Buffer?F._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};F.Array=typeof Uint8Array<"u"?Uint8Array:Array;F.Long=F.global.dcodeIO&&F.global.dcodeIO.Long||F.global.Long||F.inquire("long");F.key2Re=/^true|false|0|1$/;F.key32Re=/^-?(?:0|[1-9][0-9]*)$/;F.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;F.longToHash=function(t){return t?F.LongBits.from(t).toHash():F.LongBits.zeroHash};F.longFromHash=function(t,r){var n=F.LongBits.fromHash(t);return F.Long?F.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function zu(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}F.merge=zu;F.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Gu(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&zu(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}F.newError=Gu;F.ProtocolError=Gu("ProtocolError");F.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};F.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};F.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};F._configure=function(){var e=F.Buffer;if(!e){F._Buffer_from=F._Buffer_allocUnsafe=null;return}F._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},F._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var Uo=Q((tv,Zu)=>{"use strict";Zu.exports=_t;var Ee=Ur(),No,Qu=Ee.LongBits,J1=Ee.utf8;function Se(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function _t(e){this.buf=e,this.pos=0,this.len=e.length}var Wu=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new _t(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new _t(t);throw Error("illegal buffer")},Yu=function(){return Ee.Buffer?function(r){return(_t.create=function(i){return Ee.Buffer.isBuffer(i)?new No(i):Wu(i)})(r)}:Wu};_t.create=Yu();_t.prototype._slice=Ee.Array.prototype.subarray||Ee.Array.prototype.slice;_t.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Se(this,10);return t}}();_t.prototype.int32=function(){return this.uint32()|0};_t.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Do(){var e=new Qu(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Se(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Se(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}_t.prototype.bool=function(){return this.uint32()!==0};function $i(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}_t.prototype.fixed32=function(){if(this.pos+4>this.len)throw Se(this,4);return $i(this.buf,this.pos+=4)};_t.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Se(this,4);return $i(this.buf,this.pos+=4)|0};function $u(){if(this.pos+8>this.len)throw Se(this,8);return new Qu($i(this.buf,this.pos+=4),$i(this.buf,this.pos+=4))}_t.prototype.float=function(){if(this.pos+4>this.len)throw Se(this,4);var t=Ee.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};_t.prototype.double=function(){if(this.pos+8>this.len)throw Se(this,4);var t=Ee.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};_t.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Se(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var i=Ee.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};_t.prototype.string=function(){var t=this.bytes();return J1.read(t,0,t.length)};_t.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Se(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Se(this);while(this.buf[this.pos++]&128);return this};_t.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};_t._configure=function(e){No=e,_t.create=Yu(),No._configure();var t=Ee.Long?"toLong":"toNumber";Ee.merge(_t.prototype,{int64:function(){return Do.call(this)[t](!1)},uint64:function(){return Do.call(this)[t](!0)},sint64:function(){return Do.call(this).zzDecode()[t](!1)},fixed64:function(){return $u.call(this)[t](!0)},sfixed64:function(){return $u.call(this)[t](!1)}})}});var tf=Q((ev,ju)=>{"use strict";ju.exports=Kr;var Ju=Uo();(Kr.prototype=Object.create(Ju.prototype)).constructor=Kr;var Xu=Ur();function Kr(e){Ju.call(this,e)}Kr._configure=function(){Xu.Buffer&&(Kr.prototype._slice=Xu.Buffer.prototype.slice)};Kr.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Kr._configure()});var Ho=Q((rv,sf)=>{"use strict";sf.exports=it;var pe=Ur(),Ko,Qi=pe.LongBits,ef=pe.base64,rf=pe.utf8;function Vn(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Mo(){}function j1(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function it(){this.len=0,this.head=new Vn(Mo,0,0),this.tail=this.head,this.states=null}var nf=function(){return pe.Buffer?function(){return(it.create=function(){return new Ko})()}:function(){return new it}};it.create=nf();it.alloc=function(t){return new pe.Array(t)};pe.Array!==Array&&(it.alloc=pe.pool(it.alloc,pe.Array.prototype.subarray));it.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Vn(t,r,n),this.len+=r,this};function Fo(e,t,r){t[r]=e&255}function tg(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function qo(e,t){this.len=e,this.next=void 0,this.val=t}qo.prototype=Object.create(Vn.prototype);qo.prototype.fn=tg;it.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new qo((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};it.prototype.int32=function(t){return t<0?this._push(Vo,10,Qi.fromNumber(t)):this.uint32(t)};it.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Vo(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}it.prototype.uint64=function(t){var r=Qi.from(t);return this._push(Vo,r.length(),r)};it.prototype.int64=it.prototype.uint64;it.prototype.sint64=function(t){var r=Qi.from(t).zzEncode();return this._push(Vo,r.length(),r)};it.prototype.bool=function(t){return this._push(Fo,1,t?1:0)};function Oo(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}it.prototype.fixed32=function(t){return this._push(Oo,4,t>>>0)};it.prototype.sfixed32=it.prototype.fixed32;it.prototype.fixed64=function(t){var r=Qi.from(t);return this._push(Oo,4,r.lo)._push(Oo,4,r.hi)};it.prototype.sfixed64=it.prototype.fixed64;it.prototype.float=function(t){return this._push(pe.float.writeFloatLE,4,t)};it.prototype.double=function(t){return this._push(pe.float.writeDoubleLE,8,t)};var eg=pe.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};it.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Fo,1,0);if(pe.isString(t)){var n=it.alloc(r=ef.length(t));ef.decode(t,n,0),t=n}return this.uint32(r)._push(eg,r,t)};it.prototype.string=function(t){var r=rf.length(t);return r?this.uint32(r)._push(rf.write,r,t):this._push(Fo,1,0)};it.prototype.fork=function(){return this.states=new j1(this),this.head=this.tail=new Vn(Mo,0,0),this.len=0,this};it.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Vn(Mo,0,0),this.len=0),this};it.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};it.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};it._configure=function(e){Ko=e,it.create=nf(),Ko._configure()}});var cf=Q((nv,af)=>{"use strict";af.exports=De;var of=Ho();(De.prototype=Object.create(of.prototype)).constructor=De;var yr=Ur();function De(){of.call(this)}De._configure=function(){De.alloc=yr._Buffer_allocUnsafe,De.writeBytesBuffer=yr.Buffer&&yr.Buffer.prototype instanceof Uint8Array&&yr.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};De.prototype.bytes=function(t){yr.isString(t)&&(t=yr._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(De.writeBytesBuffer,r,t),this};function rg(e,t,r){e.length<40?yr.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}De.prototype.string=function(t){var r=yr.Buffer.byteLength(t);return this.uint32(r),r&&this._push(rg,r,t),this};De._configure()});var bf=Q((nb,vf)=>{var mt=lt();Ar();kt();var zn=vf.exports=mt.sha512=mt.sha512||{};mt.md.sha512=mt.md.algorithms.sha512=zn;var mf=mt.sha384=mt.sha512.sha384=mt.sha512.sha384||{};mf.create=function(){return zn.create("SHA-384")};mt.md.sha384=mt.md.algorithms.sha384=mf;mt.sha512.sha256=mt.sha512.sha256||{create:function(){return zn.create("SHA-512/256")}};mt.md["sha512/256"]=mt.md.algorithms["sha512/256"]=mt.sha512.sha256;mt.sha512.sha224=mt.sha512.sha224||{create:function(){return zn.create("SHA-512/224")}};mt.md["sha512/224"]=mt.md.algorithms["sha512/224"]=mt.sha512.sha224;zn.create=function(e){if(xf||hg(),typeof e>"u"&&(e="SHA-512"),!(e in Mr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Mr[e],r=null,n=mt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(e){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=mt.util.createBuffer(),r=new Array(t.length);for(var u=0;u<t.length;++u)r[u]=t[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=mt.util.encodeUtf8(c));var f=c.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=f[1],f[1]=f[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(c),gf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=mt.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=u&a.blockLength-1;c.putBytes(Xo.substr(0,a.blockLength-f));for(var l,h,y=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)l=a.fullMessageLength[d+1]*8,h=l/4294967296>>>0,y+=h,c.putInt32(y>>>0),y=l>>>0;c.putInt32(y);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);gf(p,i,c);var g=mt.util.createBuffer(),x;e==="SHA-512"?x=p.length:e==="SHA-384"?x=p.length-2:x=p.length-4;for(var d=0;d<x;++d)g.putInt32(p[d][0]),(d!==x-1||e!=="SHA-512/224")&&g.putInt32(p[d][1]);return g},a};var Xo=null,xf=!1,Jo=null,Mr=null;function hg(){Xo=String.fromCharCode(128),Xo+=mt.util.fillString(String.fromCharCode(0),128),Jo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Mr={},Mr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Mr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Mr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Mr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],xf=!0}function gf(e,t,r){for(var n,i,s,o,a,c,u,f,l,h,y,d,p,g,x,w,b,T,E,S,L,k,G,W,H,j,ft,Ht,I,D,R,P,A,K,M,z=r.length();z>=128;){for(I=0;I<16;++I)t[I][0]=r.getInt32()>>>0,t[I][1]=r.getInt32()>>>0;for(;I<80;++I)P=t[I-2],D=P[0],R=P[1],n=((D>>>19|R<<13)^(R>>>29|D<<3)^D>>>6)>>>0,i=((D<<13|R>>>19)^(R<<3|D>>>29)^(D<<26|R>>>6))>>>0,K=t[I-15],D=K[0],R=K[1],s=((D>>>1|R<<31)^(D>>>8|R<<24)^D>>>7)>>>0,o=((D<<31|R>>>1)^(D<<24|R>>>8)^(D<<25|R>>>7))>>>0,A=t[I-7],M=t[I-16],R=i+A[1]+o+M[1],t[I][0]=n+A[0]+s+M[0]+(R/4294967296>>>0)>>>0,t[I][1]=R>>>0;for(p=e[0][0],g=e[0][1],x=e[1][0],w=e[1][1],b=e[2][0],T=e[2][1],E=e[3][0],S=e[3][1],L=e[4][0],k=e[4][1],G=e[5][0],W=e[5][1],H=e[6][0],j=e[6][1],ft=e[7][0],Ht=e[7][1],I=0;I<80;++I)u=((L>>>14|k<<18)^(L>>>18|k<<14)^(k>>>9|L<<23))>>>0,f=((L<<18|k>>>14)^(L<<14|k>>>18)^(k<<23|L>>>9))>>>0,l=(H^L&(G^H))>>>0,h=(j^k&(W^j))>>>0,a=((p>>>28|g<<4)^(g>>>2|p<<30)^(g>>>7|p<<25))>>>0,c=((p<<4|g>>>28)^(g<<30|p>>>2)^(g<<25|p>>>7))>>>0,y=(p&x|b&(p^x))>>>0,d=(g&w|T&(g^w))>>>0,R=Ht+f+h+Jo[I][1]+t[I][1],n=ft+u+l+Jo[I][0]+t[I][0]+(R/4294967296>>>0)>>>0,i=R>>>0,R=c+d,s=a+y+(R/4294967296>>>0)>>>0,o=R>>>0,ft=H,Ht=j,H=G,j=W,G=L,W=k,R=S+i,L=E+n+(R/4294967296>>>0)>>>0,k=R>>>0,E=b,S=T,b=x,T=w,x=p,w=g,R=i+o,p=n+s+(R/4294967296>>>0)>>>0,g=R>>>0;R=e[0][1]+g,e[0][0]=e[0][0]+p+(R/4294967296>>>0)>>>0,e[0][1]=R>>>0,R=e[1][1]+w,e[1][0]=e[1][0]+x+(R/4294967296>>>0)>>>0,e[1][1]=R>>>0,R=e[2][1]+T,e[2][0]=e[2][0]+b+(R/4294967296>>>0)>>>0,e[2][1]=R>>>0,R=e[3][1]+S,e[3][0]=e[3][0]+E+(R/4294967296>>>0)>>>0,e[3][1]=R>>>0,R=e[4][1]+k,e[4][0]=e[4][0]+L+(R/4294967296>>>0)>>>0,e[4][1]=R>>>0,R=e[5][1]+W,e[5][0]=e[5][0]+G+(R/4294967296>>>0)>>>0,e[5][1]=R>>>0,R=e[6][1]+j,e[6][0]=e[6][0]+H+(R/4294967296>>>0)>>>0,e[6][1]=R>>>0,R=e[7][1]+Ht,e[7][0]=e[7][0]+ft+(R/4294967296>>>0)>>>0,e[7][1]=R>>>0,z-=128}}});var Sl=Q((k8,La)=>{"use strict";var mm=Object.prototype.hasOwnProperty,re="~";function ei(){}Object.create&&(ei.prototype=Object.create(null),new ei().__proto__||(re=!1));function xm(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function El(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new xm(r,n||e,i),o=re?re+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],s]:e._events[o].push(s):(e._events[o]=s,e._eventsCount++),e}function ss(e,t){--e._eventsCount===0?e._events=new ei:delete e._events[t]}function Zt(){this._events=new ei,this._eventsCount=0}Zt.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)mm.call(r,n)&&t.push(re?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Zt.prototype.listeners=function(t){var r=re?re+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o};Zt.prototype.listenerCount=function(t){var r=re?re+t:t,n=this._events[r];return n?n.fn?1:n.length:0};Zt.prototype.emit=function(t,r,n,i,s,o){var a=re?re+t:t;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,f,l;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,i),!0;case 5:return c.fn.call(c.context,r,n,i,s),!0;case 6:return c.fn.call(c.context,r,n,i,s,o),!0}for(l=1,f=new Array(u-1);l<u;l++)f[l-1]=arguments[l];c.fn.apply(c.context,f)}else{var h=c.length,y;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),u){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,r);break;case 3:c[l].fn.call(c[l].context,r,n);break;case 4:c[l].fn.call(c[l].context,r,n,i);break;default:if(!f)for(y=1,f=new Array(u-1);y<u;y++)f[y-1]=arguments[y];c[l].fn.apply(c[l].context,f)}}return!0};Zt.prototype.on=function(t,r,n){return El(this,t,r,n,!1)};Zt.prototype.once=function(t,r,n){return El(this,t,r,n,!0)};Zt.prototype.removeListener=function(t,r,n,i){var s=re?re+t:t;if(!this._events[s])return this;if(!r)return ss(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&ss(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==r||i&&!o[a].once||n&&o[a].context!==n)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:ss(this,s)}return this};Zt.prototype.removeAllListeners=function(t){var r;return t?(r=re?re+t:t,this._events[r]&&ss(this,r)):(this._events=new ei,this._eventsCount=0),this};Zt.prototype.off=Zt.prototype.removeListener;Zt.prototype.addListener=Zt.prototype.on;Zt.prefixed=re;Zt.EventEmitter=Zt;typeof La<"u"&&(La.exports=Zt)});var Cm={};Ot(Cm,{PersistentPeerStore:()=>t0});var ae=Lt(p0(),1);var _s={};Ot(_s,{base32:()=>oe,base32hex:()=>Sh,base32hexpad:()=>Ah,base32hexpadupper:()=>Ch,base32hexupper:()=>Bh,base32pad:()=>wh,base32padupper:()=>Eh,base32upper:()=>bh,base32z:()=>Ih});function yh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function l(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,g=0,x=0,w=d.length;x!==w&&d[x]===0;)x++,p++;for(var b=(w-x)*f+1>>>0,T=new Uint8Array(b);x!==w;){for(var E=d[x],S=0,L=b-1;(E!==0||S<g)&&L!==-1;L--,S++)E+=256*T[L]>>>0,T[L]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,x++}for(var k=b-g;k!==b&&T[k]===0;)k++;for(var G=c.repeat(p);k<b;++k)G+=e.charAt(T[k]);return G}function h(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var g=0,x=0;d[p]===c;)g++,p++;for(var w=(d.length-p)*u+1>>>0,b=new Uint8Array(w);d[p];){var T=r[d.charCodeAt(p)];if(T===255)return;for(var E=0,S=w-1;(T!==0||E<x)&&S!==-1;S--,E++)T+=a*b[S]>>>0,b[S]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");x=E,p++}if(d[p]!==" "){for(var L=w-x;L!==w&&b[L]===0;)L++;for(var k=new Uint8Array(g+(w-L)),G=g;L!==w;)k[G++]=b[L++];return k}}}function y(d){var p=h(d);if(p)return p;throw new Error(`Non-${t} character`)}return{encode:l,decodeUnsafe:h,decode:y}}var gh=yh,mh=gh,y0=mh;var Lm=new Uint8Array(0);var g0=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Fe=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var m0=e=>new TextEncoder().encode(e),x0=e=>new TextDecoder().decode(e);var Bs=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},As=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return b0(this,t)}},Cs=class{constructor(t){this.decoders=t}or(t){return b0(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},b0=(e,t)=>new Cs({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Is=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Bs(t,r,n),this.decoder=new As(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},tn=({name:e,prefix:t,encode:r,decode:n})=>new Is(e,t,r,n),nr=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=y0(r,t);return tn({prefix:e,name:t,encode:n,decode:s=>Fe(i(s))})},xh=(e,t,r,n)=>{let i={};for(let f=0;f<t.length;++f)i[t[f]]=f;let s=e.length;for(;e[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let f=0;f<s;++f){let l=i[e[f]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},vh=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},At=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>tn({prefix:t,name:e,encode(i){return vh(i,n,r)},decode(i){return xh(i,n,r,e)}});var oe=At({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bh=At({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),wh=At({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Eh=At({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Sh=At({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Bh=At({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ah=At({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ch=At({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ih=At({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ts={};Ot(Ts,{base58btc:()=>It,base58flickr:()=>_h});var It=nr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_h=nr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Rs={};Ot(Rs,{base64:()=>en,base64pad:()=>Th,base64url:()=>Rh,base64urlpad:()=>Lh});var en=At({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Th=At({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Rh=At({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Lh=At({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});ae.default.formatters.b=e=>e==null?"undefined":It.baseEncode(e);ae.default.formatters.t=e=>e==null?"undefined":oe.baseEncode(e);ae.default.formatters.m=e=>e==null?"undefined":en.baseEncode(e);ae.default.formatters.p=e=>e==null?"undefined":e.toString();ae.default.formatters.c=e=>e==null?"undefined":e.toString();ae.default.formatters.k=e=>e==null?"undefined":e.toString();ae.default.formatters.a=e=>e==null?"undefined":e.toString();function kh(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function w0(e){let t=kh(`${e}:trace`);return ae.default.enabled(`${e}:trace`)&&ae.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=(0,ae.default)(`${e}:trace`)),Object.assign((0,ae.default)(e),{error:(0,ae.default)(`${e}:error`),trace:t})}var aw=Lt(kn(),1),cw=Lt(Kc(),1);var q=class extends Error{code;props;constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Og=Lt(lt(),1);function Tr(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}var js={};Ot(js,{base10:()=>ny});var ny=nr({prefix:"9",name:"base10",alphabet:"0123456789"});var to={};Ot(to,{base16:()=>iy,base16upper:()=>sy});var iy=At({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sy=At({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var eo={};Ot(eo,{base2:()=>oy});var oy=At({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ro={};Ot(ro,{base256emoji:()=>ly});var Oc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ay=Oc.reduce((e,t,r)=>(e[r]=t,e),[]),cy=Oc.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function uy(e){return e.reduce((t,r)=>(t+=ay[r],t),"")}function fy(e){let t=[];for(let r of e){let n=cy[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var ly=tn({prefix:"\u{1F680}",name:"base256emoji",encode:uy,decode:fy});var no={};Ot(no,{base36:()=>hy,base36upper:()=>dy});var hy=nr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dy=nr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var io={};Ot(io,{base8:()=>py});var py=At({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var so={};Ot(so,{identity:()=>yy});var yy=tn({prefix:"\0",name:"identity",encode:e=>x0(e),decode:e=>m0(e)});var S2=new TextEncoder,B2=new TextDecoder;var ao={};Ot(ao,{identity:()=>cr});var xy=qc,Mc=128,vy=127,by=~vy,wy=Math.pow(2,31);function qc(e,t,r){t=t||[],r=r||0;for(var n=r;e>=wy;)t[r++]=e&255|Mc,e/=128;for(;e&by;)t[r++]=e&255|Mc,e>>>=7;return t[r]=e|0,qc.bytes=r-n+1,t}var Ey=oo,Sy=128,Fc=127;function oo(e,n){var r=0,n=n||0,i=0,s=n,o,a=e.length;do{if(s>=a)throw oo.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&Fc)<<i:(o&Fc)*Math.pow(2,i),i+=7}while(o>=Sy);return oo.bytes=s-n,r}var By=Math.pow(2,7),Ay=Math.pow(2,14),Cy=Math.pow(2,21),Iy=Math.pow(2,28),_y=Math.pow(2,35),Ty=Math.pow(2,42),Ry=Math.pow(2,49),Ly=Math.pow(2,56),ky=Math.pow(2,63),Py=function(e){return e<By?1:e<Ay?2:e<Cy?3:e<Iy?4:e<_y?5:e<Ty?6:e<Ry?7:e<Ly?8:e<ky?9:10},Dy={encode:xy,decode:Ey,encodingLength:Py},Ny=Dy,Nn=Ny;var Un=(e,t=0)=>[Nn.decode(e,t),Nn.decode.bytes],an=(e,t,r=0)=>(Nn.encode(e,t,r),t),cn=e=>Nn.encodingLength(e);var ke=(e,t)=>{let r=t.byteLength,n=cn(e),i=n+cn(r),s=new Uint8Array(i+r);return an(e,s,0),an(r,s,n),s.set(t,i),new un(e,r,t,s)},Rr=e=>{let t=Fe(e),[r,n]=Un(t),[i,s]=Un(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new un(r,i,o,t)},Vc=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&g0(e.bytes,r.bytes)}},un=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var Hc=0,Uy="identity",zc=Fe,Ky=e=>ke(Hc,zc(e)),cr={code:Hc,name:Uy,encode:zc,digest:Ky};var fo={};Ot(fo,{sha256:()=>Wt,sha512:()=>Oy});var uo=({name:e,code:t,encode:r})=>new co(e,t,r),co=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?ke(this.code,r):r.then(n=>ke(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Wc=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Wt=uo({name:"sha2-256",code:18,encode:Wc("SHA-256")}),Oy=uo({name:"sha2-512",code:19,encode:Wc("SHA-512")});var $c=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return Fy(r,lo(e),t||It.encoder);default:return qy(r,lo(e),t||oe.encoder)}};var Qc=new WeakMap,lo=e=>{let t=Qc.get(e);if(t==null){let r=new Map;return Qc.set(e,r),r}return t},xe=class e{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Kn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Vy)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=ke(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&Vc(t.multihash,n.multihash)}toString(t){return $c(this,t)}toJSON(){return{"/":$c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:o}=r;return new e(n,i,s,o||Yc(n,i,s.bytes))}else if(r[Hy]===!0){let{version:n,multihash:i,code:s}=r,o=Rr(i);return e.create(n,s,o)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Kn)throw new Error(`Version 0 CID must use dag-pb (code: ${Kn}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let i=Yc(t,r,n.bytes);return new e(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,Kn,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,i=Fe(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new un(r.multihashCode,r.digestSize,s,i);return[r.version===0?e.createV0(o):e.createV1(r.codec,o),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[l,h]=Un(t.subarray(r));return r+=h,l},i=n(),s=Kn;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),u=r+c,f=u-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:f,size:u}}static parse(t,r){let[n,i]=My(t,r),s=e.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return lo(s).set(n,t),s}},My=(e,t)=>{switch(e[0]){case"Q":{let r=t||It;return[It.prefix,r.decode(`${It.prefix}${e}`)]}case It.prefix:{let r=t||It;return[It.prefix,r.decode(e)]}case oe.prefix:{let r=t||oe;return[oe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},Fy=(e,t,r)=>{let{prefix:n}=r;if(n!==It.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},qy=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},Kn=112,Vy=18,Yc=(e,t,r)=>{let n=cn(e),i=n+cn(t),s=new Uint8Array(i+r.byteLength);return an(e,s,0),an(t,s,n),s.set(r,i),s},Hy=Symbol.for("@ipld/js-cid/CID");var ur={...so,...eo,...io,...js,...to,..._s,...no,...Ts,...Rs,...ro},F2={...fo,...ao};function ze(e=0){return globalThis.Buffer?.alloc!=null?Tr(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function Ge(e=0){return globalThis.Buffer?.allocUnsafe!=null?Tr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Xc(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Zc=Xc("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ho=Xc("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Ge(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),zy={utf8:Zc,"utf-8":Zc,hex:ur.base16,latin1:ho,ascii:ho,binary:ho,...ur},Ri=zy;function Pt(e,t="utf8"){let r=Ri[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Tr(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var Zo={};Ot(Zo,{Ed25519PrivateKey:()=>Or,Ed25519PublicKey:()=>Hn,generateKeyPair:()=>cg,generateKeyPairFromSeed:()=>df,unmarshalEd25519PrivateKey:()=>og,unmarshalEd25519PublicKey:()=>ag});function Et(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function Jc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function po(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function jc(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Jc(e.outputLen),Jc(e.blockLen)}function fn(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function tu(e,t){po(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Li=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var eu=e=>e instanceof Uint8Array;var ki=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ve=(e,t)=>e<<32-t|e>>>t,Gy=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Gy)throw new Error("Non little-endian hardware is not supported");function yo(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function On(e){if(typeof e=="string"&&(e=yo(e)),!eu(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Pi(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!eu(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var ln=class{clone(){return this._cloneInto()}},tx={}.toString;function Di(e){let t=n=>e().update(On(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function hn(e=32){if(Li&&typeof Li.getRandomValues=="function")return Li.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Wy(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+u,a,n)}var dn=class extends ln{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ki(this.buffer)}update(t){fn(this);let{view:r,buffer:n,blockLen:i}=this;t=On(t);let s=t.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=ki(t);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){fn(this),tu(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let l=o;l<i;l++)r[l]=0;Wy(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=ki(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,f[l],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};var Ni=BigInt(4294967295),go=BigInt(32);function ru(e,t=!1){return t?{h:Number(e&Ni),l:Number(e>>go&Ni)}:{h:Number(e>>go&Ni)|0,l:Number(e&Ni)|0}}function $y(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=ru(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}var Qy=(e,t)=>BigInt(e>>>0)<<go|BigInt(t>>>0),Yy=(e,t,r)=>e>>>r,Zy=(e,t,r)=>e<<32-r|t>>>r,Xy=(e,t,r)=>e>>>r|t<<32-r,Jy=(e,t,r)=>e<<32-r|t>>>r,jy=(e,t,r)=>e<<64-r|t>>>r-32,t1=(e,t,r)=>e>>>r-32|t<<64-r,e1=(e,t)=>t,r1=(e,t)=>e,n1=(e,t,r)=>e<<r|t>>>32-r,i1=(e,t,r)=>t<<r|e>>>32-r,s1=(e,t,r)=>t<<r-32|e>>>64-r,o1=(e,t,r)=>e<<r-32|t>>>64-r;function a1(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var c1=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),u1=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,f1=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),l1=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,h1=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),d1=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;var p1={fromBig:ru,split:$y,toBig:Qy,shrSH:Yy,shrSL:Zy,rotrSH:Xy,rotrSL:Jy,rotrBH:jy,rotrBL:t1,rotr32H:e1,rotr32L:r1,rotlSH:n1,rotlSL:i1,rotlBH:s1,rotlBL:o1,add:a1,add3L:c1,add3H:u1,add4L:f1,add4H:l1,add5H:d1,add5L:h1},Z=p1;var[y1,g1]=(()=>Z.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),fr=new Uint32Array(80),lr=new Uint32Array(80),mo=class extends dn{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:f,Fh:l,Fl:h,Gh:y,Gl:d,Hh:p,Hl:g}=this;return[t,r,n,i,s,o,a,c,u,f,l,h,y,d,p,g]}set(t,r,n,i,s,o,a,c,u,f,l,h,y,d,p,g){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=f|0,this.Fh=l|0,this.Fl=h|0,this.Gh=y|0,this.Gl=d|0,this.Hh=p|0,this.Hl=g|0}process(t,r){for(let b=0;b<16;b++,r+=4)fr[b]=t.getUint32(r),lr[b]=t.getUint32(r+=4);for(let b=16;b<80;b++){let T=fr[b-15]|0,E=lr[b-15]|0,S=Z.rotrSH(T,E,1)^Z.rotrSH(T,E,8)^Z.shrSH(T,E,7),L=Z.rotrSL(T,E,1)^Z.rotrSL(T,E,8)^Z.shrSL(T,E,7),k=fr[b-2]|0,G=lr[b-2]|0,W=Z.rotrSH(k,G,19)^Z.rotrBH(k,G,61)^Z.shrSH(k,G,6),H=Z.rotrSL(k,G,19)^Z.rotrBL(k,G,61)^Z.shrSL(k,G,6),j=Z.add4L(L,H,lr[b-7],lr[b-16]),ft=Z.add4H(j,S,W,fr[b-7],fr[b-16]);fr[b]=ft|0,lr[b]=j|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:f,Eh:l,El:h,Fh:y,Fl:d,Gh:p,Gl:g,Hh:x,Hl:w}=this;for(let b=0;b<80;b++){let T=Z.rotrSH(l,h,14)^Z.rotrSH(l,h,18)^Z.rotrBH(l,h,41),E=Z.rotrSL(l,h,14)^Z.rotrSL(l,h,18)^Z.rotrBL(l,h,41),S=l&y^~l&p,L=h&d^~h&g,k=Z.add5L(w,E,L,g1[b],lr[b]),G=Z.add5H(k,x,T,S,y1[b],fr[b]),W=k|0,H=Z.rotrSH(n,i,28)^Z.rotrBH(n,i,34)^Z.rotrBH(n,i,39),j=Z.rotrSL(n,i,28)^Z.rotrBL(n,i,34)^Z.rotrBL(n,i,39),ft=n&s^n&a^s&a,Ht=i&o^i&c^o&c;x=p|0,w=g|0,p=y|0,g=d|0,y=l|0,d=h|0,{h:l,l:h}=Z.add(u|0,f|0,G|0,W|0),u=a|0,f=c|0,a=s|0,c=o|0,s=n|0,o=i|0;let I=Z.add3L(W,j,Ht);n=Z.add3H(I,G,H,ft),i=I|0}({h:n,l:i}=Z.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=Z.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Z.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:f}=Z.add(this.Dh|0,this.Dl|0,u|0,f|0),{h:l,l:h}=Z.add(this.Eh|0,this.El|0,l|0,h|0),{h:y,l:d}=Z.add(this.Fh|0,this.Fl|0,y|0,d|0),{h:p,l:g}=Z.add(this.Gh|0,this.Gl|0,p|0,g|0),{h:x,l:w}=Z.add(this.Hh|0,this.Hl|0,x|0,w|0),this.set(n,i,s,o,a,c,u,f,l,h,y,d,p,g,x,w)}roundClean(){fr.fill(0),lr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var xo=Di(()=>new mo);var Oi={};Ot(Oi,{bitGet:()=>S1,bitLen:()=>E1,bitMask:()=>Mn,bitSet:()=>B1,bytesToHex:()=>We,bytesToNumberBE:()=>$e,bytesToNumberLE:()=>hr,concatBytes:()=>Qe,createHmacDrbg:()=>wo,ensureBytes:()=>Ct,equalBytes:()=>b1,hexToBytes:()=>kr,hexToNumber:()=>bo,numberToBytesBE:()=>dr,numberToBytesLE:()=>Pr,numberToHexUnpadded:()=>su,numberToVarBytesBE:()=>v1,utf8ToBytes:()=>w1,validateObject:()=>Pe});var iu=BigInt(0),Ui=BigInt(1),m1=BigInt(2),Ki=e=>e instanceof Uint8Array,x1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function We(e){if(!Ki(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=x1[e[r]];return t}function su(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function bo(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function kr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){let i=n*2,s=e.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function $e(e){return bo(We(e))}function hr(e){if(!Ki(e))throw new Error("Uint8Array expected");return bo(We(Uint8Array.from(e).reverse()))}function dr(e,t){return kr(e.toString(16).padStart(t*2,"0"))}function Pr(e,t){return dr(e,t).reverse()}function v1(e){return kr(su(e))}function Ct(e,t,r){let n;if(typeof t=="string")try{n=kr(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Ki(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}function Qe(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Ki(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function b1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function w1(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function E1(e){let t;for(t=0;e>iu;e>>=Ui,t+=1);return t}function S1(e,t){return e>>BigInt(t)&Ui}var B1=(e,t,r)=>e|(r?Ui:iu)<<BigInt(t),Mn=e=>(m1<<BigInt(e-1))-Ui,vo=e=>new Uint8Array(e),nu=e=>Uint8Array.from(e);function wo(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=vo(e),i=vo(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...l)=>r(i,n,...l),c=(l=vo())=>{i=a(nu([0]),l),n=a(),l.length!==0&&(i=a(nu([1]),l),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,h=[];for(;l<t;){n=a();let y=n.slice();h.push(y),l+=n.length}return Qe(...h)};return(l,h)=>{o(),c(l);let y;for(;!(y=h(u()));)c();return o(),y}}var A1={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Pe(e,t,r={}){let n=(i,s,o)=>{let a=A1[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}var Ut=BigInt(0),vt=BigInt(1),Dr=BigInt(2),C1=BigInt(3),Eo=BigInt(4),ou=BigInt(5),au=BigInt(8),I1=BigInt(9),_1=BigInt(16);function ht(e,t){let r=e%t;return r>=Ut?r:t+r}function T1(e,t,r){if(r<=Ut||t<Ut)throw new Error("Expected power/modulo > 0");if(r===vt)return Ut;let n=vt;for(;t>Ut;)t&vt&&(n=n*e%r),e=e*e%r,t>>=vt;return n}function bt(e,t,r){let n=e;for(;t-- >Ut;)n*=n,n%=r;return n}function Mi(e,t){if(e===Ut||t<=Ut)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=ht(e,t),n=t,i=Ut,s=vt,o=vt,a=Ut;for(;r!==Ut;){let u=n/r,f=n%r,l=i-o*u,h=s-a*u;n=r,r=f,i=o,s=a,o=l,a=h}if(n!==vt)throw new Error("invert: does not exist");return ht(i,t)}function R1(e){let t=(e-vt)/Dr,r,n,i;for(r=e-vt,n=0;r%Dr===Ut;r/=Dr,n++);for(i=Dr;i<e&&T1(i,t,e)!==e-vt;i++);if(n===1){let o=(e+vt)/Eo;return function(c,u){let f=c.pow(u,o);if(!c.eql(c.sqr(f),u))throw new Error("Cannot find square root");return f}}let s=(r+vt)/Dr;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,f=a.pow(a.mul(a.ONE,i),r),l=a.pow(c,s),h=a.pow(c,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let y=1;for(let p=a.sqr(h);y<u&&!a.eql(p,a.ONE);y++)p=a.sqr(p);let d=a.pow(f,vt<<BigInt(u-y-1));f=a.sqr(d),l=a.mul(l,d),h=a.mul(h,f),u=y}return l}}function L1(e){if(e%Eo===C1){let t=(e+vt)/Eo;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%au===ou){let t=(e-ou)/au;return function(n,i){let s=n.mul(i,Dr),o=n.pow(s,t),a=n.mul(i,o),c=n.mul(n.mul(a,Dr),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%_1,R1(e)}var cu=(e,t)=>(ht(e,t)&vt)===vt,k1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function So(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=k1.reduce((n,i)=>(n[i]="function",n),t);return Pe(e,r)}function P1(e,t,r){if(r<Ut)throw new Error("Expected power > 0");if(r===Ut)return e.ONE;if(r===vt)return t;let n=e.ONE,i=t;for(;r>Ut;)r&vt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=vt;return n}function D1(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}function Bo(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Fi(e,t,r=!1,n={}){if(e<=Ut)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=Bo(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=L1(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:Mn(i),ZERO:Ut,ONE:vt,create:c=>ht(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Ut<=c&&c<e},is0:c=>c===Ut,isOdd:c=>(c&vt)===vt,neg:c=>ht(-c,e),eql:(c,u)=>c===u,sqr:c=>ht(c*c,e),add:(c,u)=>ht(c+u,e),sub:(c,u)=>ht(c-u,e),mul:(c,u)=>ht(c*u,e),pow:(c,u)=>P1(a,c,u),div:(c,u)=>ht(c*Mi(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Mi(c,e),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>D1(a,c),cmov:(c,u,f)=>f?u:c,toBytes:c=>r?Pr(c,s):dr(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?hr(c):$e(c)}});return Object.freeze(a)}function uu(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}function fu(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Ao(e){let t=fu(e);return t+Math.ceil(t/2)}function lu(e,t,r=!1){let n=e.length,i=fu(t),s=Ao(t);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);let o=r?$e(e):hr(e),a=ht(o,t-vt)+vt;return r?Pr(a,i):dr(a,i)}var U1=BigInt(0),Co=BigInt(1);function qi(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>U1;)s&Co&&(o=o.add(a)),a=a.double(),s>>=Co;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),c=[],u=i,f=u;for(let l=0;l<o;l++){f=u,c.push(f);for(let h=1;h<a;h++)f=f.add(u),c.push(f);u=f.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=n(i),u=e.ZERO,f=e.BASE,l=BigInt(2**i-1),h=2**i,y=BigInt(i);for(let d=0;d<a;d++){let p=d*c,g=Number(o&l);o>>=y,g>c&&(g-=h,o+=Co);let x=p,w=p+Math.abs(g)-1,b=d%2!==0,T=g<0;g===0?f=f.add(r(b,s[x])):u=u.add(r(T,s[w]))}return{p:u,f}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,a(u))),this.wNAF(c,u,o)}}}function Fn(e){return So(e.Fp),Pe(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Bo(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var be=BigInt(0),ce=BigInt(1),Vi=BigInt(2),K1=BigInt(8),O1={zip215:!0};function M1(e){let t=Fn(e);return Pe(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Hi(e){let t=M1(e),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=t,u=Vi<<BigInt(a*8)-ce,f=r.create,l=t.uvRatio||((P,A)=>{try{return{isValid:!0,value:r.sqrt(P*r.inv(A))}}catch{return{isValid:!1,value:be}}}),h=t.adjustScalarBytes||(P=>P),y=t.domain||((P,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return P}),d=P=>typeof P=="bigint"&&be<P,p=(P,A)=>d(P)&&d(A)&&P<A,g=P=>P===be||p(P,u);function x(P,A){if(p(P,A))return P;throw new Error(`Expected valid scalar < ${A}, got ${typeof P} ${P}`)}function w(P){return P===be?P:x(P,n)}let b=new Map;function T(P){if(!(P instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(A,K,M,z){if(this.ex=A,this.ey=K,this.ez=M,this.et=z,!g(A))throw new Error("x required");if(!g(K))throw new Error("y required");if(!g(M))throw new Error("z required");if(!g(z))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof E)throw new Error("extended point not allowed");let{x:K,y:M}=A||{};if(!g(K)||!g(M))throw new Error("invalid affine point");return new E(K,M,ce,f(K*M))}static normalizeZ(A){let K=r.invertBatch(A.map(M=>M.ez));return A.map((M,z)=>M.toAffine(K[z])).map(E.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:M,ey:z,ez:X,et:tt}=this,ct=f(M*M),et=f(z*z),st=f(X*X),Rt=f(st*st),Bt=f(ct*A),zt=f(st*f(Bt+et)),Gt=f(Rt+f(K*f(ct*et)));if(zt!==Gt)throw new Error("bad point: equation left != right (1)");let Nt=f(M*z),Qt=f(X*tt);if(Nt!==Qt)throw new Error("bad point: equation left != right (2)")}equals(A){T(A);let{ex:K,ey:M,ez:z}=this,{ex:X,ey:tt,ez:ct}=A,et=f(K*ct),st=f(X*z),Rt=f(M*ct),Bt=f(tt*z);return et===st&&Rt===Bt}is0(){return this.equals(E.ZERO)}negate(){return new E(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:A}=t,{ex:K,ey:M,ez:z}=this,X=f(K*K),tt=f(M*M),ct=f(Vi*f(z*z)),et=f(A*X),st=K+M,Rt=f(f(st*st)-X-tt),Bt=et+tt,zt=Bt-ct,Gt=et-tt,Nt=f(Rt*zt),Qt=f(Bt*Gt),Me=f(Rt*Gt),Er=f(zt*Bt);return new E(Nt,Qt,Er,Me)}add(A){T(A);let{a:K,d:M}=t,{ex:z,ey:X,ez:tt,et:ct}=this,{ex:et,ey:st,ez:Rt,et:Bt}=A;if(K===BigInt(-1)){let r0=f((X-z)*(st+et)),n0=f((X+z)*(st-et)),Ss=f(n0-r0);if(Ss===be)return this.double();let i0=f(tt*Vi*Bt),s0=f(ct*Vi*Rt),o0=s0+i0,a0=n0+r0,c0=s0-i0,$l=f(o0*Ss),Ql=f(a0*c0),Yl=f(o0*c0),Zl=f(Ss*a0);return new E($l,Ql,Zl,Yl)}let zt=f(z*et),Gt=f(X*st),Nt=f(ct*M*Bt),Qt=f(tt*Rt),Me=f((z+X)*(et+st)-zt-Gt),Er=Qt-Nt,_n=Qt+Nt,e0=f(Gt-K*zt),Hl=f(Me*Er),zl=f(_n*e0),Gl=f(Me*e0),Wl=f(Er*_n);return new E(Hl,zl,Wl,Gl)}subtract(A){return this.add(A.negate())}wNAF(A){return k.wNAFCached(this,b,A,E.normalizeZ)}multiply(A){let{p:K,f:M}=this.wNAF(x(A,n));return E.normalizeZ([K,M])[0]}multiplyUnsafe(A){let K=w(A);return K===be?L:this.equals(L)||K===ce?this:this.equals(S)?this.wNAF(K).p:k.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return k.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:M,ez:z}=this,X=this.is0();A==null&&(A=X?K1:r.inv(z));let tt=f(K*A),ct=f(M*A),et=f(z*A);if(X)return{x:be,y:ce};if(et!==ce)throw new Error("invZ was invalid");return{x:tt,y:ct}}clearCofactor(){let{h:A}=t;return A===ce?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:M,a:z}=t,X=r.BYTES;A=Ct("pointHex",A,X);let tt=A.slice(),ct=A[X-1];tt[X-1]=ct&-129;let et=hr(tt);et===be||(K?x(et,u):x(et,r.ORDER));let st=f(et*et),Rt=f(st-ce),Bt=f(M*st-z),{isValid:zt,value:Gt}=l(Rt,Bt);if(!zt)throw new Error("Point.fromHex: invalid y coordinate");let Nt=(Gt&ce)===ce,Qt=(ct&128)!==0;if(!K&&Gt===be&&Qt)throw new Error("Point.fromHex: x=0 and x_0=1");return Qt!==Nt&&(Gt=f(-Gt)),E.fromAffine({x:Gt,y:et})}static fromPrivateKey(A){return H(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),M=Pr(K,r.BYTES);return M[M.length-1]|=A&ce?128:0,M}toHex(){return We(this.toRawBytes())}}E.BASE=new E(t.Gx,t.Gy,ce,f(t.Gx*t.Gy)),E.ZERO=new E(be,ce,ce,be);let{BASE:S,ZERO:L}=E,k=qi(E,a*8);function G(P){return ht(P,n)}function W(P){return G(hr(P))}function H(P){let A=a;P=Ct("private key",P,A);let K=Ct("hashed private key",s(P),2*A),M=h(K.slice(0,A)),z=K.slice(A,2*A),X=W(M),tt=S.multiply(X),ct=tt.toRawBytes();return{head:M,prefix:z,scalar:X,point:tt,pointBytes:ct}}function j(P){return H(P).pointBytes}function ft(P=new Uint8Array,...A){let K=Qe(...A);return W(s(y(K,Ct("context",P),!!i)))}function Ht(P,A,K={}){P=Ct("message",P),i&&(P=i(P));let{prefix:M,scalar:z,pointBytes:X}=H(A),tt=ft(K.context,M,P),ct=S.multiply(tt).toRawBytes(),et=ft(K.context,ct,X,P),st=G(tt+et*z);w(st);let Rt=Qe(ct,Pr(st,r.BYTES));return Ct("result",Rt,a*2)}let I=O1;function D(P,A,K,M=I){let{context:z,zip215:X}=M,tt=r.BYTES;P=Ct("signature",P,2*tt),A=Ct("message",A),i&&(A=i(A));let ct=hr(P.slice(tt,2*tt)),et,st,Rt;try{et=E.fromHex(K,X),st=E.fromHex(P.slice(0,tt),X),Rt=S.multiplyUnsafe(ct)}catch{return!1}if(!X&&et.isSmallOrder())return!1;let Bt=ft(z,st.toRawBytes(),et.toRawBytes(),A);return st.add(et.multiplyUnsafe(Bt)).subtract(Rt).clearCofactor().equals(E.ZERO)}return S._setWindowSize(8),{CURVE:t,getPublicKey:j,sign:Ht,verify:D,ExtendedPoint:E,utils:{getExtendedPublicKey:H,randomPrivateKey:()=>o(r.BYTES),precompute(P=8,A=E.BASE){return A._setWindowSize(P),A.multiply(BigInt(3)),A}}}}var _o=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),hu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ex=BigInt(0),F1=BigInt(1),Io=BigInt(2),q1=BigInt(5),du=BigInt(10),V1=BigInt(20),H1=BigInt(40),pu=BigInt(80);function z1(e){let t=_o,n=e*e%t*e%t,i=bt(n,Io,t)*n%t,s=bt(i,F1,t)*e%t,o=bt(s,q1,t)*s%t,a=bt(o,du,t)*o%t,c=bt(a,V1,t)*a%t,u=bt(c,H1,t)*c%t,f=bt(u,pu,t)*u%t,l=bt(f,pu,t)*u%t,h=bt(l,du,t)*o%t;return{pow_p_5_8:bt(h,Io,t)*e%t,b2:n}}function G1(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function W1(e,t){let r=_o,n=ht(t*t*t,r),i=ht(n*n*t,r),s=z1(e*i).pow_p_5_8,o=ht(e*n*s,r),a=ht(t*o*o,r),c=o,u=ht(o*hu,r),f=a===e,l=a===ht(-e,r),h=a===ht(-e*hu,r);return f&&(o=c),(l||h)&&(o=u),cu(o,r)&&(o=ht(-o,r)),{isValid:f||l,value:o}}var Ye=Fi(_o,void 0,!0),To={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ye,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:xo,randomBytes:hn,adjustScalarBytes:G1,uvRatio:W1},pn=Hi(To);function yu(e,t,r){if(t.length>255)throw new Error("Context is too big");return Pi(yo("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}var Sx=Hi({...To,domain:yu}),Bx=Hi({...To,domain:yu,prehash:xo});var $1=(Ye.ORDER+BigInt(3))/BigInt(8),Ax=Ye.pow(Io,$1),Cx=Ye.sqrt(Ye.neg(Ye.ONE)),Ix=(Ye.ORDER-BigInt(5))/BigInt(8),_x=BigInt(486662);var Tx=uu(Ye,Ye.neg(BigInt(486664)));var Rx=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Lx=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),kx=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Px=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Dx=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var yn=32,Ze=64,zi=32;async function gu(){let e=pn.utils.randomPrivateKey(),t=pn.getPublicKey(e);return{privateKey:bu(e,t),publicKey:t}}async function mu(e){if(e.length!==zi)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=pn.getPublicKey(t);return{privateKey:bu(t,r),publicKey:r}}async function xu(e,t){let r=e.subarray(0,zi);return pn.sign(t,r)}async function vu(e,t,r){return pn.verify(t,r,e)}function bu(e,t){let r=new Uint8Array(Ze);for(let n=0;n<zi;n++)r[n]=e[n],r[zi+n]=t[n];return r}function Kt(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=Ge(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return Tr(r)}var ie={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var Ro={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Lo(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=ie.get();r*=8;async function c(l,h){let y=a.getRandomValues(new Uint8Array(s)),d=a.getRandomValues(new Uint8Array(n)),p={name:t,iv:d};typeof h=="string"&&(h=Pt(h));let g;if(h.length===0){g=await a.subtle.importKey("jwk",Ro,{name:"AES-GCM"},!0,["encrypt"]);try{let w={name:"PBKDF2",salt:y,iterations:o,hash:{name:i}},b=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(w,b,{name:t,length:r},!0,["encrypt"])}catch{g=await a.subtle.importKey("jwk",Ro,{name:"AES-GCM"},!0,["encrypt"])}}else{let w={name:"PBKDF2",salt:y,iterations:o,hash:{name:i}},b=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(w,b,{name:t,length:r},!0,["encrypt"])}let x=await a.subtle.encrypt(p,g,l);return Kt([y,p.iv,new Uint8Array(x)])}async function u(l,h){let y=l.subarray(0,s),d=l.subarray(s,s+n),p=l.subarray(s+n),g={name:t,iv:d};typeof h=="string"&&(h=Pt(h));let x;if(h.length===0)try{let b={name:"PBKDF2",salt:y,iterations:o,hash:{name:i}},T=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(b,T,{name:t,length:r},!0,["decrypt"])}catch{x=await a.subtle.importKey("jwk",Ro,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:y,iterations:o,hash:{name:i}},T=await a.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(b,T,{name:t,length:r},!0,["decrypt"])}let w=await a.subtle.decrypt(g,x,p);return new Uint8Array(w)}return{encrypt:c,decrypt:u}}async function gn(e,t){let n=await Lo().encrypt(e,t);return en.encode(n)}var zo=Lt(Uo(),1),uf=Lt(tf(),1),ff=Lt(Ur(),1),Go=Lt(Ho(),1),lf=Lt(cf(),1);function ng(){ff.default._configure(),zo.default._configure(uf.default),Go.default._configure(lf.default)}ng();var hf=["uint64","int64","sint64","fixed64","sfixed64"];function ig(e){for(let t of hf){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Wo(e){return ig(new zo.default(e))}function sg(e){for(let t of hf){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function $o(){return sg(Go.default.create())}function jt(e,t){let r=Wo(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function te(e,t){let r=$o();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var xn;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(xn||(xn={}));function Yi(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Qo(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,o){let a=t(s);o.int32(a)},n=function(s){let o=s.int32();return t(o)};return Yi("enum",xn.VARINT,r,n)}function ee(e,t){return Yi("message",xn.LENGTH_DELIMITED,e,t)}var wt;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(wt||(wt={}));var Yo;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(Yo||(Yo={}));(function(e){e.codec=()=>Qo(Yo)})(wt||(wt={}));var Ne;(function(e){let t;e.codec=()=>(t==null&&(t=ee((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>te(r,e.codec()),e.decode=r=>jt(r,e.codec())})(Ne||(Ne={}));var Ue;(function(e){let t;e.codec=()=>(t==null&&(t=ee((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>te(r,e.codec()),e.decode=r=>jt(r,e.codec())})(Ue||(Ue={}));var Hn=class{_key;constructor(t){this._key=vn(t,yn)}async verify(t,r){return vu(this._key,r,t)}marshal(){return this._key}get bytes(){return Ne.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Et(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Wt.digest(this.bytes);return t}},Or=class{_key;_publicKey;constructor(t,r){this._key=vn(t,Ze),this._publicKey=vn(r,yn)}async sign(t){return xu(this._key,t)}get public(){return new Hn(this._publicKey)}marshal(){return this._key}get bytes(){return Ue.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Et(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Wt.digest(this.bytes);return t}async id(){let t=cr.digest(this.public.bytes);return It.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return gn(this.bytes,t);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function og(e){if(e.length>Ze){e=vn(e,Ze+yn);let n=e.subarray(0,Ze),i=e.subarray(Ze,e.length);return new Or(n,i)}e=vn(e,Ze);let t=e.subarray(0,Ze),r=e.subarray(yn);return new Or(t,r)}function ag(e){return e=vn(e,yn),new Hn(e)}async function cg(){let{privateKey:e,publicKey:t}=await gu();return new Or(e,t)}async function df(e){let{privateKey:t,publicKey:r}=await mu(e);return new Or(t,r)}function vn(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new q(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}function ut(e,t="utf8"){let r=Ri[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var Tv=Lt(kt(),1),Rv=Lt(Ai(),1),pf=Lt(lt(),1);function Be(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Kt([new Uint8Array(t-r.length),r])}return ut(r,"base64url")}function ue(e){let t=yf(e);return new pf.default.jsbn.BigInteger(ut(t,"base16"),16)}function yf(e,t){let r=Pt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Kt([new Uint8Array(t-r.length),r])}return r}var ug={"P-256":256,"P-384":384,"P-521":521},fg=Object.keys(ug),qv=fg.join(" / ");var ea={};Ot(ea,{MAX_KEY_SIZE:()=>$n,RsaPrivateKey:()=>bn,RsaPublicKey:()=>Wn,fromJwk:()=>wg,generateKeyPair:()=>Eg,unmarshalRsaPrivateKey:()=>vg,unmarshalRsaPublicKey:()=>bg});var Gn=Lt(lt(),1);var Ab=Lt(bf(),1);function Xi(e){if(isNaN(e)||e<=0)throw new q("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return hn(e)}var ab=Lt(_i(),1),jo=Lt(lt(),1);function wf(e,t){return t.map(r=>ue(e[r]))}function Ef(e){return jo.default.pki.setRsaPrivateKey(...wf(e,["n","e","d","p","q","dp","dq","qi"]))}function Sf(e){return jo.default.pki.setRsaPublicKey(...wf(e,["n","e"]))}var Fr={};Ot(Fr,{jwkToPkcs1:()=>pg,jwkToPkix:()=>gg,pkcs1ToJwk:()=>dg,pkixToJwk:()=>yg});var fb=Lt(kn(),1),lb=Lt(_i(),1);var Xe=Lt(lt(),1);function dg(e){let t=Xe.default.asn1.fromDer(ut(e,"ascii")),r=Xe.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Be(r.n),e:Be(r.e),d:Be(r.d),p:Be(r.p),q:Be(r.q),dp:Be(r.dP),dq:Be(r.dQ),qi:Be(r.qInv),alg:"RS256"}}function pg(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Xe.default.pki.privateKeyToAsn1({n:ue(e.n),e:ue(e.e),d:ue(e.d),p:ue(e.p),q:ue(e.q),dP:ue(e.dp),dQ:ue(e.dq),qInv:ue(e.qi)});return Pt(Xe.default.asn1.toDer(t).getBytes(),"ascii")}function yg(e){let t=Xe.default.asn1.fromDer(ut(e,"ascii")),r=Xe.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Be(r.n),e:Be(r.e)}}function gg(e){if(e.n==null||e.e==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Xe.default.pki.publicKeyToAsn1({n:ue(e.n),e:ue(e.e)});return Pt(Xe.default.asn1.toDer(t).getBytes(),"ascii")}async function Bf(e){let t=await ie.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await If(t);return{privateKey:r[0],publicKey:r[1]}}async function ta(e){let r=[await ie.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await mg(e)],n=await If({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Af(e,t){let r=await ie.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ie.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Cf(e,t,r){let n=await ie.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ie.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function If(e){if(e.privateKey==null||e.publicKey==null)throw new q("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([ie.get().subtle.exportKey("jwk",e.privateKey),ie.get().subtle.exportKey("jwk",e.publicKey)])}async function mg(e){return ie.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function _f(e,t,r,n){let i=t?Sf(e):Ef(e),s=ut(Uint8Array.from(r),"ascii"),o=n(s,i);return Pt(o,"ascii")}function Tf(e,t){return _f(e,!0,t,(r,n)=>n.encrypt(r))}function Rf(e,t){return _f(e,!1,t,(r,n)=>n.decrypt(r))}function Ji(e){if(e.kty!=="RSA")throw new q("invalid key type","ERR_INVALID_KEY_TYPE");if(e.n==null)throw new q("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Pt(e.n,"base64url").length*8}var $n=8192,Wn=class{_key;constructor(t){this._key=t}async verify(t,r){return Cf(this._key,r,t)}marshal(){return Fr.jwkToPkix(this._key)}get bytes(){return Ne.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}encrypt(t){return Tf(this._key,t)}equals(t){return Et(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Wt.digest(this.bytes);return t}},bn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return Xi(16)}async sign(t){return Af(this._key,t)}get public(){if(this._publicKey==null)throw new q("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Wn(this._publicKey)}decrypt(t){return Rf(this._key,t)}marshal(){return Fr.jwkToPkcs1(this._key)}get bytes(){return Ue.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}equals(t){return Et(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Wt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return ut(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Gn.default.util.ByteBuffer(this.marshal()),i=Gn.default.asn1.fromDer(n),s=Gn.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Gn.default.pki.encryptRsaPrivateKey(s,t,o)}else{if(r==="libp2p-key")return gn(this.bytes,t);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function vg(e){let t=Fr.pkcs1ToJwk(e);if(Ji(t)>$n)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await ta(t);return new bn(r.privateKey,r.publicKey)}function bg(e){let t=Fr.pkixToJwk(e);if(Ji(t)>$n)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Wn(t)}async function wg(e){if(Ji(e)>$n)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let t=await ta(e);return new bn(t.privateKey,t.publicKey)}async function Eg(e){if(e>$n)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let t=await Bf(e);return new bn(t.privateKey,t.publicKey)}var aa={};Ot(aa,{Secp256k1PrivateKey:()=>Yn,Secp256k1PublicKey:()=>Qn,generateKeyPair:()=>Kg,unmarshalSecp256k1PrivateKey:()=>Ng,unmarshalSecp256k1PublicKey:()=>Ug});var Sg=(e,t,r)=>e&t^~e&r,Bg=(e,t,r)=>e&t^e&r^t&r,Ag=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),mr=new Uint32Array(64),ra=class extends dn{constructor(){super(64,32,8,!1),this.A=gr[0]|0,this.B=gr[1]|0,this.C=gr[2]|0,this.D=gr[3]|0,this.E=gr[4]|0,this.F=gr[5]|0,this.G=gr[6]|0,this.H=gr[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,r){for(let l=0;l<16;l++,r+=4)mr[l]=t.getUint32(r,!1);for(let l=16;l<64;l++){let h=mr[l-15],y=mr[l-2],d=ve(h,7)^ve(h,18)^h>>>3,p=ve(y,17)^ve(y,19)^y>>>10;mr[l]=p+mr[l-7]+d+mr[l-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:f}=this;for(let l=0;l<64;l++){let h=ve(a,6)^ve(a,11)^ve(a,25),y=f+h+Sg(a,c,u)+Ag[l]+mr[l]|0,p=(ve(n,2)^ve(n,13)^ve(n,22))+Bg(n,i,s)|0;f=u,u=c,c=a,a=o+y|0,o=s,s=i,i=n,n=y+p|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(n,i,s,o,a,c,u,f)}roundClean(){mr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Lf=Di(()=>new ra);function Cg(e){let t=Fn(e);Pe(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Ig,hexToBytes:_g}=Oi,qr={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=qr;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Ig(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=qr,r=typeof e=="string"?_g(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=qr._parseInt(r.subarray(2)),{d:o,l:a}=qr._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let f=u.toString(16);return f.length&1?`0${f}`:f},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),c=r(o);return`30${r(o+s+4)}02${c}${i}02${a}${n}`}},Je=BigInt(0),ye=BigInt(1),Db=BigInt(2),kf=BigInt(3),Nb=BigInt(4);function Tg(e){let t=Cg(e),{Fp:r}=t,n=t.toBytes||((d,p,g)=>{let x=p.toAffine();return Qe(Uint8Array.from([4]),r.toBytes(x.x),r.toBytes(x.y))}),i=t.fromBytes||(d=>{let p=d.subarray(1),g=r.fromBytes(p.subarray(0,r.BYTES)),x=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:g,y:x}});function s(d){let{a:p,b:g}=t,x=r.sqr(d),w=r.mul(x,d);return r.add(r.add(w,r.mul(d,p)),g)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(d){return typeof d=="bigint"&&Je<d&&d<t.n}function a(d){if(!o(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(d){let{allowedPrivateKeyLengths:p,nByteLength:g,wrapPrivateKey:x,n:w}=t;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=We(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(g*2,"0")}let b;try{b=typeof d=="bigint"?d:$e(Ct("private key",d,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof d}`)}return x&&(b=ht(b,w)),a(b),b}let u=new Map;function f(d){if(!(d instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(p,g,x){if(this.px=p,this.py=g,this.pz=x,p==null||!r.isValid(p))throw new Error("x required");if(g==null||!r.isValid(g))throw new Error("y required");if(x==null||!r.isValid(x))throw new Error("z required")}static fromAffine(p){let{x:g,y:x}=p||{};if(!p||!r.isValid(g)||!r.isValid(x))throw new Error("invalid affine point");if(p instanceof l)throw new Error("projective point not allowed");let w=b=>r.eql(b,r.ZERO);return w(g)&&w(x)?l.ZERO:new l(g,x,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let g=r.invertBatch(p.map(x=>x.pz));return p.map((x,w)=>x.toAffine(g[w])).map(l.fromAffine)}static fromHex(p){let g=l.fromAffine(i(Ct("pointHex",p)));return g.assertValidity(),g}static fromPrivateKey(p){return l.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y:g}=this.toAffine();if(!r.isValid(p)||!r.isValid(g))throw new Error("bad point: x or y not FE");let x=r.sqr(g),w=s(p);if(!r.eql(x,w))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){f(p);let{px:g,py:x,pz:w}=this,{px:b,py:T,pz:E}=p,S=r.eql(r.mul(g,E),r.mul(b,w)),L=r.eql(r.mul(x,E),r.mul(T,w));return S&&L}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:g}=t,x=r.mul(g,kf),{px:w,py:b,pz:T}=this,E=r.ZERO,S=r.ZERO,L=r.ZERO,k=r.mul(w,w),G=r.mul(b,b),W=r.mul(T,T),H=r.mul(w,b);return H=r.add(H,H),L=r.mul(w,T),L=r.add(L,L),E=r.mul(p,L),S=r.mul(x,W),S=r.add(E,S),E=r.sub(G,S),S=r.add(G,S),S=r.mul(E,S),E=r.mul(H,E),L=r.mul(x,L),W=r.mul(p,W),H=r.sub(k,W),H=r.mul(p,H),H=r.add(H,L),L=r.add(k,k),k=r.add(L,k),k=r.add(k,W),k=r.mul(k,H),S=r.add(S,k),W=r.mul(b,T),W=r.add(W,W),k=r.mul(W,H),E=r.sub(E,k),L=r.mul(W,G),L=r.add(L,L),L=r.add(L,L),new l(E,S,L)}add(p){f(p);let{px:g,py:x,pz:w}=this,{px:b,py:T,pz:E}=p,S=r.ZERO,L=r.ZERO,k=r.ZERO,G=t.a,W=r.mul(t.b,kf),H=r.mul(g,b),j=r.mul(x,T),ft=r.mul(w,E),Ht=r.add(g,x),I=r.add(b,T);Ht=r.mul(Ht,I),I=r.add(H,j),Ht=r.sub(Ht,I),I=r.add(g,w);let D=r.add(b,E);return I=r.mul(I,D),D=r.add(H,ft),I=r.sub(I,D),D=r.add(x,w),S=r.add(T,E),D=r.mul(D,S),S=r.add(j,ft),D=r.sub(D,S),k=r.mul(G,I),S=r.mul(W,ft),k=r.add(S,k),S=r.sub(j,k),k=r.add(j,k),L=r.mul(S,k),j=r.add(H,H),j=r.add(j,H),ft=r.mul(G,ft),I=r.mul(W,I),j=r.add(j,ft),ft=r.sub(H,ft),ft=r.mul(G,ft),I=r.add(I,ft),H=r.mul(j,I),L=r.add(L,H),H=r.mul(D,I),S=r.mul(Ht,S),S=r.sub(S,H),H=r.mul(Ht,j),k=r.mul(D,k),k=r.add(k,H),new l(S,L,k)}subtract(p){return this.add(p.negate())}is0(){return this.equals(l.ZERO)}wNAF(p){return y.wNAFCached(this,u,p,g=>{let x=r.invertBatch(g.map(w=>w.pz));return g.map((w,b)=>w.toAffine(x[b])).map(l.fromAffine)})}multiplyUnsafe(p){let g=l.ZERO;if(p===Je)return g;if(a(p),p===ye)return this;let{endo:x}=t;if(!x)return y.unsafeLadder(this,p);let{k1neg:w,k1:b,k2neg:T,k2:E}=x.splitScalar(p),S=g,L=g,k=this;for(;b>Je||E>Je;)b&ye&&(S=S.add(k)),E&ye&&(L=L.add(k)),k=k.double(),b>>=ye,E>>=ye;return w&&(S=S.negate()),T&&(L=L.negate()),L=new l(r.mul(L.px,x.beta),L.py,L.pz),S.add(L)}multiply(p){a(p);let g=p,x,w,{endo:b}=t;if(b){let{k1neg:T,k1:E,k2neg:S,k2:L}=b.splitScalar(g),{p:k,f:G}=this.wNAF(E),{p:W,f:H}=this.wNAF(L);k=y.constTimeNegate(T,k),W=y.constTimeNegate(S,W),W=new l(r.mul(W.px,b.beta),W.py,W.pz),x=k.add(W),w=G.add(H)}else{let{p:T,f:E}=this.wNAF(g);x=T,w=E}return l.normalizeZ([x,w])[0]}multiplyAndAddUnsafe(p,g,x){let w=l.BASE,b=(E,S)=>S===Je||S===ye||!E.equals(w)?E.multiplyUnsafe(S):E.multiply(S),T=b(this,g).add(b(p,x));return T.is0()?void 0:T}toAffine(p){let{px:g,py:x,pz:w}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(w));let T=r.mul(g,p),E=r.mul(x,p),S=r.mul(w,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(S,r.ONE))throw new Error("invZ was invalid");return{x:T,y:E}}isTorsionFree(){let{h:p,isTorsionFree:g}=t;if(p===ye)return!0;if(g)return g(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:g}=t;return p===ye?this:g?g(l,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return this.assertValidity(),n(l,this,p)}toHex(p=!0){return We(this.toRawBytes(p))}}l.BASE=new l(t.Gx,t.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);let h=t.nBitLength,y=qi(l,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}function Rg(e){let t=Fn(e);return Pe(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Pf(e){let t=Rg(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(I){return Je<I&&I<r.ORDER}function a(I){return ht(I,n)}function c(I){return Mi(I,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:f,weierstrassEquation:l,isWithinCurveOrder:h}=Tg({...t,toBytes(I,D,R){let P=D.toAffine(),A=r.toBytes(P.x),K=Qe;return R?K(Uint8Array.from([D.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(P.y))},fromBytes(I){let D=I.length,R=I[0],P=I.subarray(1);if(D===i&&(R===2||R===3)){let A=$e(P);if(!o(A))throw new Error("Point is not on curve");let K=l(A),M=r.sqrt(K),z=(M&ye)===ye;return(R&1)===1!==z&&(M=r.neg(M)),{x:A,y:M}}else if(D===s&&R===4){let A=r.fromBytes(P.subarray(0,r.BYTES)),K=r.fromBytes(P.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${D} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),y=I=>We(dr(I,t.nByteLength));function d(I){let D=n>>ye;return I>D}function p(I){return d(I)?a(-I):I}let g=(I,D,R)=>$e(I.slice(D,R));class x{constructor(D,R,P){this.r=D,this.s=R,this.recovery=P,this.assertValidity()}static fromCompact(D){let R=t.nByteLength;return D=Ct("compactSignature",D,R*2),new x(g(D,0,R),g(D,R,2*R))}static fromDER(D){let{r:R,s:P}=qr.toSig(Ct("DER",D));return new x(R,P)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(D){return new x(this.r,this.s,D)}recoverPublicKey(D){let{r:R,s:P,recovery:A}=this,K=L(Ct("msgHash",D));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let M=A===2||A===3?R+t.n:R;if(M>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let z=A&1?"03":"02",X=u.fromHex(z+y(M)),tt=c(M),ct=a(-K*tt),et=a(P*tt),st=u.BASE.multiplyAndAddUnsafe(X,ct,et);if(!st)throw new Error("point at infinify");return st.assertValidity(),st}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return kr(this.toDERHex())}toDERHex(){return qr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return kr(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let w={isValidPrivateKey(I){try{return f(I),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let I=Ao(t.n);return lu(t.randomBytes(I),t.n)},precompute(I=8,D=u.BASE){return D._setWindowSize(I),D.multiply(BigInt(3)),D}};function b(I,D=!0){return u.fromPrivateKey(I).toRawBytes(D)}function T(I){let D=I instanceof Uint8Array,R=typeof I=="string",P=(D||R)&&I.length;return D?P===i||P===s:R?P===2*i||P===2*s:I instanceof u}function E(I,D,R=!0){if(T(I))throw new Error("first arg must be private key");if(!T(D))throw new Error("second arg must be public key");return u.fromHex(D).multiply(f(I)).toRawBytes(R)}let S=t.bits2int||function(I){let D=$e(I),R=I.length*8-t.nBitLength;return R>0?D>>BigInt(R):D},L=t.bits2int_modN||function(I){return a(S(I))},k=Mn(t.nBitLength);function G(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(Je<=I&&I<k))throw new Error(`bigint expected < 2^${t.nBitLength}`);return dr(I,t.nByteLength)}function W(I,D,R=H){if(["recovered","canonical"].some(Bt=>Bt in R))throw new Error("sign() legacy options not supported");let{hash:P,randomBytes:A}=t,{lowS:K,prehash:M,extraEntropy:z}=R;K==null&&(K=!0),I=Ct("msgHash",I),M&&(I=Ct("prehashed msgHash",P(I)));let X=L(I),tt=f(D),ct=[G(tt),G(X)];if(z!=null){let Bt=z===!0?A(r.BYTES):z;ct.push(Ct("extraEntropy",Bt))}let et=Qe(...ct),st=X;function Rt(Bt){let zt=S(Bt);if(!h(zt))return;let Gt=c(zt),Nt=u.BASE.multiply(zt).toAffine(),Qt=a(Nt.x);if(Qt===Je)return;let Me=a(Gt*a(st+Qt*tt));if(Me===Je)return;let Er=(Nt.x===Qt?0:2)|Number(Nt.y&ye),_n=Me;return K&&d(Me)&&(_n=p(Me),Er^=1),new x(Qt,_n,Er)}return{seed:et,k2sig:Rt}}let H={lowS:t.lowS,prehash:!1},j={lowS:t.lowS,prehash:!1};function ft(I,D,R=H){let{seed:P,k2sig:A}=W(I,D,R),K=t;return wo(K.hash.outputLen,K.nByteLength,K.hmac)(P,A)}u.BASE._setWindowSize(8);function Ht(I,D,R,P=j){let A=I;if(D=Ct("msgHash",D),R=Ct("publicKey",R),"strict"in P)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:M}=P,z,X;try{if(typeof A=="string"||A instanceof Uint8Array)try{z=x.fromDER(A)}catch(Nt){if(!(Nt instanceof qr.Err))throw Nt;z=x.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:Nt,s:Qt}=A;z=new x(Nt,Qt)}else throw new Error("PARSE");X=u.fromHex(R)}catch(Nt){if(Nt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&z.hasHighS())return!1;M&&(D=t.hash(D));let{r:tt,s:ct}=z,et=L(D),st=c(ct),Rt=a(et*st),Bt=a(tt*st),zt=u.BASE.multiplyAndAddUnsafe(X,Rt,Bt)?.toAffine();return zt?a(zt.x)===tt:!1}return{CURVE:t,getPublicKey:b,getSharedSecret:E,sign:ft,verify:Ht,ProjectivePoint:u,Signature:x,utils:w}}var ji=class extends ln{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,jc(t);let n=On(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return fn(this),this.iHash.update(t),this}digestInto(t){fn(this),po(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},na=(e,t,r)=>new ji(e,t).update(r).digest();na.create=(e,t)=>new ji(e,t);function Lg(e){return{hash:e,hmac:(t,...r)=>na(e,t,Pi(...r)),randomBytes:hn}}function Df(e,t){let r=n=>Pf({...e,...Lg(n)});return Object.freeze({...r(t),create:r})}var Kf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Nf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),kg=BigInt(1),ia=BigInt(2),Uf=(e,t)=>(e+t/ia)/t;function Pg(e){let t=Kf,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,f=u*u*e%t,l=bt(f,r,t)*f%t,h=bt(l,r,t)*f%t,y=bt(h,ia,t)*u%t,d=bt(y,i,t)*y%t,p=bt(d,s,t)*d%t,g=bt(p,a,t)*p%t,x=bt(g,c,t)*g%t,w=bt(x,a,t)*p%t,b=bt(w,r,t)*f%t,T=bt(b,o,t)*d%t,E=bt(T,n,t)*u%t,S=bt(E,ia,t);if(!sa.eql(sa.sqr(S),e))throw new Error("Cannot find square root");return S}var sa=Fi(Kf,void 0,void 0,{sqrt:Pg}),je=Df({a:BigInt(0),b:BigInt(7),Fp:sa,n:Nf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Nf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-kg*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Uf(s*e,t),c=Uf(-n*e,t),u=ht(e-a*r-c*i,t),f=ht(-a*n-c*s,t),l=u>o,h=f>o;if(l&&(u=t-u),h&&(f=t-f),u>o||f>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:u,k2neg:h,k2:f}}}},Lf),$b=BigInt(0);var Qb=je.ProjectivePoint;function Of(){return je.utils.randomPrivateKey()}async function Mf(e,t){let{digest:r}=await Wt.digest(t);try{return je.sign(r,e).toDERRawBytes()}catch(n){throw new q(String(n),"ERR_INVALID_INPUT")}}async function Ff(e,t,r){try{let{digest:n}=await Wt.digest(r);return je.verify(t,n,e)}catch(n){throw new q(String(n),"ERR_INVALID_INPUT")}}function qf(e){return je.ProjectivePoint.fromHex(e).toRawBytes(!0)}function Vf(e){try{je.getPublicKey(e,!0)}catch(t){throw new q(String(t),"ERR_INVALID_PRIVATE_KEY")}}function oa(e){try{je.ProjectivePoint.fromHex(e)}catch(t){throw new q(String(t),"ERR_INVALID_PUBLIC_KEY")}}function Hf(e){try{return je.getPublicKey(e,!0)}catch(t){throw new q(String(t),"ERR_INVALID_PRIVATE_KEY")}}var Qn=class{_key;constructor(t){oa(t),this._key=t}async verify(t,r){return Ff(this._key,r,t)}marshal(){return qf(this._key)}get bytes(){return Ne.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Et(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Wt.digest(this.bytes);return t}},Yn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r??Hf(t),Vf(this._key),oa(this._publicKey)}async sign(t){return Mf(this._key,t)}get public(){return new Qn(this._publicKey)}marshal(){return this._key}get bytes(){return Ue.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Et(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Wt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return ut(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return gn(this.bytes,t);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Ng(e){return new Yn(e)}function Ug(e){return new Qn(e)}async function Kg(){let e=Of();return new Yn(e)}var Vr={rsa:ea,ed25519:Zo,secp256k1:aa};function zf(e){let t=Object.keys(Vr).join(" / ");return new q(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Gf(e){let t=Ne.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case wt.RSA:return Vr.rsa.unmarshalRsaPublicKey(r);case wt.Ed25519:return Vr.ed25519.unmarshalEd25519PublicKey(r);case wt.Secp256k1:return Vr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw zf(t.Type??"unknown")}}async function Wf(e){let t=Ue.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case wt.RSA:return Vr.rsa.unmarshalRsaPrivateKey(r);case wt.Ed25519:return Vr.ed25519.unmarshalEd25519PrivateKey(r);case wt.Secp256k1:return Vr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw zf(t.Type??"RSA")}}var ca=Symbol.for("@libp2p/peer-id");function $f(e){return e!=null&&!!e[ca]}var Mg=Symbol.for("nodejs.util.inspect.custom"),Qf=Object.values(ur).map(e=>e.decoder).reduce((e,t)=>e.or(t),ur.identity.decoder),Yf=114,ua=36,fa=37,Zn=class{type;multihash;privateKey;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[ca]=!0;toString(){return this.string==null&&(this.string=It.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return xe.createV1(Yf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Et(this.multihash.bytes,t);if(typeof t=="string")return Dt(t).equals(this);if(t?.multihash?.bytes!=null)return Et(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[Mg](){return`PeerId(${this.toString()})`}},Hr=class extends Zn{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},zr=class extends Zn{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.multihash.digest}},Gr=class extends Zn{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.multihash.digest}};function Zf(e){if(e.type==="RSA")return new Hr(e);if(e.type==="Ed25519")return new zr(e);if(e.type==="secp256k1")return new Gr(e);throw new q("Not a PeerId","ERR_INVALID_PARAMETERS")}function Dt(e,t){if(t=t??Qf,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=Rr(It.decode(`z${e}`));return e.startsWith("12D")?new zr({multihash:r}):e.startsWith("16U")?new Gr({multihash:r}):new Hr({multihash:r})}return Xn(Qf.decode(e))}function Xn(e){try{let t=Rr(e);if(t.code===cr.code){if(t.digest.length===ua)return new zr({multihash:t});if(t.digest.length===fa)return new Gr({multihash:t})}if(t.code===Wt.code)return new Hr({multihash:t})}catch{return Fg(xe.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Fg(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==Yf)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Wt.code)return new Hr({multihash:e.multihash});if(t.code===cr.code){if(t.digest.length===ua)return new zr({multihash:e.multihash});if(t.digest.length===fa)return new Gr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Xf(e,t){return e.length===ua?new zr({multihash:ke(cr.code,e),privateKey:t}):e.length===fa?new Gr({multihash:ke(cr.code,e),privateKey:t}):new Hr({multihash:await Wt.digest(e),publicKey:e,privateKey:t})}var qg=Math.pow(2,7),Vg=Math.pow(2,14),Hg=Math.pow(2,21),la=Math.pow(2,28),ha=Math.pow(2,35),da=Math.pow(2,42),pa=Math.pow(2,49),at=128,Yt=127;function Ke(e){if(e<qg)return 1;if(e<Vg)return 2;if(e<Hg)return 3;if(e<la)return 4;if(e<ha)return 5;if(e<da)return 6;if(e<pa)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function zg(e,t,r=0){switch(Ke(e)){case 8:t[r++]=e&255|at,e/=128;case 7:t[r++]=e&255|at,e/=128;case 6:t[r++]=e&255|at,e/=128;case 5:t[r++]=e&255|at,e/=128;case 4:t[r++]=e&255|at,e>>>=7;case 3:t[r++]=e&255|at,e>>>=7;case 2:t[r++]=e&255|at,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function Gg(e,t,r=0){switch(Ke(e)){case 8:t.set(r++,e&255|at),e/=128;case 7:t.set(r++,e&255|at),e/=128;case 6:t.set(r++,e&255|at),e/=128;case 5:t.set(r++,e&255|at),e/=128;case 4:t.set(r++,e&255|at),e>>>=7;case 3:t.set(r++,e&255|at),e>>>=7;case 2:t.set(r++,e&255|at),e>>>=7;case 1:{t.set(r++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return t}function Wg(e,t){let r=e[t],n=0;if(n+=r&Yt,r<at||(r=e[t+1],n+=(r&Yt)<<7,r<at)||(r=e[t+2],n+=(r&Yt)<<14,r<at)||(r=e[t+3],n+=(r&Yt)<<21,r<at)||(r=e[t+4],n+=(r&Yt)*la,r<at)||(r=e[t+5],n+=(r&Yt)*ha,r<at)||(r=e[t+6],n+=(r&Yt)*da,r<at)||(r=e[t+7],n+=(r&Yt)*pa,r<at))return n;throw new RangeError("Could not decode varint")}function $g(e,t){let r=e.get(t),n=0;if(n+=r&Yt,r<at||(r=e.get(t+1),n+=(r&Yt)<<7,r<at)||(r=e.get(t+2),n+=(r&Yt)<<14,r<at)||(r=e.get(t+3),n+=(r&Yt)<<21,r<at)||(r=e.get(t+4),n+=(r&Yt)*la,r<at)||(r=e.get(t+5),n+=(r&Yt)*ha,r<at)||(r=e.get(t+6),n+=(r&Yt)*da,r<at)||(r=e.get(t+7),n+=(r&Yt)*pa,r<at))return n;throw new RangeError("Could not decode varint")}function Oe(e,t,r=0){return t==null&&(t=Ge(Ke(e))),t instanceof Uint8Array?zg(e,t,r):Gg(e,t,r)}function Wr(e,t=0){return e instanceof Uint8Array?Wg(e,t):$g(e,t)}var jf=Symbol.for("@achingbrain/uint8arraylist");function Jf(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function ts(e){return!!e?.[jf]}var es=class e{constructor(...t){Object.defineProperty(this,jf,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ts(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(ts(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Jf(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Jf(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(ts(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Kt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Kt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new e;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,c=a+o.byteLength;if(i=c,t>=c)continue;let u=t>=a&&t<c,f=r>a&&r<=c;if(u&&f){if(t===a&&r===c){n.push(o);break}let l=t-a;n.push(o.subarray(l,l+(r-t)));break}if(u){if(t===0){n.push(o);continue}n.push(o.subarray(t-a));continue}if(f){if(r===c){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!ts(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,o=new Int32Array(s);for(let l=0;l<s;l++)o[l]=-1;for(let l=0;l<i;l++)o[n[l]]=l;let a=o,c=this.byteLength-n.byteLength,u=n.byteLength-1,f;for(let l=r;l<=c;l+=f){f=0;for(let h=u;h>=0;h--){let y=this.get(l+h);if(n[h]!==y){f=Math.max(1,h-a[y]);break}}if(f===0)return l}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Ge(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=ze(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=ze(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=ze(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Ge(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=ze(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=ze(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=ze(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=ze(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=ze(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Et(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};var tl={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var Jn;(function(e){let t;e.codec=()=>(t==null&&(t=ee((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.publicKey!=null&&r.publicKey.byteLength>0&&(n.uint32(10),n.bytes(r.publicKey)),r.payloadType!=null&&r.payloadType.byteLength>0&&(n.uint32(18),n.bytes(r.payloadType)),r.payload!=null&&r.payload.byteLength>0&&(n.uint32(26),n.bytes(r.payload)),r.signature!=null&&r.signature.byteLength>0&&(n.uint32(42),n.bytes(r.signature)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.publicKey=r.bytes();break;case 2:i.payloadType=r.bytes();break;case 3:i.payload=r.bytes();break;case 5:i.signature=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>te(r,e.codec()),e.decode=r=>jt(r,e.codec())})(Jn||(Jn={}));var wn=class e{static createFromProtobuf=async t=>{let r=Jn.decode(t),n=await Xf(r.publicKey);return new e({peerId:n,payloadType:r.payloadType,payload:r.payload,signature:r.signature})};static seal=async(t,r)=>{if(r.privateKey==null)throw new Error("Missing private key");let n=t.domain,i=t.codec,s=t.marshal(),o=el(n,i,s),c=await(await Wf(r.privateKey)).sign(o.subarray());return new e({peerId:r,payloadType:i,payload:s,signature:c})};static openAndCertify=async(t,r)=>{let n=await e.createFromProtobuf(t);if(!await n.validate(r))throw new q("envelope signature is not valid for the given domain",tl.ERR_SIGNATURE_NOT_VALID);return n};peerId;payloadType;payload;signature;marshaled;constructor(t){let{peerId:r,payloadType:n,payload:i,signature:s}=t;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=Jn.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return Et(this.marshal(),t.marshal())}async validate(t){let r=el(t,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return Gf(this.peerId.publicKey).verify(r.subarray(),this.signature)}},el=(e,t,r)=>{let n=Pt(e),i=Oe(n.byteLength),s=Oe(t.length),o=Oe(r.length);return new es(i,n,s,t,o,r)};function rl(e,t){let r=(n,i)=>n.toString().localeCompare(i.toString());return e.length!==t.length?!1:(t.sort(r),e.sort(r).every((n,i)=>t[i].equals(n)))}var rs=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){let r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,i){return this.readAtomically(()=>{let s=0,o=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",u=2**(8*i)-1;for(;;){let f=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let h=Number.parseInt(l,t);if(!Number.isNaN(h))return h});if(f===void 0)break;if(s*=t,s+=f,s>u||(o+=1,r!==void 0&&o>r))return}if(o!==0)return!n&&c&&o>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let r=0;r<t.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){let t=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let o=this.readSeparator(":",n,()=>this.readIPv4Addr());if(o!==void 0)return r[i]=o[0],r[i+1]=o[1],r[i+2]=o[2],r[i+3]=o[3],[i+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[i,!1];r[i]=s>>8,r[i+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=t(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),o=16-(n+2),[a]=t(s.subarray(0,o));return r.set(s.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var nl=45,Qg=15,En=new rs;function ga(e){if(!(e.length>Qg))return En.new(e).parseWith(()=>En.readIPv4Addr())}function ma(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>nl))return En.new(e).parseWith(()=>En.readIPv6Addr())}function ns(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>nl))return En.new(e).parseWith(()=>En.readIPAddr())}var Jw=parseInt("0xFFFF",16),jw=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function ol(e){return!!ga(e)}function al(e){return!!ma(e)}function is(e){return!!ns(e)}var cl=ol,jg=al,xa=function(e){let t=0;if(e=e.toString().trim(),cl(e)){let r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(jg(e)){let r=e.split(":",8),n;for(n=0;n<r.length;n++){let s=cl(r[n]),o;s&&(o=xa(r[n]),r[n]=ut(o.slice(0,2),"base16")),o!=null&&++n<8&&r.splice(n,0,ut(o.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let i=new Uint8Array(t+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);i[t++]=s>>8&255,i[t++]=s&255}return i}throw new Error("invalid ip address")},ul=function(e,t=0,r){t=~~t,r=r??e.length-t;let n=new DataView(e.buffer);if(r===4){let i=[];for(let s=0;s<r;s++)i.push(e[t+s]);return i.join(".")}if(r===16){let i=[];for(let s=0;s<r;s+=2)i.push(n.getUint16(t+s).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Sn={},va={},em=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];em.forEach(e=>{let t=rm(...e);va[t.code]=t,Sn[t.name]=t});function rm(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:!!n,path:!!i}}function pt(e){if(typeof e=="number"){if(va[e]!=null)return va[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Sn[e]!=null)return Sn[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var U4=pt("ip4"),K4=pt("ip6"),O4=pt("ipcidr");function wa(e,t){switch(pt(e).code){case 4:case 41:return im(t);case 42:return hl(t);case 6:case 273:case 33:case 132:return pl(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return hl(t);case 421:return cm(t);case 444:return dl(t);case 445:return dl(t);case 466:return am(t);default:return ut(t,"base16")}}function Ea(e,t){switch(pt(e).code){case 4:return fl(t);case 41:return fl(t);case 42:return ll(t);case 6:case 273:case 33:case 132:return Sa(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return ll(t);case 421:return sm(t);case 444:return um(t);case 445:return fm(t);case 466:return om(t);default:return Pt(t,"base16")}}var ba=Object.values(ur).map(e=>e.decoder),nm=function(){let e=ba[0].or(ba[1]);return ba.slice(2).forEach(t=>e=e.or(t)),e}();function fl(e){if(!is(e))throw new Error("invalid ip address");return xa(e)}function im(e){let t=ul(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!is(t))throw new Error("invalid ip address");return t}function Sa(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function pl(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function ll(e){let t=Pt(e),r=Uint8Array.from(Oe(t.length));return Kt([r,t],r.length+t.length)}function hl(e){let t=Wr(e);if(e=e.slice(Ke(t)),e.length!==t)throw new Error("inconsistent lengths");return ut(e)}function sm(e){let t;e[0]==="Q"||e[0]==="1"?t=Rr(It.decode(`z${e}`)).bytes:t=xe.parse(e).multihash.bytes;let r=Uint8Array.from(Oe(t.length));return Kt([r,t],r.length+t.length)}function om(e){let t=nm.decode(e),r=Uint8Array.from(Oe(t.length));return Kt([r,t],r.length+t.length)}function am(e){let t=Wr(e),r=e.slice(Ke(t));if(r.length!==t)throw new Error("inconsistent lengths");return"u"+ut(r,"base64url")}function cm(e){let t=Wr(e),r=e.slice(Ke(t));if(r.length!==t)throw new Error("inconsistent lengths");return ut(r,"base58btc")}function um(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=oe.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Sa(n);return Kt([r,i],r.length+i.length)}function fm(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=oe.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Sa(n);return Kt([r,i],r.length+i.length)}function dl(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=ut(t,"base32"),i=pl(r);return`${n}:${i}`}function yl(e){e=Ba(e);let t=[],r=[],n=null,i=e.split("/").slice(1);if(i.length===1&&i[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<i.length;s++){let o=i[s],a=pt(o);if(a.size===0){t.push([a.code]),r.push([a.code]);continue}if(s++,s>=i.length)throw ml("invalid address: "+e);if(a.path===!0){n=Ba(i.slice(s).join("/")),t.push([a.code,Ea(a.code,n)]),r.push([a.code,n]);break}let c=Ea(a.code,i[s]);t.push([a.code,c]),r.push([a.code,wa(a.code,c)])}return{string:gl(r),bytes:Ca(t),tuples:t,stringTuples:r,path:n}}function Aa(e){let t=[],r=[],n=null,i=0;for(;i<e.length;){let s=Wr(e,i),o=Ke(s),a=pt(s),c=lm(a,e.slice(i+o));if(c===0){t.push([s]),r.push([s]),i+=o;continue}let u=e.slice(i+o,i+o+c);if(i+=c+o,i>e.length)throw ml("Invalid address Uint8Array: "+ut(e,"base16"));t.push([s,u]);let f=wa(s,u);if(r.push([s,f]),a.path===!0){n=f;break}}return{bytes:Uint8Array.from(e),string:gl(r),tuples:t,stringTuples:r,path:n}}function gl(e){let t=[];return e.map(r=>{let n=pt(r[0]);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),Ba(t.join("/"))}function Ca(e){return Kt(e.map(t=>{let r=pt(t[0]),n=Uint8Array.from(Oe(r.code));return t.length>1&&t[1]!=null&&(n=Kt([n,t[1]])),n}))}function lm(e,t){if(e.size>0)return e.size/8;if(e.size===0)return 0;{let r=Wr(t instanceof Uint8Array?t:Uint8Array.from(t));return r+Ke(r)}}function Ba(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function ml(e){return new Error("Error parsing address: "+e)}var hm=Symbol.for("nodejs.util.inspect.custom"),dm=[pt("dns").code,pt("dns4").code,pt("dns6").code,pt("dnsaddr").code],pm=new Map,xl=Symbol.for("@multiformats/js-multiaddr/multiaddr");function _a(e){return!!e?.[xl]}var Ia=class e{bytes;#t;#e;#r;#n;[xl]=!0;constructor(t){t==null&&(t="");let r;if(t instanceof Uint8Array)r=Aa(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);r=yl(t)}else if(_a(t))r=Aa(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#t=r.string,this.#e=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#t}toJSON(){return this.toString()}toOptions(){let t,r,n,i,s="",o=pt("tcp"),a=pt("udp"),c=pt("ip4"),u=pt("ip6"),f=pt("dns6"),l=pt("ip6zone");for(let[y,d]of this.stringTuples())y===l.code&&(s=`%${d??""}`),dm.includes(y)&&(r=o.name,i=443,n=`${d??""}${s}`,t=y===f.code?6:4),(y===o.code||y===a.code)&&(r=pt(y).name,i=parseInt(d??"")),(y===c.code||y===u.code)&&(r=pt(y).name,n=`${d??""}${s}`,t=y===u.code?6:4);if(t==null||r==null||n==null||i==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:i}}protos(){return this.#e.map(([t])=>Object.assign({},pt(t)))}protoCodes(){return this.#e.map(([t])=>t)}protoNames(){return this.#e.map(([t])=>pt(t).name)}tuples(){return this.#e}stringTuples(){return this.#r}encapsulate(t){return t=new e(t),new e(this.toString()+t.toString())}decapsulate(t){let r=t.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new e(n.slice(0,i))}decapsulateCode(t){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new e(Ca(r.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,i])=>{n===Sn.p2p.code&&t.push([n,i]),n===Sn["p2p-circuit"].code&&(t=[])});let r=t.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?ut(It.decode(`z${n}`),"base58btc"):ut(xe.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(t){return Et(this.bytes,t.bytes)}async resolve(t){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=pm.get(r.name);if(n==null)throw new q(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new e(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[hm](){return`Multiaddr(${this.#t})`}};function $r(e){return new Ia(e)}var vl="libp2p-peer-record",bl=Uint8Array.from([3,1]);var jn;(function(e){let t;(function(n){let i;n.codec=()=>(i==null&&(i=ee((s,o,a={})=>{a.lengthDelimited!==!1&&o.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(o.uint32(10),o.bytes(s.multiaddr)),a.lengthDelimited!==!1&&o.ldelim()},(s,o)=>{let a={multiaddr:new Uint8Array(0)},c=o==null?s.len:s.pos+o;for(;s.pos<c;){let u=s.uint32();switch(u>>>3){case 1:a.multiaddr=s.bytes();break;default:s.skipType(u&7);break}}return a})),i),n.encode=s=>te(s,n.codec()),n.decode=s=>jt(s,n.codec())})(t=e.AddressInfo||(e.AddressInfo={}));let r;e.codec=()=>(r==null&&(r=ee((n,i,s={})=>{if(s.lengthDelimited!==!1&&i.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(i.uint32(10),i.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(i.uint32(16),i.uint64(n.seq)),n.addresses!=null)for(let o of n.addresses)i.uint32(26),e.AddressInfo.codec().encode(o,i);s.lengthDelimited!==!1&&i.ldelim()},(n,i)=>{let s={peerId:new Uint8Array(0),seq:0n,addresses:[]},o=i==null?n.len:n.pos+i;for(;n.pos<o;){let a=n.uint32();switch(a>>>3){case 1:s.peerId=n.bytes();break;case 2:s.seq=n.uint64();break;case 3:s.addresses.push(e.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return s})),r),e.encode=n=>te(n,e.codec()),e.decode=n=>jt(n,e.codec())})(jn||(jn={}));var Qr=class e{static createFromProtobuf=t=>{let r=jn.decode(t),n=Xn(r.peerId),i=(r.addresses??[]).map(o=>$r(o.multiaddr)),s=r.seq;return new e({peerId:n,multiaddrs:i,seqNumber:s})};static DOMAIN=vl;static CODEC=bl;peerId;multiaddrs;seqNumber;domain=e.DOMAIN;codec=e.CODEC;marshaled;constructor(t){let{peerId:r,multiaddrs:n,seqNumber:i}=t;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=jn.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof e)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!rl(this.multiaddrs,t.multiaddrs))}};function ym(e){return e[Symbol.asyncIterator]!=null}function gm(e){if(ym(e))return(async()=>{let r=[];for await(let n of e)r.push(n);return r})();let t=[];for(let r of e)t.push(r);return t}var wl=gm;function tr(e,t){let r={[Symbol.iterator]:()=>r,next:()=>{let n=e.next(),i=n.value;return n.done===!0||i==null?{done:!0,value:void 0}:{done:!1,value:t(i)}}};return r}var ti=class{map;constructor(t){if(this.map=new Map,t!=null)for(let[r,n]of t.entries())this.map.set(r.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(t){this.map.delete(t.toString())}entries(){return tr(this.map.entries(),t=>[Dt(t[0]),t[1]])}forEach(t){this.map.forEach((r,n)=>{t(r,Dt(n),this)})}get(t){return this.map.get(t.toString())}has(t){return this.map.has(t.toString())}set(t,r){this.map.set(t.toString(),r)}keys(){return tr(this.map.keys(),t=>Dt(t))}values(){return this.map.values()}get size(){return this.map.size}};var Ta=class e{set;constructor(t){if(this.set=new Set,t!=null)for(let r of t)this.set.add(r.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(t){this.set.add(t.toString())}clear(){this.set.clear()}delete(t){this.set.delete(t.toString())}entries(){return tr(this.set.entries(),t=>{let r=Dt(t[0]);return[r,r]})}forEach(t){this.set.forEach(r=>{let n=Dt(r);t(n,n,this)})}has(t){return this.set.has(t.toString())}values(){return tr(this.set.values(),t=>Dt(t))}intersection(t){let r=new e;for(let n of t)this.has(n)&&r.add(n);return r}difference(t){let r=new e;for(let n of this)t.has(n)||r.add(n);return r}union(t){let r=new e;for(let n of t)r.add(n);for(let n of this)r.add(n);return r}};var Ra=class e{list;constructor(t){if(this.list=[],t!=null)for(let r of t)this.list.push(r.toString())}[Symbol.iterator](){return tr(this.list.entries(),t=>Dt(t[1]))}concat(t){let r=new e(this);for(let n of t)r.push(n);return r}entries(){return tr(this.list.entries(),t=>[t[0],Dt(t[1])])}every(t){return this.list.every((r,n)=>t(Dt(r),n,this))}filter(t){let r=new e;return this.list.forEach((n,i)=>{let s=Dt(n);t(s,i,this)&&r.push(s)}),r}find(t){let r=this.list.find((n,i)=>t(Dt(n),i,this));if(r!=null)return Dt(r)}findIndex(t){return this.list.findIndex((r,n)=>t(Dt(r),n,this))}forEach(t){this.list.forEach((r,n)=>{t(Dt(r),n,this)})}includes(t){return this.list.includes(t.toString())}indexOf(t){return this.list.indexOf(t.toString())}pop(){let t=this.list.pop();if(t!=null)return Dt(t)}push(...t){for(let r of t)this.list.push(r.toString())}shift(){let t=this.list.shift();if(t!=null)return Dt(t)}unshift(...t){let r=this.list.length;for(let n=t.length-1;n>-1;n--)r=this.list.unshift(t[n].toString());return r}get length(){return this.list.length}};var ka=Lt(Sl(),1);var ri=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},Pa=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},Bl=e=>globalThis.DOMException===void 0?new Pa(e):new DOMException(e),Al=e=>{let t=e.reason===void 0?Bl("This operation was aborted."):e.reason;return t instanceof Error?t:Bl(t)};function Da(e,t,r,n){let i,s=new Promise((o,a)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){o(e);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&a(Al(c)),c.addEventListener("abort",()=>{a(Al(c))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{o(r())}catch(f){a(f)}return}let c=typeof r=="string"?r:`Promise timed out after ${t} milliseconds`,u=r instanceof Error?r:new ri(c);typeof e.cancel=="function"&&e.cancel(),a(u)},t),(async()=>{try{o(await e)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return s.clear=()=>{clearTimeout(i),i=void 0},s}function Na(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),o=n+s;r(e[o],t)<=0?(n=++o,i-=s+1):i=s}return n}var Yr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},er,Ua=class{constructor(){er.set(this,[])}enqueue(t,r){r={priority:0,...r};let n={priority:r.priority,run:t};if(this.size&&Yr(this,er,"f")[this.size-1].priority>=r.priority){Yr(this,er,"f").push(n);return}let i=Na(Yr(this,er,"f"),n,(s,o)=>o.priority-s.priority);Yr(this,er,"f").splice(i,0,n)}dequeue(){let t=Yr(this,er,"f").shift();return t?.run}filter(t){return Yr(this,er,"f").filter(r=>r.priority===t.priority).map(r=>r.run)}get size(){return Yr(this,er,"f").length}};er=new WeakMap;var Cl=Ua;var St=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},O=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Tt,ii,si,vr,ls,oi,os,Ae,ni,fe,as,le,ai,xr,cs,Il,_l,Ll,Tl,Rl,us,Ka,Oa,hs,kl,fs,ds=class extends Error{},Ma=class extends ka.default{constructor(t){var r,n,i,s;if(super(),Tt.add(this),ii.set(this,void 0),si.set(this,void 0),vr.set(this,0),ls.set(this,void 0),oi.set(this,void 0),os.set(this,0),Ae.set(this,void 0),ni.set(this,void 0),fe.set(this,void 0),as.set(this,void 0),le.set(this,0),ai.set(this,void 0),xr.set(this,void 0),cs.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Cl,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=t.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=t.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof t.interval})`);St(this,ii,t.carryoverConcurrencyCount,"f"),St(this,si,t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,"f"),St(this,ls,t.intervalCap,"f"),St(this,oi,t.interval,"f"),St(this,fe,new t.queueClass,"f"),St(this,as,t.queueClass,"f"),this.concurrency=t.concurrency,this.timeout=t.timeout,St(this,cs,t.throwOnTimeout===!0,"f"),St(this,xr,t.autoStart===!1,"f")}get concurrency(){return O(this,ai,"f")}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);St(this,ai,t,"f"),O(this,Tt,"m",hs).call(this)}async add(t,r={}){return r={timeout:this.timeout,throwOnTimeout:O(this,cs,"f"),...r},new Promise((n,i)=>{O(this,fe,"f").enqueue(async()=>{var s,o,a;St(this,le,(o=O(this,le,"f"),o++,o),"f"),St(this,vr,(a=O(this,vr,"f"),a++,a),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted)throw new ds("The task was aborted.");let c=t({signal:r.signal});r.timeout&&(c=Da(Promise.resolve(c),r.timeout)),r.signal&&(c=Promise.race([c,O(this,Tt,"m",kl).call(this,r.signal)]));let u=await c;n(u),this.emit("completed",u)}catch(c){if(c instanceof ri&&!r.throwOnTimeout){n();return}i(c),this.emit("error",c)}finally{O(this,Tt,"m",Ll).call(this)}},r),this.emit("add"),O(this,Tt,"m",us).call(this)})}async addAll(t,r){return Promise.all(t.map(async n=>this.add(n,r)))}start(){return O(this,xr,"f")?(St(this,xr,!1,"f"),O(this,Tt,"m",hs).call(this),this):this}pause(){St(this,xr,!0,"f")}clear(){St(this,fe,new(O(this,as,"f")),"f")}async onEmpty(){O(this,fe,"f").size!==0&&await O(this,Tt,"m",fs).call(this,"empty")}async onSizeLessThan(t){O(this,fe,"f").size<t||await O(this,Tt,"m",fs).call(this,"next",()=>O(this,fe,"f").size<t)}async onIdle(){O(this,le,"f")===0&&O(this,fe,"f").size===0||await O(this,Tt,"m",fs).call(this,"idle")}get size(){return O(this,fe,"f").size}sizeBy(t){return O(this,fe,"f").filter(t).length}get pending(){return O(this,le,"f")}get isPaused(){return O(this,xr,"f")}};ii=new WeakMap,si=new WeakMap,vr=new WeakMap,ls=new WeakMap,oi=new WeakMap,os=new WeakMap,Ae=new WeakMap,ni=new WeakMap,fe=new WeakMap,as=new WeakMap,le=new WeakMap,ai=new WeakMap,xr=new WeakMap,cs=new WeakMap,Tt=new WeakSet,Il=function(){return O(this,si,"f")||O(this,vr,"f")<O(this,ls,"f")},_l=function(){return O(this,le,"f")<O(this,ai,"f")},Ll=function(){var t;St(this,le,(t=O(this,le,"f"),t--,t),"f"),O(this,Tt,"m",us).call(this),this.emit("next")},Tl=function(){O(this,Tt,"m",Oa).call(this),O(this,Tt,"m",Ka).call(this),St(this,ni,void 0,"f")},Rl=function(){let t=Date.now();if(O(this,Ae,"f")===void 0){let r=O(this,os,"f")-t;if(r<0)St(this,vr,O(this,ii,"f")?O(this,le,"f"):0,"f");else return O(this,ni,"f")===void 0&&St(this,ni,setTimeout(()=>{O(this,Tt,"m",Tl).call(this)},r),"f"),!0}return!1},us=function(){if(O(this,fe,"f").size===0)return O(this,Ae,"f")&&clearInterval(O(this,Ae,"f")),St(this,Ae,void 0,"f"),this.emit("empty"),O(this,le,"f")===0&&this.emit("idle"),!1;if(!O(this,xr,"f")){let t=!O(this,Tt,"a",Rl);if(O(this,Tt,"a",Il)&&O(this,Tt,"a",_l)){let r=O(this,fe,"f").dequeue();return r?(this.emit("active"),r(),t&&O(this,Tt,"m",Ka).call(this),!0):!1}}return!1},Ka=function(){O(this,si,"f")||O(this,Ae,"f")!==void 0||(St(this,Ae,setInterval(()=>{O(this,Tt,"m",Oa).call(this)},O(this,oi,"f")),"f"),St(this,os,Date.now()+O(this,oi,"f"),"f"))},Oa=function(){O(this,vr,"f")===0&&O(this,le,"f")===0&&O(this,Ae,"f")&&(clearInterval(O(this,Ae,"f")),St(this,Ae,void 0,"f")),St(this,vr,O(this,ii,"f")?O(this,le,"f"):0,"f"),O(this,Tt,"m",hs).call(this)},hs=function(){for(;O(this,Tt,"m",us).call(this););},kl=async function(t){return new Promise((r,n)=>{t.addEventListener("abort",()=>{n(new ds("The task was aborted."))},{once:!0})})},fs=async function(t,r){return new Promise(n=>{let i=()=>{r&&!r()||(this.off(t,i),n())};this.on(t,i)})};var Fa=Ma;var qa=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},Va=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},Pl=e=>globalThis.DOMException===void 0?new Va(e):new DOMException(e),Dl=e=>{let t=e.reason===void 0?Pl("This operation was aborted."):e.reason;return t instanceof Error?t:Pl(t)};function Ha(e,t){let{milliseconds:r,fallback:n,message:i,customTimers:s={setTimeout,clearTimeout}}=t,o,c=new Promise((u,f)=>{if(typeof r!="number"||Math.sign(r)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(t.signal){let{signal:h}=t;h.aborted&&f(Dl(h)),h.addEventListener("abort",()=>{f(Dl(h))})}if(r===Number.POSITIVE_INFINITY){e.then(u,f);return}let l=new qa;o=s.setTimeout.call(void 0,()=>{if(n){try{u(n())}catch(h){f(h)}return}typeof e.cancel=="function"&&e.cancel(),i===!1?u():i instanceof Error?f(i):(l.message=i??`Promise timed out after ${r} milliseconds`,f(l))},r),(async()=>{try{u(await e)}catch(h){f(h)}})()}).finally(()=>{c.clear()});return c.clear=()=>{s.clearTimeout.call(void 0,o),o=void 0},c}var ps=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");var za="lock:worker:request-read",Ga="lock:worker:release-read",Wa="lock:master:grant-read",$a="lock:worker:request-write",Qa="lock:worker:release-write",Ya="lock:master:grant-write";var br={},Bn=e=>{e.addEventListener("message",t=>{Bn.dispatchEvent("message",e,t)}),e.port!=null&&e.port.addEventListener("message",t=>{Bn.dispatchEvent("message",e,t)})};Bn.addEventListener=(e,t)=>{br[e]==null&&(br[e]=[]),br[e].push(t)};Bn.removeEventListener=(e,t)=>{br[e]!=null&&(br[e]=br[e].filter(r=>r===t))};Bn.dispatchEvent=function(e,t,r){br[e]!=null&&br[e].forEach(n=>n(t,r))};var Za=Bn;var Nl=(e,t,r,n,i)=>(s,o)=>{if(o.data.type!==r)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(s.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise(c=>{let u=f=>{if(f==null||f.data==null)return;let l={type:f.data.type,name:f.data.name,identifier:f.data.identifier};l.type===n&&l.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)}))}}))},Ul=(e,t,r,n)=>async()=>{let i=ps();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise(s=>{let o=a=>{if(a==null||a.data==null)return;let c={type:a.data.type,identifier:a.data.identifier};c.type===r&&c.identifier===i&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:n,identifier:i,name:e})}))};globalThis.addEventListener("message",o)})},vm={singleProcess:!1},Kl=e=>{if(e=Object.assign({},vm,e),!!globalThis.document||e.singleProcess){let r=new EventTarget;return Za.addEventListener("message",Nl(r,"requestReadLock",za,Ga,Wa)),Za.addEventListener("message",Nl(r,"requestWriteLock",$a,Qa,Ya)),r}return{isWorker:!0,readLock:r=>Ul(r,za,Wa,Ga),writeLock:r=>Ul(r,$a,Ya,Qa)}};var Zr={},wr;async function Xa(e,t){let r,n=new Promise(i=>{r=i});return e.add(async()=>await Ha((async()=>await new Promise(i=>{r(()=>{i()})}))(),{milliseconds:t.timeout})),await n}var bm=(e,t)=>{if(wr.isWorker===!0)return{readLock:wr.readLock(e,t),writeLock:wr.writeLock(e,t)};let r=new Fa({concurrency:1}),n;return{async readLock(){if(n!=null)return await Xa(n,t);n=new Fa({concurrency:t.concurrency,autoStart:!1});let i=n,s=Xa(n,t);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await s},async writeLock(){return n=null,await Xa(r,t)}}},wm={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Ja(e){let t=Object.assign({},wm,e);return wr==null&&(wr=Kl(t),wr.isWorker!==!0&&(wr.addEventListener("requestReadLock",r=>{Zr[r.data.name]!=null&&Zr[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),wr.addEventListener("requestWriteLock",async r=>{Zr[r.data.name]!=null&&Zr[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Zr[t.name]==null&&(Zr[t.name]=bm(t.name,t)),Zr[t.name]}var $t={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};var An;(function(e){let t;(function(i){let s;i.codec=()=>(s==null&&(s=ee((o,a,c={})=>{c.lengthDelimited!==!1&&a.fork(),o.key!=null&&o.key!==""&&(a.uint32(10),a.string(o.key)),o.value!=null&&o.value.byteLength>0&&(a.uint32(18),a.bytes(o.value)),c.lengthDelimited!==!1&&a.ldelim()},(o,a)=>{let c={key:"",value:new Uint8Array(0)},u=a==null?o.len:o.pos+a;for(;o.pos<u;){let f=o.uint32();switch(f>>>3){case 1:c.key=o.string();break;case 2:c.value=o.bytes();break;default:o.skipType(f&7);break}}return c})),s),i.encode=o=>te(o,i.codec()),i.decode=o=>jt(o,i.codec())})(t=e.Peer$metadataEntry||(e.Peer$metadataEntry={}));let r;(function(i){let s;i.codec=()=>(s==null&&(s=ee((o,a,c={})=>{c.lengthDelimited!==!1&&a.fork(),o.key!=null&&o.key!==""&&(a.uint32(10),a.string(o.key)),o.value!=null&&(a.uint32(18),gs.codec().encode(o.value,a)),c.lengthDelimited!==!1&&a.ldelim()},(o,a)=>{let c={key:""},u=a==null?o.len:o.pos+a;for(;o.pos<u;){let f=o.uint32();switch(f>>>3){case 1:c.key=o.string();break;case 2:c.value=gs.codec().decode(o,o.uint32());break;default:o.skipType(f&7);break}}return c})),s),i.encode=o=>te(o,i.codec()),i.decode=o=>jt(o,i.codec())})(r=e.Peer$tagsEntry||(e.Peer$tagsEntry={}));let n;e.codec=()=>(n==null&&(n=ee((i,s,o={})=>{if(o.lengthDelimited!==!1&&s.fork(),i.addresses!=null)for(let a of i.addresses)s.uint32(10),ys.codec().encode(a,s);if(i.protocols!=null)for(let a of i.protocols)s.uint32(18),s.string(a);if(i.publicKey!=null&&(s.uint32(34),s.bytes(i.publicKey)),i.peerRecordEnvelope!=null&&(s.uint32(42),s.bytes(i.peerRecordEnvelope)),i.metadata!=null&&i.metadata.size!==0)for(let[a,c]of i.metadata.entries())s.uint32(50),e.Peer$metadataEntry.codec().encode({key:a,value:c},s);if(i.tags!=null&&i.tags.size!==0)for(let[a,c]of i.tags.entries())s.uint32(58),e.Peer$tagsEntry.codec().encode({key:a,value:c},s);o.lengthDelimited!==!1&&s.ldelim()},(i,s)=>{let o={addresses:[],protocols:[],metadata:new Map,tags:new Map},a=s==null?i.len:i.pos+s;for(;i.pos<a;){let c=i.uint32();switch(c>>>3){case 1:o.addresses.push(ys.codec().decode(i,i.uint32()));break;case 2:o.protocols.push(i.string());break;case 4:o.publicKey=i.bytes();break;case 5:o.peerRecordEnvelope=i.bytes();break;case 6:{let u=e.Peer$metadataEntry.codec().decode(i,i.uint32());o.metadata.set(u.key,u.value);break}case 7:{let u=e.Peer$tagsEntry.codec().decode(i,i.uint32());o.tags.set(u.key,u.value);break}default:i.skipType(c&7);break}}return o})),n),e.encode=i=>te(i,e.codec()),e.decode=i=>jt(i,e.codec())})(An||(An={}));var ys;(function(e){let t;e.codec=()=>(t==null&&(t=ee((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.multiaddr!=null&&r.multiaddr.byteLength>0&&(n.uint32(10),n.bytes(r.multiaddr)),r.isCertified!=null&&(n.uint32(16),n.bool(r.isCertified)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={multiaddr:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.multiaddr=r.bytes();break;case 2:i.isCertified=r.bool();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>te(r,e.codec()),e.decode=r=>jt(r,e.codec())})(ys||(ys={}));var gs;(function(e){let t;e.codec=()=>(t==null&&(t=ee((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.value!=null&&r.value!==0&&(n.uint32(8),n.uint32(r.value)),r.expiry!=null&&(n.uint32(16),n.uint64(r.expiry)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={value:0},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.value=r.uint32();break;case 2:i.expiry=r.uint64();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>te(r,e.codec()),e.decode=r=>jt(r,e.codec())})(gs||(gs={}));function Cn(e,t){let r=An.decode(t);r.publicKey!=null&&e.publicKey==null&&(e=Zf({...e,publicKey:e.publicKey}));let n=new Map,i=BigInt(Date.now());for(let[s,o]of r.tags.entries())o.expiry!=null&&o.expiry<i||n.set(s,o);return{...r,id:e,addresses:r.addresses.map(({multiaddr:s,isCertified:o})=>({multiaddr:$r(s),isCertified:o??!1})),metadata:r.metadata,peerRecordEnvelope:r.peerRecordEnvelope??void 0,tags:n}}var rr="/",Ol=new TextEncoder().encode(rr),ms=Ol[0],xs=class e{_buf;constructor(t,r){if(typeof t=="string")this._buf=Pt(t);else if(t instanceof Uint8Array)this._buf=t;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==ms)throw new Error("Invalid key")}toString(t="utf8"){return ut(this._buf,t)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(t){return new e(t.join(rr))}static random(){return new e(ps().replace(/-/g,""))}static asKey(t){return t instanceof Uint8Array||typeof t=="string"?new e(t):typeof t.uint8Array=="function"?new e(t.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Ol),this._buf[0]!==ms){let t=new Uint8Array(this._buf.byteLength+1);t.fill(ms,0,1),t.set(this._buf,1),this._buf=t}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ms;)this._buf=this._buf.subarray(0,-1)}less(t){let r=this.list(),n=t.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],o=n[i];if(s<o)return!0;if(s>o)return!1}return r.length<n.length}reverse(){return e.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let t=this.namespaces();return t[t.length-1]}list(){return this.toString().split(rr).slice(1)}type(){return Em(this.baseNamespace())}name(){return Sm(this.baseNamespace())}instance(t){return new e(this.toString()+":"+t)}path(){let t=this.parent().toString();return t.endsWith(rr)||(t+=rr),t+=this.type(),new e(t)}parent(){let t=this.list();return t.length===1?new e(rr):new e(t.slice(0,-1).join(rr))}child(t){return this.toString()===rr?t:t.toString()===rr?this:new e(this.toString()+t.toString(),!1)}isAncestorOf(t){return t.toString()===this.toString()?!1:t.toString().startsWith(this.toString())}isDecendantOf(t){return t.toString()===this.toString()?!1:this.toString().startsWith(t.toString())}isTopLevel(){return this.list().length===1}concat(...t){return e.withNamespaces([...this.namespaces(),...Bm(t.map(r=>r.namespaces()))])}};function Em(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function Sm(e){let t=e.split(":");return t[t.length-1]}function Bm(e){return[].concat(...e)}var ja="/peers/";function In(e){if(!$f(e)||e.type==null)throw new q("Invalid PeerId",$t.ERR_INVALID_PARAMETERS);let t=e.toCID().toString();return new xs(`${ja}${t}`)}async function Ml(e,t,r){let n=new Map;for(let i of r){if(i==null)continue;if(i.multiaddr instanceof Uint8Array&&(i.multiaddr=$r(i.multiaddr)),!_a(i.multiaddr))throw new q("Multiaddr was invalid",$t.ERR_INVALID_PARAMETERS);if(!await t(e,i.multiaddr))continue;let s=i.isCertified??!1,o=i.multiaddr.toString(),a=n.get(o);a!=null?i.isCertified=a.isCertified||s:n.set(o,{multiaddr:i.multiaddr,isCertified:s})}return[...n.values()].sort((i,s)=>i.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({isCertified:i,multiaddr:s})=>({isCertified:i,multiaddr:s.bytes}))}async function bs(e,t,r,n){if(t==null)throw new q("Invalid PeerData",$t.ERR_INVALID_PARAMETERS);if(t.publicKey!=null&&e.publicKey!=null&&!Et(t.publicKey,e.publicKey))throw new q("publicKey bytes do not match peer id publicKey bytes",$t.ERR_INVALID_PARAMETERS);let i=n.existingPeer;if(i!=null&&!e.equals(i.id))throw new q("peer id did not match existing peer id",$t.ERR_INVALID_PARAMETERS);let s=i?.addresses??[],o=new Set(i?.protocols??[]),a=i?.metadata??new Map,c=i?.tags??new Map,u=i?.peerRecordEnvelope;if(r==="patch"){if((t.multiaddrs!=null||t.addresses!=null)&&(s=[],t.multiaddrs!=null&&s.push(...t.multiaddrs.map(l=>({isCertified:!1,multiaddr:l}))),t.addresses!=null&&s.push(...t.addresses)),t.protocols!=null&&(o=new Set(t.protocols)),t.metadata!=null){let l=t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata);a=vs(l,{validate:Fl})}if(t.tags!=null){let l=t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags);c=vs(l,{validate:ql,map:Vl})}t.peerRecordEnvelope!=null&&(u=t.peerRecordEnvelope)}if(r==="merge"){if(t.multiaddrs!=null&&s.push(...t.multiaddrs.map(l=>({isCertified:!1,multiaddr:l}))),t.addresses!=null&&s.push(...t.addresses),t.protocols!=null&&(o=new Set([...o,...t.protocols])),t.metadata!=null){let l=t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata);for(let[h,y]of l)y==null?a.delete(h):a.set(h,y);a=vs([...a.entries()],{validate:Fl})}if(t.tags!=null){let l=t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),h=new Map(c);for(let[y,d]of l)d==null?h.delete(y):h.set(y,d);c=vs([...h.entries()],{validate:ql,map:Vl})}t.peerRecordEnvelope!=null&&(u=t.peerRecordEnvelope)}let f={addresses:await Ml(e,n.addressFilter??(async()=>!0),s),protocols:[...o.values()].sort((l,h)=>l.localeCompare(h)),metadata:a,tags:c,publicKey:i?.id.publicKey??t.publicKey??e.publicKey,peerRecordEnvelope:u};return e.type!=="RSA"&&delete f.publicKey,f}function vs(e,t){let r=new Map;for(let[n,i]of e)i!=null&&t.validate(n,i);for(let[n,i]of e.sort(([s],[o])=>s.localeCompare(o)))i!=null&&r.set(n,t.map?.(n,i)??i);return r}function Fl(e,t){if(typeof e!="string")throw new q("Metadata key must be a string",$t.ERR_INVALID_PARAMETERS);if(!(t instanceof Uint8Array))throw new q("Metadata value must be a Uint8Array",$t.ERR_INVALID_PARAMETERS)}function ql(e,t){if(typeof e!="string")throw new q("Tag name must be a string",$t.ERR_INVALID_PARAMETERS);if(t.value!=null){if(parseInt(`${t.value}`,10)!==t.value)throw new q("Tag value must be an integer",$t.ERR_INVALID_PARAMETERS);if(t.value<0||t.value>100)throw new q("Tag value must be between 0-100",$t.ERR_INVALID_PARAMETERS)}if(t.ttl!=null){if(parseInt(`${t.ttl}`,10)!==t.ttl)throw new q("Tag ttl must be an integer",$t.ERR_INVALID_PARAMETERS);if(t.ttl<0)throw new q("Tag ttl must be between greater than 0",$t.ERR_INVALID_PARAMETERS)}}function Vl(e,t){let r;return t.expiry!=null&&(r=t.expiry),t.ttl!=null&&(r=BigInt(Date.now()+Number(t.ttl))),{value:t.value??0,expiry:r}}function ws(e,t,r){let n=e.toString().split("/")[2],i=oe.decode(n),s=Xn(i),o=r.get(s);if(o!=null)return o;let a=Cn(s,t);return r.set(s,a),a}function Am(e,t){return e==null?{}:{prefix:ja,filters:(e.filters??[]).map(r=>({key:n,value:i})=>r(ws(n,i,t))),orders:(e.orders??[]).map(r=>(n,i)=>r(ws(n.key,n.value,t),ws(i.key,i.value,t)))}}var Es=class{peerId;datastore;lock;addressFilter;constructor(t,r={}){this.peerId=t.peerId,this.datastore=t.datastore,this.addressFilter=r.addressFilter,this.lock=Ja({name:"peer-store",singleProcess:!0})}async has(t){return this.datastore.has(In(t))}async delete(t){if(this.peerId.equals(t))throw new q("Cannot delete self peer",$t.ERR_INVALID_PARAMETERS);await this.datastore.delete(In(t))}async load(t){let r=await this.datastore.get(In(t));return Cn(t,r)}async save(t,r){let{existingBuf:n,existingPeer:i}=await this.#t(t),s=await bs(t,r,"patch",{addressFilter:this.addressFilter});return this.#e(t,s,n,i)}async patch(t,r){let{existingBuf:n,existingPeer:i}=await this.#t(t),s=await bs(t,r,"patch",{addressFilter:this.addressFilter,existingPeer:i});return this.#e(t,s,n,i)}async merge(t,r){let{existingBuf:n,existingPeer:i}=await this.#t(t),s=await bs(t,r,"merge",{addressFilter:this.addressFilter,existingPeer:i});return this.#e(t,s,n,i)}async*all(t){let r=new ti;for await(let{key:n,value:i}of this.datastore.query(Am(t??{},r))){let s=ws(n,i,r);s.id.equals(this.peerId)||(yield s)}}async#t(t){try{let r=await this.datastore.get(In(t)),n=Cn(t,r);return{existingBuf:r,existingPeer:n}}catch(r){if(r.code!=="ERR_NOT_FOUND")throw r}return{}}async#e(t,r,n,i){let s=An.encode(r);return n!=null&&Et(s,n)?{peer:Cn(t,s),previous:i,updated:!1}:(await this.datastore.put(In(t),s),{peer:Cn(t,s),previous:i,updated:!0})}};var yt=w0("libp2p:peer-store"),t0=class{store;events;peerId;constructor(t,r={}){this.events=t.events,this.peerId=t.peerId,this.store=new Es(t,r)}async forEach(t,r){yt.trace("forEach await read lock");let n=await this.store.lock.readLock();yt.trace("forEach got read lock");try{for await(let i of this.store.all(r))t(i)}finally{yt.trace("forEach release read lock"),n()}}async all(t){yt.trace("all await read lock");let r=await this.store.lock.readLock();yt.trace("all got read lock");try{return await wl(this.store.all(t))}finally{yt.trace("all release read lock"),r()}}async delete(t){yt.trace("delete await write lock");let r=await this.store.lock.writeLock();yt.trace("delete got write lock");try{await this.store.delete(t)}finally{yt.trace("delete release write lock"),r()}}async has(t){yt.trace("has await read lock");let r=await this.store.lock.readLock();yt.trace("has got read lock");try{return await this.store.has(t)}finally{yt.trace("has release read lock"),r()}}async get(t){yt.trace("get await read lock");let r=await this.store.lock.readLock();yt.trace("get got read lock");try{return await this.store.load(t)}finally{yt.trace("get release read lock"),r()}}async save(t,r){yt.trace("save await write lock");let n=await this.store.lock.writeLock();yt.trace("save got write lock");try{let i=await this.store.save(t,r);return this.#t(t,i),i.peer}finally{yt.trace("save release write lock"),n()}}async patch(t,r){yt.trace("patch await write lock");let n=await this.store.lock.writeLock();yt.trace("patch got write lock");try{let i=await this.store.patch(t,r);return this.#t(t,i),i.peer}finally{yt.trace("patch release write lock"),n()}}async merge(t,r){yt.trace("merge await write lock");let n=await this.store.lock.writeLock();yt.trace("merge got write lock");try{let i=await this.store.merge(t,r);return this.#t(t,i),i.peer}finally{yt.trace("merge release write lock"),n()}}async consumePeerRecord(t,r){let n=await wn.openAndCertify(t,Qr.DOMAIN);if(r?.equals(n.peerId)===!1)return yt("envelope peer id was not the expected peer id - expected: %p received: %p",r,n.peerId),!1;let i=Qr.createFromProtobuf(n.payload),s;try{s=await this.get(n.peerId)}catch(o){if(o.code!=="ERR_NOT_FOUND")throw o}if(s?.peerRecordEnvelope!=null){let o=await wn.createFromProtobuf(s.peerRecordEnvelope),a=Qr.createFromProtobuf(o.payload);if(a.seqNumber>=i.seqNumber)return yt("sequence number was lower or equal to existing sequence number - stored: %d received: %d",a.seqNumber,i.seqNumber),!1}return await this.patch(i.peerId,{peerRecordEnvelope:t,addresses:i.multiaddrs.map(o=>({isCertified:!0,multiaddr:o}))}),!0}#t(t,r){r.updated&&(this.peerId.equals(t)?this.events.safeDispatchEvent("self:peer:update",{detail:r}):this.events.safeDispatchEvent("peer:update",{detail:r}))}};return rh(Cm);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerStore}));
